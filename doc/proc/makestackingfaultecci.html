<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="EMsoft main library">
    
    <meta name="author" content="Marc De Graef Research Group/Carnegie Mellon University" >
    <link rel="icon" href="../favicon.png">

    <title>makestackingfaultECCI &ndash; Fortran Program</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>makestackingfaultECCI
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.4% of total for procedures.">129 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/defectmodule.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/defectmodule.f90.html'>defectmodule.f90</a></li>
  
     <li><a href='../module/defectmodule.html'>defectmodule</a></li>
  
     <li class="active">makestackingfaultECCI</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/makestackingfaultecci.html#src">makestackingfaultECCI</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/adhisteq.html">adhisteq</a>
      
      <a class="list-group-item" href="../proc/aggiorno_ottimo.html">AGGIORNO_OTTIMO</a>
      
      <a class="list-group-item" href="../proc/alogam.html">alogam</a>
      
      <a class="list-group-item" href="../proc/altmov.html">altmov</a>
      
      <a class="list-group-item" href="../proc/altmov%7E2.html">altmov</a>
      
      <a class="list-group-item" href="../proc/backprojection.html">BackProjection</a>
      
      <a class="list-group-item" href="../proc/bakvec.html">bakvec</a>
      
      <a class="list-group-item" href="../proc/balanc.html">balanc</a>
      
      <a class="list-group-item" href="../proc/balbak.html">balbak</a>
      
      <a class="list-group-item" href="../proc/bandr.html">bandr</a>
      
      <a class="list-group-item" href="../proc/bandv.html">bandv</a>
      
      <a class="list-group-item" href="../proc/barreldistortion.html">BarrelDistortion</a>
      
      <a class="list-group-item" href="../proc/bisect.html">bisect</a>
      
      <a class="list-group-item" href="../proc/bobyqa.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqa%7E2.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqb.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bobyqb%7E2.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bqr.html">bqr</a>
      
      <a class="list-group-item" href="../proc/butterflymask9x9.html">ButterflyMask9x9</a>
      
      <a class="list-group-item" href="../proc/calchoughlut.html">CalcHoughLUT</a>
      
      <a class="list-group-item" href="../proc/calckinpedpatternsingle.html">CalcKINPEDPatternSingle</a>
      
      <a class="list-group-item" href="../proc/calckvectorcone.html">Calckvectorcone</a>
      
      <a class="list-group-item" href="../proc/calckvectortrace.html">Calckvectortrace</a>
      
      <a class="list-group-item" href="../proc/calcr.html">CalcR</a>
      
      <a class="list-group-item" href="../proc/calcrlocal.html">CalcRLocal</a>
      
      <a class="list-group-item" href="../proc/cardintersection.html">CardIntersection</a>
      
      <a class="list-group-item" href="../proc/cbabk2.html">cbabk2</a>
      
      <a class="list-group-item" href="../proc/cbal.html">cbal</a>
      
      <a class="list-group-item" href="../proc/cdiv.html">cdiv</a>
      
      <a class="list-group-item" href="../proc/cg.html">cg</a>
      
      <a class="list-group-item" href="../proc/ch.html">ch</a>
      
      <a class="list-group-item" href="../proc/cinvit.html">cinvit</a>
      
      <a class="list-group-item" href="../proc/clerror_check.html">CLerror_check</a>
      
      <a class="list-group-item" href="../proc/clinit_pdccq.html">CLinit_PDCCQ</a>
      
      <a class="list-group-item" href="../proc/clquery_platform_info.html">CLquery_platform_info</a>
      
      <a class="list-group-item" href="../proc/clread_source_file.html">CLread_source_file</a>
      
      <a class="list-group-item" href="../proc/combak.html">combak</a>
      
      <a class="list-group-item" href="../proc/comhes.html">comhes</a>
      
      <a class="list-group-item" href="../proc/comlr.html">comlr</a>
      
      <a class="list-group-item" href="../proc/comlr2.html">comlr2</a>
      
      <a class="list-group-item" href="../proc/comqr.html">comqr</a>
      
      <a class="list-group-item" href="../proc/comqr2.html">comqr2</a>
      
      <a class="list-group-item" href="../proc/cortb.html">cortb</a>
      
      <a class="list-group-item" href="../proc/corth.html">corth</a>
      
      <a class="list-group-item" href="../proc/csroot.html">csroot</a>
      
      <a class="list-group-item" href="../proc/ctfped_writefile.html">ctfped_writeFile</a>
      
      <a class="list-group-item" href="../proc/cubochoricneighbors.html">CubochoricNeighbors</a>
      
      <a class="list-group-item" href="../proc/cumul_histogram.html">cumul_histogram</a>
      
      <a class="list-group-item" href="../proc/dd_density.html">DD_Density</a>
      
      <a class="list-group-item" href="../proc/dd_estep.html">DD_Estep</a>
      
      <a class="list-group-item" href="../proc/dd_getqandl.html">DD_getQandL</a>
      
      <a class="list-group-item" href="../proc/dd_mstep.html">DD_Mstep</a>
      
      <a class="list-group-item" href="../proc/delete_fzlist.html">delete_FZlist</a>
      
      <a class="list-group-item" href="../proc/denoise_pattern.html">Denoise_Pattern</a>
      
      <a class="list-group-item" href="../proc/denoise_ped.html">Denoise_PED</a>
      
      <a class="list-group-item" href="../proc/di_emfordd.html">DI_EMforDD</a>
      
      <a class="list-group-item" href="../proc/di_init.html">DI_Init</a>
      
      <a class="list-group-item" href="../proc/di_rotatetomu.html">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../proc/di_sampledd.html">DI_SampleDD</a>
      
      <a class="list-group-item" href="../proc/di_similarity_classifier.html">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../proc/ebsd4calfun.html">EBSD4calfun</a>
      
      <a class="list-group-item" href="../proc/ebsdcalfun.html">EBSDcalfun</a>
      
      <a class="list-group-item" href="../proc/eccicalcsgh.html">ECCICalcSgh</a>
      
      <a class="list-group-item" href="../proc/ecpcalfun.html">ECPcalfun</a>
      
      <a class="list-group-item" href="../proc/efitebsdwrapper.html">efitEBSDWrapper</a>
      
      <a class="list-group-item" href="../proc/efitecpwrapper.html">efitECPWrapper</a>
      
      <a class="list-group-item" href="../proc/ei.html">EI</a>
      
      <a class="list-group-item" href="../proc/elmbak.html">elmbak</a>
      
      <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
      
      <a class="list-group-item" href="../proc/eltran.html">eltran</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdmaster.html">EMsoftCgetEBSDmaster</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdpatterns.html">EMsoftCgetEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetecpatterns.html">EMsoftCgetECPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetmcopencl.html">EMsoftCgetMCOpenCL</a>
      
      <a class="list-group-item" href="../proc/eshelby_disp.html">Eshelby_disp</a>
      
      <a class="list-group-item" href="../proc/fcore.html">FCORE</a>
      
      <a class="list-group-item" href="../proc/figi.html">figi</a>
      
      <a class="list-group-item" href="../proc/figi2.html">figi2</a>
      
      <a class="list-group-item" href="../proc/forwardprojection.html">ForwardProjection</a>
      
      <a class="list-group-item" href="../proc/fphon.html">FPHON</a>
      
      <a class="list-group-item" href="../proc/fscatt.html">FSCATT</a>
      
      <a class="list-group-item" href="../proc/genera_punto_sa.html">GENERA_PUNTO_SA</a>
      
      <a class="list-group-item" href="../proc/getaverageorientationnamelist.html">GetAverageOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getconvertorientationsnamelist.html">GetConvertOrientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdddensitylbm.html">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../proc/getdictindxopenclnamelist.html">GetDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../interface/getdisorientationangle.html">getDisorientationAngle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxis.html">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxistwophases.html">getDisorientationAngleAxisTwoPhases</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangledouble.html">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../proc/getdisorientationanglesingle.html">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationsnamelist.html">GetDisorientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdvsdnamelist.html">GetDvsDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdclusternamelist.html">GetEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsddetparmscannamelist.html">GetEBSDdetparmscanNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdfullnamelist.html">GetEBSDFullNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdindexingnamelist.html">GetEBSDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasternamelist.html">GetEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasteropenclnamelist.html">GetEBSDMasterOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdnamelist.html">GetEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdoverlapnamelist.html">GetEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns.html">getEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns2.html">getEBSDPatterns2</a>
      
      <a class="list-group-item" href="../proc/getebsdpatternswrapper.html">getEBSDPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/geteccinamelist.html">GetECCINameList</a>
      
      <a class="list-group-item" href="../proc/getecpatterns.html">getECPatterns</a>
      
      <a class="list-group-item" href="../proc/getecpatternswrapper.html">getECPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getecpindexingnamelist.html">GetECPIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getecpmasternamelist.html">GetECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getecpnamelist.html">GetECPNameList</a>
      
      <a class="list-group-item" href="../proc/getecppatternnamelist.html">GetECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/getecpsinglenamelist.html">GetECPSingleNameList</a>
      
      <a class="list-group-item" href="../proc/getecpzanamelist.html">GetECPZANameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfit4namelist.html">GetEMDPFit4NameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfitnamelist.html">GetEMDPFitNameList</a>
      
      <a class="list-group-item" href="../proc/geteulersfromfile.html">getEulersfromFile</a>
      
      <a class="list-group-item" href="../proc/getfitorientationpsnamelist.html">GetFitOrientationPSNameList</a>
      
      <a class="list-group-item" href="../proc/getfztypeandorder.html">getFZtypeandorder</a>
      
      <a class="list-group-item" href="../proc/getkamnamelist.html">GetKAMNameList</a>
      
      <a class="list-group-item" href="../proc/getkinematicalnamelist.html">GetkinematicalNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselmasternamelist.html">GetKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselnamelist.html">GetKosselNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselpatterns.html">getKosselPatterns</a>
      
      <a class="list-group-item" href="../proc/getkosselpatternswrapper.html">getKosselPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getlacbednamelist.html">GetLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclfoilnamelist.html">GetMCCLfoilNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclmultilayernamelist.html">GetMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclnamelist.html">GetMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclspherenamelist.html">GetMCCLsphereNameList</a>
      
      <a class="list-group-item" href="../proc/getmclipssnamelist.html">GetMCLIPSSNameList</a>
      
      <a class="list-group-item" href="../proc/getmcnamelist.html">GetMCNameList</a>
      
      <a class="list-group-item" href="../proc/getmultiphasenamelist.html">GetMultiPhaseNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationsimilaritynamelist.html">GetOrientationSimilarityNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationviznamelist.html">GetOrientationVizNameList</a>
      
      <a class="list-group-item" href="../proc/getpedindxnamelist.html">GetPEDIndxNameList</a>
      
      <a class="list-group-item" href="../proc/getpedkinnamelist.html">GetPEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/getpedzanamelist.html">GetPEDZANameList</a>
      
      <a class="list-group-item" href="../proc/getpfinversionnamelist.html">GetPFInversionNameList</a>
      
      <a class="list-group-item" href="../proc/getrefineorientationnamelist.html">GetRefineOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getreflectornamelist.html">GetreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/getrfznamelist.html">GetRFZNameList</a>
      
      <a class="list-group-item" href="../proc/getsrdefectnamelist.html">GetSRdefectNameList</a>
      
      <a class="list-group-item" href="../proc/getstemdcinamelist.html">GetSTEMDCINameList</a>
      
      <a class="list-group-item" href="../proc/gettkdindexingnamelist.html">GetTKDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdmasternamelist.html">GetTKDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdnamelist.html">GetTKDNameList</a>
      
      <a class="list-group-item" href="../proc/getwk.html">GETWK</a>
      
      <a class="list-group-item" href="../proc/getzadefectnamelist.html">GetZAdefectNameList</a>
      
      <a class="list-group-item" href="../proc/hipassfilter.html">HiPassFilter</a>
      
      <a class="list-group-item" href="../proc/houghtransform.html">HoughTransform</a>
      
      <a class="list-group-item" href="../proc/hqr.html">hqr</a>
      
      <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
      
      <a class="list-group-item" href="../proc/htrib3.html">htrib3</a>
      
      <a class="list-group-item" href="../proc/htribk.html">htribk</a>
      
      <a class="list-group-item" href="../proc/htrid3.html">htrid3</a>
      
      <a class="list-group-item" href="../proc/htridi.html">htridi</a>
      
      <a class="list-group-item" href="../proc/image_entropy.html">image_entropy</a>
      
      <a class="list-group-item" href="../proc/image_histogram.html">image_histogram</a>
      
      <a class="list-group-item" href="../proc/image_jointentropy.html">image_jointentropy</a>
      
      <a class="list-group-item" href="../proc/image_jointhistogram.html">image_jointhistogram</a>
      
      <a class="list-group-item" href="../proc/image_mutualinformation.html">image_mutualinformation</a>
      
      <a class="list-group-item" href="../proc/imtql1.html">imtql1</a>
      
      <a class="list-group-item" href="../proc/imtql2.html">imtql2</a>
      
      <a class="list-group-item" href="../proc/imtqlv.html">imtqlv</a>
      
      <a class="list-group-item" href="../proc/init_dislocation_data.html">init_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/init_einclusion_data.html">init_Einclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_foil_data.html">init_foil_data</a>
      
      <a class="list-group-item" href="../proc/init_inclusion_data.html">init_inclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_stacking_fault_data.html">init_stacking_fault_data</a>
      
      <a class="list-group-item" href="../proc/init_stem.html">init_STEM</a>
      
      <a class="list-group-item" href="../proc/init_stem_za.html">init_STEM_ZA</a>
      
      <a class="list-group-item" href="../proc/init_void_data.html">init_void_data</a>
      
      <a class="list-group-item" href="../proc/init_ysh_dislocation_data.html">init_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/initialize_foil_geometry.html">initialize_foil_geometry</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../interface/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist_ewaldsweep.html">Initialize_ReflectionList_EwaldSweep</a>
      
      <a class="list-group-item" href="../proc/initializedefects.html">InitializeDefects</a>
      
      <a class="list-group-item" href="../proc/initializeeshelbyinclusion.html">InitializeEshelbyInclusion</a>
      
      <a class="list-group-item" href="../proc/innerprodgpu.html">InnerProdGPU</a>
      
      <a class="list-group-item" href="../proc/insidecubehexfz.html">insideCubeHexFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicfz.html">insideCubicFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicmfz.html">insideCubicMFZ</a>
      
      <a class="list-group-item" href="../proc/insidecyclicfz.html">insideCyclicFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralfz.html">insideDihedralFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralmfz.html">insideDihedralMFZ</a>
      
      <a class="list-group-item" href="../proc/interfaccia.html">INTERFACCIA</a>
      
      <a class="list-group-item" href="../proc/inversiondivision.html">InversionDivision</a>
      
      <a class="list-group-item" href="../proc/invit.html">invit</a>
      
      <a class="list-group-item" href="../proc/isinsidefz.html">IsinsideFZ</a>
      
      <a class="list-group-item" href="../proc/isinsidemfz.html">IsinsideMFZ</a>
      
      <a class="list-group-item" href="../proc/jaccard_distance.html">Jaccard_Distance</a>
      
      <a class="list-group-item" href="../proc/json_cleanuppointers.html">JSON_cleanuppointers</a>
      
      <a class="list-group-item" href="../proc/json_failtest.html">JSON_failtest</a>
      
      <a class="list-group-item" href="../proc/json_initpointers.html">JSON_initpointers</a>
      
      <a class="list-group-item" href="../proc/json_minify.html">JSON_minify</a>
      
      <a class="list-group-item" href="../proc/json_writenmldoubles.html">JSON_writeNMLdoubles</a>
      
      <a class="list-group-item" href="../proc/json_writenmlintegers.html">JSON_writeNMLintegers</a>
      
      <a class="list-group-item" href="../proc/json_writenmlreals.html">JSON_writeNMLreals</a>
      
      <a class="list-group-item" href="../proc/jsongetdouble.html">JSONgetDouble</a>
      
      <a class="list-group-item" href="../proc/jsongetdoublevector.html">JSONgetDoubleVector</a>
      
      <a class="list-group-item" href="../proc/jsonreaddefectfile.html">JSONreadDefectFile</a>
      
      <a class="list-group-item" href="../proc/jsonreaddouble.html">JSONreadDouble</a>
      
      <a class="list-group-item" href="../proc/jsonreaddoublevec.html">JSONreadDoubleVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdclusternamelist.html">JSONreadEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdmasternamelist.html">JSONreadEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdnamelist.html">JSONreadEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdoverlapnamelist.html">JSONreadEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadecpmasternamelist.html">JSONreadECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadfoildata.html">JSONreadFoilData</a>
      
      <a class="list-group-item" href="../proc/jsonreadinteger.html">JSONreadInteger</a>
      
      <a class="list-group-item" href="../proc/jsonreadintegervec.html">JSONreadIntegerVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselmasternamelist.html">JSONreadKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselnamelist.html">JSONreadKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadlogical.html">JSONreadLogical</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclmultilayernamelist.html">JSONreadMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclnamelist.html">JSONreadMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcnamelist.html">JSONreadMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadreal.html">JSONreadReal</a>
      
      <a class="list-group-item" href="../proc/jsonreadrealvec.html">JSONreadRealVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadreflectornamelist.html">JSONreadreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadstring.html">JSONreadString</a>
      
      <a class="list-group-item" href="../proc/jsonwritedictindxopenclnamelist.html">JSONwriteDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdclusternamelist.html">JSONwriteEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdmasternamelist.html">JSONwriteEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdnamelist.html">JSONwriteEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteeccinamelist.html">JSONwriteECCINameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpmasternamelist.html">JSONwriteECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpnamelist.html">JSONwriteECPNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecppatternnamelist.html">JSONwriteECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselmasternamelist.html">JSONwriteKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselnamelist.html">JSONwriteKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritelacbednamelist.html">JSONwriteLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclmultilayernamelist.html">JSONwriteMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclnamelist.html">JSONwriteMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcnamelist.html">JSONwriteMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedkinnamelist.html">JSONwritePEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedzanamelist.html">JSONwritePEDZANameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriterfznamelist.html">JSONwriteRFZNameList</a>
      
      <a class="list-group-item" href="../proc/linesearch_inverti.html">LINESEARCH_INVERTI</a>
      
      <a class="list-group-item" href="../proc/linesearchbox_cont.html">linesearchbox_cont</a>
      
      <a class="list-group-item" href="../proc/logcp.html">logCp</a>
      
      <a class="list-group-item" href="../proc/mainbox1.html">MAINBOX1</a>
      
      <a class="list-group-item" href="../proc/mainbox2.html">MAINBOX2</a>
      
      <a class="list-group-item" href="../proc/makedislocation.html">makedislocation</a>
      
      <a class="list-group-item" href="../proc/makestackingfault.html">makestackingfault</a>
      
      <a class="list-group-item" href="../proc/makestackingfaultecci.html">makestackingfaultECCI</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation%7E2.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/mc_concatenatemuellermatrices.html">MC_concatenateMuellerMatrices</a>
      
      <a class="list-group-item" href="../proc/mc_get_ad_from_eo.html">MC_get_AD_from_EO</a>
      
      <a class="list-group-item" href="../proc/mc_get_auxiliaryangle.html">MC_get_AuxiliaryAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_basicmuellermatrix.html">MC_get_basicMuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_get_diattenuator.html">MC_get_diattenuator</a>
      
      <a class="list-group-item" href="../proc/mc_get_ellipticityangle.html">MC_get_EllipticityAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_eo_from_ad.html">MC_get_EO_from_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_orientationangle.html">MC_get_OrientationAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_phaseshiftangle.html">MC_get_PhaseShiftAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_polarization.html">MC_get_Polarization</a>
      
      <a class="list-group-item" href="../proc/mc_get_retarder.html">MC_get_retarder</a>
      
      <a class="list-group-item" href="../proc/mc_get_rotator.html">MC_get_rotator</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_ad.html">MC_get_Stokes_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_eo.html">MC_get_Stokes_EO</a>
      
      <a class="list-group-item" href="../proc/mc_print_muellermatrix.html">MC_print_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_propagatestokesvector.html">MC_propagateStokesVector</a>
      
      <a class="list-group-item" href="../proc/mc_rotate_muellermatrix.html">MC_rotate_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/minfit.html">minfit</a>
      
      <a class="list-group-item" href="../proc/nanchk.html">NANCHK</a>
      
      <a class="list-group-item" href="../proc/ortbak.html">ortbak</a>
      
      <a class="list-group-item" href="../proc/orthes.html">orthes</a>
      
      <a class="list-group-item" href="../proc/ortran.html">ortran</a>
      
      <a class="list-group-item" href="../proc/pgm_write_file.html">PGM_Write_File</a>
      
      <a class="list-group-item" href="../proc/poidev.html">POIDEV</a>
      
      <a class="list-group-item" href="../proc/povray_addcubochoriccube.html">PoVRay_addCubochoricCube</a>
      
      <a class="list-group-item" href="../proc/povray_addcylinder.html">PoVRay_addCylinder</a>
      
      <a class="list-group-item" href="../proc/povray_addeulerbox.html">PoVRay_addEulerBox</a>
      
      <a class="list-group-item" href="../proc/povray_addreferenceframe.html">PoVRay_addReferenceFrame</a>
      
      <a class="list-group-item" href="../proc/povray_addsphere.html">PoVRay_addSphere</a>
      
      <a class="list-group-item" href="../proc/povray_addwireframesphere.html">PoVRay_addWireFrameSphere</a>
      
      <a class="list-group-item" href="../proc/povray_declare_df3file.html">PoVRay_declare_DF3file</a>
      
      <a class="list-group-item" href="../proc/povray_drawfz.html">PoVRay_drawFZ</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz222.html">PoVRay_getpos_FZ222</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz23.html">PoVRay_getpos_FZ23</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz32.html">PoVRay_getpos_FZ32</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz422.html">PoVRay_getpos_FZ422</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz432.html">PoVRay_getpos_FZ432</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz622.html">PoVRay_getpos_FZ622</a>
      
      <a class="list-group-item" href="../proc/povray_initfz2.html">PoVRay_initFZ2</a>
      
      <a class="list-group-item" href="../proc/povray_initfz3.html">PoVRay_initFZ3</a>
      
      <a class="list-group-item" href="../proc/povray_initfz4.html">PoVRay_initFZ4</a>
      
      <a class="list-group-item" href="../proc/povray_initfz6.html">PoVRay_initFZ6</a>
      
      <a class="list-group-item" href="../proc/povray_openfile.html">PoVRay_openFile</a>
      
      <a class="list-group-item" href="../proc/povray_setcamera.html">PoVRay_setCamera</a>
      
      <a class="list-group-item" href="../proc/povray_setlightsource.html">PoVRay_setLightSource</a>
      
      <a class="list-group-item" href="../proc/povray_write_df3file.html">PoVRay_write_DF3file</a>
      
      <a class="list-group-item" href="../proc/prelim.html">prelim</a>
      
      <a class="list-group-item" href="../proc/prelim%7E2.html">prelim</a>
      
      <a class="list-group-item" href="../proc/printtime.html">PrintTime</a>
      
      <a class="list-group-item" href="../proc/pythag.html">pythag</a>
      
      <a class="list-group-item" href="../proc/qsortd.html">qsortd</a>
      
      <a class="list-group-item" href="../proc/qzhes.html">qzhes</a>
      
      <a class="list-group-item" href="../proc/qzit.html">qzit</a>
      
      <a class="list-group-item" href="../proc/qzval.html">qzval</a>
      
      <a class="list-group-item" href="../proc/qzvec.html">qzvec</a>
      
      <a class="list-group-item" href="../proc/r8_swap.html">r8_swap</a>
      
      <a class="list-group-item" href="../proc/r8mat_print.html">r8mat_print</a>
      
      <a class="list-group-item" href="../proc/r8mat_print_some.html">r8mat_print_some</a>
      
      <a class="list-group-item" href="../proc/r8vec2_print.html">r8vec2_print</a>
      
      <a class="list-group-item" href="../proc/r8vec_print.html">r8vec_print</a>
      
      <a class="list-group-item" href="../proc/ran.html">ran</a>
      
      <a class="list-group-item" href="../proc/randddmarginal.html">randDDMarginal</a>
      
      <a class="list-group-item" href="../proc/randuniformsphere.html">randUniformSphere</a>
      
      <a class="list-group-item" href="../proc/ratqr.html">ratqr</a>
      
      <a class="list-group-item" href="../proc/read_apb_data.html">read_apb_data</a>
      
      <a class="list-group-item" href="../proc/read_stem_data.html">read_STEM_data</a>
      
      <a class="list-group-item" href="../proc/read_ysh_dislocation_data.html">read_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/rebak.html">rebak</a>
      
      <a class="list-group-item" href="../proc/rebakb.html">rebakb</a>
      
      <a class="list-group-item" href="../proc/reduc.html">reduc</a>
      
      <a class="list-group-item" href="../proc/reduc2.html">reduc2</a>
      
      <a class="list-group-item" href="../proc/reducedisorientationtomfz.html">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtocubicefz.html">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtorfz.html">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../proc/rescue.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rescue%7E2.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rg.html">rg</a>
      
      <a class="list-group-item" href="../proc/rgg.html">rgg</a>
      
      <a class="list-group-item" href="../proc/ri1.html">RI1</a>
      
      <a class="list-group-item" href="../proc/ri2.html">RI2</a>
      
      <a class="list-group-item" href="../proc/ricerca_lungo_assi.html">RICERCA_LUNGO_ASSI</a>
      
      <a class="list-group-item" href="../proc/rih1.html">RIH1</a>
      
      <a class="list-group-item" href="../proc/rih2.html">RIH2</a>
      
      <a class="list-group-item" href="../proc/rih3.html">RIH3</a>
      
      <a class="list-group-item" href="../proc/rng_seed.html">rng_seed</a>
      
      <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
      
      <a class="list-group-item" href="../proc/rs.html">rs</a>
      
      <a class="list-group-item" href="../proc/rsb.html">rsb</a>
      
      <a class="list-group-item" href="../proc/rsg.html">rsg</a>
      
      <a class="list-group-item" href="../proc/rsgab.html">rsgab</a>
      
      <a class="list-group-item" href="../proc/rsgba.html">rsgba</a>
      
      <a class="list-group-item" href="../proc/rsm.html">rsm</a>
      
      <a class="list-group-item" href="../proc/rsp.html">rsp</a>
      
      <a class="list-group-item" href="../proc/rspp.html">rspp</a>
      
      <a class="list-group-item" href="../proc/rst.html">rst</a>
      
      <a class="list-group-item" href="../proc/rt.html">rt</a>
      
      <a class="list-group-item" href="../proc/sample_cone.html">sample_Cone</a>
      
      <a class="list-group-item" href="../proc/sample_isocube.html">sample_isoCube</a>
      
      <a class="list-group-item" href="../proc/sample_isocubefilled.html">sample_isoCubeFilled</a>
      
      <a class="list-group-item" href="../proc/samplefcctwinrfz.html">SamplefcctwinRFZ</a>
      
      <a class="list-group-item" href="../proc/sampleisomisorientation.html">SampleIsoMisorientation</a>
      
      <a class="list-group-item" href="../proc/samplerfz.html">SampleRFZ</a>
      
      <a class="list-group-item" href="../proc/samplerfztwin.html">SampleRFZtwin</a>
      
      <a class="list-group-item" href="../proc/senzaderglob.html">SENZADERGLOB</a>
      
      <a class="list-group-item" href="../proc/ssort.html">SSORT</a>
      
      <a class="list-group-item" href="../proc/stop.html">STOP</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/time_estimate.html">Time_estimate</a>
      
      <a class="list-group-item" href="../proc/time_remaining.html">Time_remaining</a>
      
      <a class="list-group-item" href="../proc/time_report.html">Time_report</a>
      
      <a class="list-group-item" href="../proc/time_reset.html">Time_reset</a>
      
      <a class="list-group-item" href="../proc/time_start.html">Time_start</a>
      
      <a class="list-group-item" href="../proc/time_stop.html">Time_stop</a>
      
      <a class="list-group-item" href="../proc/time_tick.html">Time_tick</a>
      
      <a class="list-group-item" href="../proc/time_tock.html">Time_tock</a>
      
      <a class="list-group-item" href="../proc/timestamp.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/timestamp%7E2.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/tinvit.html">tinvit</a>
      
      <a class="list-group-item" href="../proc/tql1.html">tql1</a>
      
      <a class="list-group-item" href="../proc/tql2.html">tql2</a>
      
      <a class="list-group-item" href="../proc/tqlrat.html">tqlrat</a>
      
      <a class="list-group-item" href="../proc/trbak1.html">trbak1</a>
      
      <a class="list-group-item" href="../proc/trbak3.html">trbak3</a>
      
      <a class="list-group-item" href="../proc/tred1.html">tred1</a>
      
      <a class="list-group-item" href="../proc/tred2.html">tred2</a>
      
      <a class="list-group-item" href="../proc/tred3.html">tred3</a>
      
      <a class="list-group-item" href="../proc/tridib.html">tridib</a>
      
      <a class="list-group-item" href="../proc/trsbox.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/trsbox%7E2.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/tsturm.html">tsturm</a>
      
      <a class="list-group-item" href="../proc/update.html">update</a>
      
      <a class="list-group-item" href="../proc/update%7E2.html">update</a>
      
      <a class="list-group-item" href="../proc/vmfmeandirdensity.html">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/watsonmeandirdensity.html">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/weko.html">WEKO</a>
      
      <a class="list-group-item" href="../proc/yshdisp%7E2.html">YSHDisp</a>
      
      <a class="list-group-item" href="../proc/yshdisp.html">YSHDisp</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public recursive subroutine makestackingfaultECCI(cell, defects, inum, DF_L, nx, ny, DF_g, dinfo)
    
    
	 
</h2>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>math</li>
      
      <li><a href='../module/constants.html'>constants</a></li>
      
      <li>files</li>
      
      <li>rotations</li>
      
      <li>crystal</li>
      
      <li>symmetry</li>
      
      <li>math</li>
      
    </ul>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makestackingfaultecci~~UsesGraph Pages: 1 -->
<svg id="procmakestackingfaultecciUsesGraph" width="314pt" height="242pt"
 viewBox="0.00 0.00 314.00 242.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makestackingfaultecci~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 238)">
<title>proc~~makestackingfaultecci~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-238 310,-238 310,4 -4,4"/>
<!-- proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node1" class="node"><title>proc~makestackingfaultecci</title>
<polygon fill="none" stroke="black" points="306,-129 184,-129 184,-105 306,-105 306,-129"/>
<text text-anchor="middle" x="245" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50">makestackingfaultECCI</text>
</g>
<!-- module~constants -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node2" class="node"><title>module~constants</title>
<g id="a_proc~~makestackingfaultecci~~UsesGraph_node2"><a xlink:href="../module/constants.html" xlink:title="constants">
<polygon fill="#337ab7" stroke="#337ab7" points="147.5,-234 90.5,-234 90.5,-210 147.5,-210 147.5,-234"/>
<text text-anchor="middle" x="119" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">constants</text>
</a>
</g>
</g>
<!-- module~constants&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge2" class="edge"><title>module~constants&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M136.446,-209.989C140.281,-207.1 144.318,-203.985 148,-201 174.645,-179.402 204.186,-153.193 223.368,-135.856"/>
<polygon fill="#ff0000" stroke="#ff0000" points="225.861,-138.32 230.916,-129.009 221.158,-133.136 225.861,-138.32"/>
</g>
<!-- crystal -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node3" class="node"><title>crystal</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-192 92,-192 92,-168 146,-168 146,-192"/>
<text text-anchor="middle" x="119" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crystal</text>
</g>
<!-- crystal&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge3" class="edge"><title>crystal&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M143.908,-167.853C163.036,-158.135 190.06,-144.405 211.207,-133.661"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.835,-136.76 220.165,-129.11 209.664,-130.519 212.835,-136.76"/>
</g>
<!-- symmetry -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node4" class="node"><title>symmetry</title>
<polygon fill="#337ab7" stroke="#337ab7" points="148,-150 90,-150 90,-126 148,-126 148,-150"/>
<text text-anchor="middle" x="119" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">symmetry</text>
</g>
<!-- symmetry&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge4" class="edge"><title>symmetry&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M148.138,-133.235C155.956,-131.911 164.812,-130.411 173.903,-128.871"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.548,-132.312 183.823,-127.191 173.379,-125.41 174.548,-132.312"/>
</g>
<!-- rotations -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node5" class="node"><title>rotations</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-108 92,-108 92,-84 146,-84 146,-108"/>
<text text-anchor="middle" x="119" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rotations</text>
</g>
<!-- rotations&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge5" class="edge"><title>rotations&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.297,-100.454C154.562,-101.853 164.11,-103.47 173.933,-105.134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.366,-108.588 183.811,-106.807 174.535,-101.686 173.366,-108.588"/>
</g>
<!-- math -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node6" class="node"><title>math</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-66 92,-66 92,-42 146,-42 146,-66"/>
<text text-anchor="middle" x="119" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math</text>
</g>
<!-- math&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge6" class="edge"><title>math&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M143.908,-66.147C163.036,-75.8648 190.06,-89.5948 211.207,-100.339"/>
<polygon fill="#ff0000" stroke="#ff0000" points="209.664,-103.481 220.165,-104.89 212.835,-97.2403 209.664,-103.481"/>
</g>
<!-- files -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node7" class="node"><title>files</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-24 92,-24 92,-0 146,-0 146,-24"/>
<text text-anchor="middle" x="119" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">files</text>
</g>
<!-- files&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge7" class="edge"><title>files&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M136.446,-24.0107C140.281,-26.9001 144.318,-30.0155 148,-33 174.645,-54.5979 204.186,-80.8073 223.368,-98.1436"/>
<polygon fill="#ff0000" stroke="#ff0000" points="221.158,-100.864 230.916,-104.991 225.861,-95.6796 221.158,-100.864"/>
</g>
<!-- local -->
<g id="proc~~makestackingfaultecci~~UsesGraph_node8" class="node"><title>local</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-234 0,-234 0,-210 54,-210 54,-234"/>
<text text-anchor="middle" x="27" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">local</text>
</g>
<!-- local&#45;&gt;module~constants -->
<g id="proc~~makestackingfaultecci~~UsesGraph_edge1" class="edge"><title>local&#45;&gt;module~constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M54.0317,-222C62.2408,-222 71.4806,-222 80.3316,-222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.4582,-225.5 90.4582,-222 80.4582,-218.5 80.4582,-225.5"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="486pt" height="32pt"
 viewBox="0.00 0.00 486.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 482,-28 482,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-24 72,-24 72,-0 138,-0 138,-24"/>
<text text-anchor="middle" x="105" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="219.5,-24 156.5,-24 156.5,-0 219.5,-0 219.5,-24"/>
<text text-anchor="middle" x="188" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="292,-24 238,-24 238,-0 292,-0 292,-24"/>
<text text-anchor="middle" x="265" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="478,-24 382,-24 382,-0 478,-0 478,-24"/>
<text text-anchor="middle" x="430" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a parent (sub)module to the submodule which is
    descended from it. Dashed arrows point from a module being used to the
    module or program unit using it. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    


    
    <p>@author Marc De Graef, Carnegie Mellon University
 @brief compute parameters for a stacking fault in ECCI mode
 @details  This subroutine computes the geometrical parameters for a 
 stacking fault.  It computes, among others, the coordinates of the surface
 intersections of the partial dislocations, and an array that indicates, for
 each image pixel, whether or not the corresponding integration column 
 contains this fault; if it does not, the  value in the array is set to 
 -10000; if it does, then the value is equal to the point where the fault
 plane intersects with the column, measured from the top surface.
 In short, anything that is needed in the CalcR routine and can be computed 
 ahead of time, is computed here.  The routine also calls the makedislocation 
 routine to create the partials.
 @param cell unit cell pointer
 @param defects defect structure
 @param inum
 @param DF_L column edge length
 @param nx
 @param ny
 @param DF_g
 @param ndl
 @param dinfo trigger for verbose output
 @date   11/05/13 MDG 1.0 new attempt to replace faulty original routine
 @date   11/13/13 MDG 1.1 traced error to problem with transformations in defectmodule
 @date   11/13/13 MDG 1.2 changed SF normal transformation for zpos array computation (to be tested)
 @date   12/17/13 MDG 1.3 branch from original routine to deal with different ECCI geometry
 @date   12/18/13 MDG 1.4 debug of stacking fault location array
 @date   06/09/14 MDG 2.0 added cell, SF, YD arguments
 @date   06/10/14 MDG 2.1 added foil argument</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cell%7E11"></span>type(unitcell),</td>
  <td></td>
  <td></td>
  
  <td>pointer</td><td>::</td>
  <td><strong>cell</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-defects%7E14"></span>type(defecttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>defects</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inum%7E3"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>inum</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-df_l%7E12"></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DF_L</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-nx%7E3"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-ny%7E3"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ny</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-df_g%7E3"></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DF_g</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dinfo%7E15"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinfo</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makestackingfaultecci~~CallsGraph Pages: 1 -->
<svg id="procmakestackingfaultecciCallsGraph" width="377pt" height="398pt"
 viewBox="0.00 0.00 377.00 398.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makestackingfaultecci~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 394)">
<title>proc~~makestackingfaultecci~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-394 373,-394 373,4 -4,4"/>
<!-- proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node1" class="node"><title>proc~makestackingfaultecci</title>
<polygon fill="none" stroke="black" points="122,-214 7.10543e-15,-214 7.10543e-15,-190 122,-190 122,-214"/>
<text text-anchor="middle" x="61" y="-199.6" font-family="Helvetica,sans-Serif" font-size="10.50">makestackingfaultECCI</text>
</g>
<!-- float -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node2" class="node"><title>float</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-390 186.5,-390 186.5,-366 240.5,-366 240.5,-390"/>
<text text-anchor="middle" x="213.5" y="-375.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">float</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;float -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge10" class="edge"><title>proc~makestackingfaultecci&#45;&gt;float</title>
<path fill="none" stroke="#ff0000" d="M66.9385,-214.1C78.8015,-241.855 111.414,-310.868 158,-352 163.619,-356.961 170.35,-361.179 177.135,-364.682"/>
<polygon fill="#ff0000" stroke="#ff0000" points="175.782,-367.914 186.32,-369.019 178.771,-361.584 175.782,-367.914"/>
</g>
<!-- transspace -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node3" class="node"><title>transspace</title>
<polygon fill="#777777" stroke="#777777" points="369,-360 305,-360 305,-336 369,-336 369,-360"/>
<text text-anchor="middle" x="337" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transspace</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;transspace -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge11" class="edge"><title>proc~makestackingfaultecci&#45;&gt;transspace</title>
<path fill="none" stroke="#ff0000" d="M71.295,-214.011C87.0547,-233.577 120.939,-272.319 158,-294 201.186,-319.265 257.296,-333.728 294.869,-341.21"/>
<polygon fill="#ff0000" stroke="#ff0000" points="294.469,-344.696 304.949,-343.138 295.785,-337.821 294.469,-344.696"/>
</g>
<!-- point_inside_polygon -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node4" class="node"><title>point_inside_polygon</title>
<polygon fill="#777777" stroke="#777777" points="269,-154 158,-154 158,-130 269,-130 269,-154"/>
<text text-anchor="middle" x="213.5" y="-139.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">point_inside_polygon</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;point_inside_polygon -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge12" class="edge"><title>proc~makestackingfaultecci&#45;&gt;point_inside_polygon</title>
<path fill="none" stroke="#ff0000" d="M92.4559,-189.858C115.583,-180.638 147.585,-167.88 172.732,-157.854"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.354,-160.976 182.347,-154.021 171.761,-154.473 174.354,-160.976"/>
</g>
<!-- sgetrf -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node5" class="node"><title>sgetrf</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-112 186.5,-112 186.5,-88 240.5,-88 240.5,-112"/>
<text text-anchor="middle" x="213.5" y="-97.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sgetrf</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;sgetrf -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge13" class="edge"><title>proc~makestackingfaultecci&#45;&gt;sgetrf</title>
<path fill="none" stroke="#ff0000" d="M73.7131,-189.819C90.8565,-172.56 124.407,-140.878 158,-121 163.922,-117.496 170.534,-114.374 177.053,-111.678"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.389,-114.914 186.449,-108.037 175.86,-108.387 178.389,-114.914"/>
</g>
<!-- calcangle -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node6" class="node"><title>calcangle</title>
<polygon fill="#777777" stroke="#777777" points="365.5,-318 308.5,-318 308.5,-294 365.5,-294 365.5,-318"/>
<text text-anchor="middle" x="337" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calcangle</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;calcangle -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge14" class="edge"><title>proc~makestackingfaultecci&#45;&gt;calcangle</title>
<path fill="none" stroke="#ff0000" d="M76.6709,-214.047C94.7257,-228.277 126.833,-251.691 158,-265 204.054,-284.666 261.02,-295.67 297.913,-301.216"/>
<polygon fill="#ff0000" stroke="#ff0000" points="297.824,-304.74 308.222,-302.702 298.823,-297.811 297.824,-304.74"/>
</g>
<!-- sngl -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node7" class="node"><title>sngl</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-70 186.5,-70 186.5,-46 240.5,-46 240.5,-70"/>
<text text-anchor="middle" x="213.5" y="-55.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">sngl</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;sngl -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge15" class="edge"><title>proc~makestackingfaultecci&#45;&gt;sngl</title>
<path fill="none" stroke="#ff0000" d="M68.5265,-189.735C82.077,-165.358 115.566,-110.457 158,-79 163.637,-74.8211 170.209,-71.3669 176.799,-68.551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.283,-71.7301 186.359,-64.872 175.769,-65.1971 178.283,-71.7301"/>
</g>
<!-- quat_lp -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node8" class="node"><title>quat_lp</title>
<polygon fill="#777777" stroke="#777777" points="240.5,-28 186.5,-28 186.5,-4 240.5,-4 240.5,-28"/>
<text text-anchor="middle" x="213.5" y="-13.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quat_lp</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;quat_lp -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge16" class="edge"><title>proc~makestackingfaultecci&#45;&gt;quat_lp</title>
<path fill="none" stroke="#ff0000" d="M65.9045,-189.77C76.1352,-159.593 106.544,-80.855 158,-37 163.444,-32.3599 170.027,-28.6824 176.707,-25.7894"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.337,-28.9143 186.442,-22.0913 175.851,-22.3705 178.337,-28.9143"/>
</g>
<!-- proc~makeyshdislocation -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node9" class="node"><title>proc~makeyshdislocation</title>
<g id="a_proc~~makestackingfaultecci~~CallsGraph_node9"><a xlink:href="../proc/makeyshdislocation.html" xlink:title="makeYSHdislocation">
<polygon fill="#d9534f" stroke="#d9534f" points="268,-234 159,-234 159,-210 268,-210 268,-234"/>
<text text-anchor="middle" x="213.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">makeYSHdislocation</text>
</a>
</g>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;proc~makeyshdislocation -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge17" class="edge"><title>proc~makestackingfaultecci&#45;&gt;proc~makeyshdislocation</title>
<path fill="none" stroke="#ff0000" d="M122.347,-210.02C131.046,-211.176 140.022,-212.368 148.784,-213.533"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.569,-217.035 158.943,-214.883 149.491,-210.096 148.569,-217.035"/>
</g>
<!-- calccross -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node10" class="node"><title>calccross</title>
<polygon fill="#777777" stroke="#777777" points="365,-276 309,-276 309,-252 365,-252 365,-276"/>
<text text-anchor="middle" x="337" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calccross</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;calccross -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge18" class="edge"><title>proc~makestackingfaultecci&#45;&gt;calccross</title>
<path fill="none" stroke="#ff0000" d="M85.0036,-214.045C104.047,-223.467 132.083,-236.091 158,-243 205.479,-255.658 262.112,-260.69 298.541,-262.688"/>
<polygon fill="#ff0000" stroke="#ff0000" points="298.547,-266.193 308.709,-263.196 298.896,-259.202 298.547,-266.193"/>
</g>
<!-- normvec -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node11" class="node"><title>normvec</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normvec</text>
</g>
<!-- proc~makestackingfaultecci&#45;&gt;normvec -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge19" class="edge"><title>proc~makestackingfaultecci&#45;&gt;normvec</title>
<path fill="none" stroke="#ff0000" d="M122.213,-197.658C175.496,-192.598 247.968,-182.337 269,-163 313.134,-122.423 270.031,-81.6972 305,-33 305.455,-32.3664 305.935,-31.746 306.438,-31.1391"/>
<polygon fill="#ff0000" stroke="#ff0000" points="309.098,-33.4402 313.939,-24.0161 304.277,-28.3642 309.098,-33.4402"/>
</g>
<!-- proc~makeyshdislocation&#45;&gt;transspace -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge9" class="edge"><title>proc~makeyshdislocation&#45;&gt;transspace</title>
<path fill="none" stroke="#3200ff" d="M223.354,-234.25C238.591,-254.842 271.388,-297.075 305,-327 305.983,-327.875 307.005,-328.744 308.053,-329.6"/>
<polygon fill="#3200ff" stroke="#3200ff" points="306.299,-332.66 316.395,-335.872 310.505,-327.065 306.299,-332.66"/>
</g>
<!-- proc~makeyshdislocation&#45;&gt;calcangle -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge4" class="edge"><title>proc~makeyshdislocation&#45;&gt;calcangle</title>
<path fill="none" stroke="#3200ff" d="M231.804,-234.143C249.985,-246.878 279.435,-267.443 305,-285 306.437,-285.987 307.913,-286.997 309.404,-288.015"/>
<polygon fill="#3200ff" stroke="#3200ff" points="307.705,-291.093 317.942,-293.824 311.642,-285.305 307.705,-291.093"/>
</g>
<!-- proc~makeyshdislocation&#45;&gt;calccross -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge8" class="edge"><title>proc~makeyshdislocation&#45;&gt;calccross</title>
<path fill="none" stroke="#3200ff" d="M249.317,-234.036C264.996,-239.455 283.512,-245.856 299.398,-251.347"/>
<polygon fill="#3200ff" stroke="#3200ff" points="298.305,-254.673 308.9,-254.632 300.592,-248.057 298.305,-254.673"/>
</g>
<!-- proc~makeyshdislocation&#45;&gt;normvec -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge2" class="edge"><title>proc~makeyshdislocation&#45;&gt;normvec</title>
<path fill="none" stroke="#3200ff" d="M251.773,-209.867C258.291,-206.292 264.434,-201.745 269,-196 315.159,-137.918 263.331,-94.3832 305,-33 305.354,-32.479 305.725,-31.9673 306.112,-31.465"/>
<polygon fill="#3200ff" stroke="#3200ff" points="308.843,-33.6856 313.474,-24.1564 303.911,-28.7179 308.843,-33.6856"/>
</g>
<!-- om2qu -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node12" class="node"><title>om2qu</title>
<polygon fill="#777777" stroke="#777777" points="364,-150 310,-150 310,-126 364,-126 364,-150"/>
<text text-anchor="middle" x="337" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">om2qu</text>
</g>
<!-- proc~makeyshdislocation&#45;&gt;om2qu -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge1" class="edge"><title>proc~makeyshdislocation&#45;&gt;om2qu</title>
<path fill="none" stroke="#3200ff" d="M244.705,-209.916C252.92,-206.02 261.588,-201.315 269,-196 287.645,-182.629 287.411,-173.733 305,-159 306.152,-158.035 307.35,-157.073 308.574,-156.121"/>
<polygon fill="#3200ff" stroke="#3200ff" points="310.853,-158.791 316.865,-150.067 306.725,-153.137 310.853,-158.791"/>
</g>
<!-- calcdot -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node13" class="node"><title>calcdot</title>
<polygon fill="#777777" stroke="#777777" points="364,-108 310,-108 310,-84 364,-84 364,-108"/>
<text text-anchor="middle" x="337" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calcdot</text>
</g>
<!-- proc~makeyshdislocation&#45;&gt;calcdot -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge3" class="edge"><title>proc~makeyshdislocation&#45;&gt;calcdot</title>
<path fill="none" stroke="#3200ff" d="M249.16,-209.943C256.344,-206.283 263.416,-201.683 269,-196 296.043,-168.478 280.099,-146.474 305,-117 305.606,-116.283 306.242,-115.58 306.903,-114.892"/>
<polygon fill="#3200ff" stroke="#3200ff" points="309.445,-117.319 314.695,-108.116 304.852,-112.037 309.445,-117.319"/>
</g>
<!-- calclength -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node14" class="node"><title>calclength</title>
<polygon fill="#777777" stroke="#777777" points="367,-66 307,-66 307,-42 367,-42 367,-66"/>
<text text-anchor="middle" x="337" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calclength</text>
</g>
<!-- proc~makeyshdislocation&#45;&gt;calclength -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge5" class="edge"><title>proc~makeyshdislocation&#45;&gt;calclength</title>
<path fill="none" stroke="#3200ff" d="M250.89,-209.904C257.638,-206.303 264.095,-201.737 269,-196 305.463,-153.356 271.841,-120.261 305,-75 305.461,-74.3707 305.947,-73.7543 306.454,-73.1509"/>
<polygon fill="#3200ff" stroke="#3200ff" points="309.11,-75.4579 313.993,-66.0554 304.312,-70.3607 309.11,-75.4579"/>
</g>
<!-- fatalerror -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node15" class="node"><title>fatalerror</title>
<polygon fill="#777777" stroke="#777777" points="364.5,-234 309.5,-234 309.5,-210 364.5,-210 364.5,-234"/>
<text text-anchor="middle" x="337" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">fatalerror</text>
</g>
<!-- proc~makeyshdislocation&#45;&gt;fatalerror -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge6" class="edge"><title>proc~makeyshdislocation&#45;&gt;fatalerror</title>
<path fill="none" stroke="#3200ff" d="M268.145,-222C278.603,-222 289.345,-222 299.109,-222"/>
<polygon fill="#3200ff" stroke="#3200ff" points="299.261,-225.5 309.261,-222 299.261,-218.5 299.261,-225.5"/>
</g>
<!-- writevalue -->
<g id="proc~~makestackingfaultecci~~CallsGraph_node16" class="node"><title>writevalue</title>
<polygon fill="#777777" stroke="#777777" points="367,-192 307,-192 307,-168 367,-168 367,-192"/>
<text text-anchor="middle" x="337" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">writevalue</text>
</g>
<!-- proc~makeyshdislocation&#45;&gt;writevalue -->
<g id="proc~~makestackingfaultecci~~CallsGraph_edge7" class="edge"><title>proc~makeyshdislocation&#45;&gt;writevalue</title>
<path fill="none" stroke="#3200ff" d="M249.317,-209.964C264.273,-204.795 281.81,-198.732 297.183,-193.418"/>
<polygon fill="#3200ff" stroke="#3200ff" points="298.617,-196.626 306.924,-190.051 296.33,-190.01 298.617,-196.626"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,-0 63,-0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,-0 135.5,-0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,-0 207.5,-0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,-0 359.5,-0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,-0 431.5,-0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="545.5,-24 449.5,-24 449.5,-0 545.5,-0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makestackingfaultecci~~CalledByGraph Pages: 1 -->
<svg id="procmakestackingfaultecciCalledByGraph" width="410pt" height="32pt"
 viewBox="0.00 0.00 410.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makestackingfaultecci~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~makestackingfaultecci~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 406,-28 406,4 -4,4"/>
<!-- proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~CalledByGraph_node1" class="node"><title>proc~makestackingfaultecci</title>
<polygon fill="none" stroke="black" points="402,-24 280,-24 280,-0 402,-0 402,-24"/>
<text text-anchor="middle" x="341" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">makestackingfaultECCI</text>
</g>
<!-- proc~init_stacking_fault_data -->
<g id="proc~~makestackingfaultecci~~CalledByGraph_node2" class="node"><title>proc~init_stacking_fault_data</title>
<g id="a_proc~~makestackingfaultecci~~CalledByGraph_node2"><a xlink:href="../proc/init_stacking_fault_data.html" xlink:title="init_stacking_fault_data">
<polygon fill="#d9534f" stroke="#d9534f" points="244,-24 122,-24 122,-0 244,-0 244,-24"/>
<text text-anchor="middle" x="183" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_stacking_fault_data</text>
</a>
</g>
</g>
<!-- proc~init_stacking_fault_data&#45;&gt;proc~makestackingfaultecci -->
<g id="proc~~makestackingfaultecci~~CalledByGraph_edge2" class="edge"><title>proc~init_stacking_fault_data&#45;&gt;proc~makestackingfaultecci</title>
<path fill="none" stroke="#ff0000" d="M244.314,-12C252.604,-12 261.175,-12 269.626,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="269.847,-15.5001 279.847,-12 269.847,-8.5001 269.847,-15.5001"/>
</g>
<!-- proc~initializedefects -->
<g id="proc~~makestackingfaultecci~~CalledByGraph_node3" class="node"><title>proc~initializedefects</title>
<g id="a_proc~~makestackingfaultecci~~CalledByGraph_node3"><a xlink:href="../proc/initializedefects.html" xlink:title="InitializeDefects">
<polygon fill="#d9534f" stroke="#d9534f" points="86,-24 0,-24 0,-0 86,-0 86,-24"/>
<text text-anchor="middle" x="43" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">InitializeDefects</text>
</a>
</g>
</g>
<!-- proc~initializedefects&#45;&gt;proc~init_stacking_fault_data -->
<g id="proc~~makestackingfaultecci~~CalledByGraph_edge1" class="edge"><title>proc~initializedefects&#45;&gt;proc~init_stacking_fault_data</title>
<path fill="none" stroke="#ff0000" d="M86.1544,-12C94.2443,-12 102.918,-12 111.62,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="111.816,-15.5001 121.816,-12 111.816,-8.5001 111.816,-15.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,-0 63,-0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,-0 135.5,-0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,-0 207.5,-0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,-0 359.5,-0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,-0 431.5,-0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="545.5,-24 449.5,-24 449.5,-0 545.5,-0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/makestackingfaultecci.html#src">makestackingfaultECCI</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">recursive subroutine </span><span class="n">makestackingfaultECCI</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">,</span><span class="n">inum</span><span class="p">,</span><span class="n">DF_L</span><span class="p">,</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">,</span><span class="n">DF_g</span><span class="p">,</span><span class="n">dinfo</span><span class="p">)</span>
<span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: makestackingfaultECCI</span>

<span class="k">use </span><span class="n">math</span>
<span class="k">use </span><span class="n">constants</span>
<span class="k">use </span><span class="n">files</span>
<span class="k">use </span><span class="n">rotations</span>
<span class="k">use </span><span class="n">crystal</span>
<span class="k">use </span><span class="n">symmetry</span>
<span class="k">use </span><span class="n">math</span>

<span class="k">IMPLICIT NONE</span>

<span class="k">type</span><span class="p">(</span><span class="n">defecttype</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">defects</span>
<span class="k">type</span><span class="p">(</span><span class="n">unitcell</span><span class="p">),</span><span class="k">pointer</span>          <span class="kd">::</span> <span class="n">cell</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DF_L</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">DF_g</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">inum</span><span class="p">,</span> <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span><span class="p">,</span> <span class="n">dinfo</span>

<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>                  <span class="kd">::</span> <span class="n">fpn</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">am</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">midpoint</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ex</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ey</span><span class="p">(</span><span class="mi">3</span><span class="p">),&amp;</span>
                                 <span class="n">lptopi</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tptopi</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tpboti</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">det</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">xx</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">yy</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
                                 <span class="n">planenormal</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">rzero</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">unita</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">lun</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">tun</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">zang</span><span class="p">,</span> <span class="n">zu</span><span class="p">,</span> <span class="n">zz</span>

<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">ipiv</span><span class="p">,</span><span class="n">minx</span><span class="p">,</span><span class="n">maxx</span><span class="p">,</span><span class="n">miny</span><span class="p">,</span><span class="n">maxy</span><span class="p">,</span> <span class="n">ndl</span>

<span class="n">ndl</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">numYdisl</span>

<span class="c">! we begin by computing the geometry in the foil reference frame, which is the cartesian frame </span>
<span class="c">! for zero sample tilt;  sample tilts are applied once we known the partial dislocation geometry</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">plane</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">planenormal</span> <span class="o">=</span>  <span class="n">tmp</span>

<span class="k">call </span><span class="n">CalcCross</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">planenormal</span><span class="p">,</span> <span class="p">(</span><span class="o">/</span> <span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span> <span class="o">/</span><span class="p">),</span>  <span class="n">unita</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">unita</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">fpn</span> <span class="o">=</span> <span class="n">planenormal</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; unita should have zero third component &#39;</span><span class="p">,</span><span class="n">unita</span><span class="p">,</span> <span class="n">fpn</span>


<span class="c">! the fault plane goes through the point rzero in the foil top surface</span>
<span class="n">rzero</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span><span class="p">,</span> <span class="nb">sngl</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">/</span><span class="p">)</span>

<span class="c">! this leads to the location of the partial dislocation intersections, and these must</span>
<span class="c">! be Yoffe dislocations !!!</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpr</span> <span class="o">=</span> <span class="n">rzero</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">sep</span><span class="o">*</span><span class="n">unita</span> <span class="o">/</span> <span class="n">DF_L</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpr</span> <span class="o">=</span> <span class="n">rzero</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">sep</span><span class="o">*</span><span class="n">unita</span> <span class="o">/</span> <span class="n">DF_L</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;lpr_i = &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;tpr_i = &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpr</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>


<span class="c">! convert line directions to the Cartesian crystal reference frame</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpu</span><span class="p">,</span><span class="n">lun</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpu</span><span class="p">,</span><span class="n">tun</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="c">! normalize both vectors</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">lun</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">tun</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>


<span class="c">! call makeYSHdislocation for each of the partials [must be done in main program]</span>
<span class="c">!  if (.not. allocated(YD)) allocate(defects%YD(3*maxdefects))</span>

  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">id</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">jd</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpu</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">burg</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpb</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">g</span> <span class="o">=</span> <span class="n">DF_g</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">sig</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">poisson</span>
  
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">id</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">jd</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpr</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpu</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">burg</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpb</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">))</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">g</span> <span class="o">=</span> <span class="n">DF_g</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">sig</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">poisson</span>

  <span class="k">call </span><span class="n">makeYSHdislocation</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">,</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">dinfo</span><span class="p">,</span><span class="n">DF_L</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Leading Partial Position &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">jd</span>
  <span class="k">call </span><span class="n">makeYSHdislocation</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">,</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">dinfo</span><span class="p">,</span><span class="n">DF_L</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Trailing Partial Position &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">jd</span>

<span class="c">! first find the length of the dislocation line inside the foil along the</span>
<span class="c">! dislocation z-axis, which is the line direction; also, compute the intersection</span>
<span class="c">! points of the line with the top and bottom surfaces  (all components in [nm])</span>
<span class="n">zang</span> <span class="o">=</span> <span class="n">CalcAngle</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">u</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">F</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">zang</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">zz</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">)</span> <span class="k">then </span>
<span class="k">  </span><span class="n">zu</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="o">/</span><span class="n">zz</span><span class="p">)</span>
<span class="k">else</span>
<span class="k">  </span><span class="n">zu</span> <span class="o">=</span> <span class="mi">10000</span><span class="mf">0.0</span>         <span class="c">! this is when the dislocation is nearly parallel to the foil</span>
<span class="k">end if</span>

<span class="c">! transform the line direction to the foil reference frame</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fc</span><span class="p">),</span> <span class="nb">dble</span><span class="p">(</span><span class="n">lun</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">DF_L</span>

<span class="c">! determine the top and bottom intersection coordinates </span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">jd</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">zz</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! u points to the top of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">id</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">jd</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">else</span>                 <span class="c">! u points to the bottom of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">id</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">jd</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">end if</span>  


<span class="c">! first find the length of the dislocation line inside the foil along the</span>
<span class="c">! dislocation z-axis, which is the line direction; also, compute the intersection</span>
<span class="c">! points of the line with the top and bottom surfaces  (all components in [nm])</span>
<span class="n">zang</span> <span class="o">=</span> <span class="n">CalcAngle</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">u</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">F</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">zang</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">zz</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">)</span> <span class="k">then </span>
<span class="k">  </span><span class="n">zu</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="o">/</span><span class="n">zz</span><span class="p">)</span>
<span class="k">else</span>
<span class="k">  </span><span class="n">zu</span> <span class="o">=</span> <span class="mi">10000</span><span class="mf">0.0</span>         <span class="c">! this is when the dislocation is nearly parallel to the foil</span>
<span class="k">end if</span>
<span class="c">! transform the line direction to the foil reference frame</span>
  <span class="n">tmp</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fc</span><span class="p">),</span> <span class="nb">dble</span><span class="p">(</span><span class="n">tun</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">DF_L</span>

<span class="c">! determine the top and bottom intersection coordinates </span>
  <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">jd</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="o">*</span><span class="mf">0.5</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">zz</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! u points to the top of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">id</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">jd</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">else</span>                 <span class="c">! u points to the bottom of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">id</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">jd</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
  <span class="k">end if</span>  


<span class="c">! copy the top and bottom dislocation intersections</span>
<span class="c">! into the corresponding variables of the SF record</span>

<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpbot</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">bottom</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lptop</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">1</span><span class="p">)%</span><span class="n">top</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpbot</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">bottom</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tptop</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">YD</span><span class="p">(</span><span class="n">ndl</span><span class="o">+</span><span class="mi">2</span><span class="p">)%</span><span class="n">top</span>

<span class="c">! obviously, these four points need to lie in a single plane; at this point, we check that this is indeed the case</span>
<span class="c">! by computing the volume of the tetrahedron formed by these four points; if the volume is zero, then the </span>
<span class="c">! points are co-planar.  (Use LAPACK&#39;s LU-decomposition and compute the product of the diagonal elements of U)</span>
<span class="n">am</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lptop</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.0</span> <span class="o">/</span><span class="p">)</span>
<span class="n">am</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpbot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.0</span> <span class="o">/</span><span class="p">)</span> 
<span class="n">am</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tptop</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.0</span> <span class="o">/</span><span class="p">)</span> 
<span class="n">am</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpbot</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">),</span><span class="mf">1.0</span> <span class="o">/</span><span class="p">)</span> 
<span class="k">call </span><span class="n">sgetrf</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">am</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">ipiv</span><span class="p">,</span><span class="n">info</span><span class="p">)</span>
<span class="n">det</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">am</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">am</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">am</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">am</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;determinant (should be zero) = &#39;</span><span class="p">,</span><span class="n">det</span>

<span class="c">! ok, next we need to figure out which image pixels lie on the projection of the stacking fault plane.</span>
<span class="c">! We need to transform the corner points into the image reference frame !!!</span>
<span class="n">lptopi</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fi</span><span class="p">,</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lptop</span><span class="p">))</span>
<span class="n">lpboti</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fi</span><span class="p">,</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpbot</span><span class="p">))</span>
<span class="n">tptopi</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fi</span><span class="p">,</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tptop</span><span class="p">))</span>
<span class="n">tpboti</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fi</span><span class="p">,</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">tpbot</span><span class="p">))</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;SF parameters :&#39;</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">lptopi</span><span class="p">,</span><span class="s1">&#39; &lt;&gt; &#39;</span><span class="p">,</span><span class="n">lpboti</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">tptopi</span><span class="p">,</span><span class="s1">&#39; &lt;&gt; &#39;</span><span class="p">,</span><span class="n">tpboti</span>
<span class="k">end if</span>

<span class="c">! define the array that will contain the zpos values</span>
<span class="k">allocate</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zpos</span><span class="p">(</span><span class="n">nx</span><span class="p">,</span><span class="n">ny</span><span class="p">))</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zpos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span><span class="mf">0.0</span>    <span class="c">! set all points to be outside the projected SF</span>

<span class="c">! first determine the smaller box</span>
<span class="n">minx</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">maxx</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">tpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span> <span class="o">+</span><span class="mi">2</span>
<span class="n">miny</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">))</span> <span class="o">-</span><span class="mi">2</span>
<span class="n">maxy</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">))</span> <span class="o">+</span><span class="mi">2</span>

<span class="c">! the fault edges may fall outside of the viewing frame (origin at the center !!!)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">minx</span><span class="p">.</span><span class="n">lt</span><span class="p">.(</span><span class="o">-</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="n">minx</span><span class="o">=-</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">maxx</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="n">maxx</span><span class="o">=</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span>
<span class="k">if</span> <span class="p">(</span><span class="n">miny</span><span class="p">.</span><span class="n">lt</span><span class="p">.(</span><span class="o">-</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="n">miny</span><span class="o">=-</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="k">if</span> <span class="p">(</span><span class="n">maxy</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="n">maxy</span><span class="o">=</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Integer fault box = &#39;</span><span class="p">,</span><span class="n">minx</span><span class="p">,</span><span class="n">maxx</span><span class="p">,</span><span class="n">miny</span><span class="p">,</span><span class="n">maxy</span>

<span class="c">! get the equation of the stacking fault plane in the image reference frame</span>
<span class="c">! first the unit plane normal in image space</span>
<span class="c">! we&#39;ll take two vectors: ex = from ltop to ttop; ey = from ltop to lbot</span>
<span class="n">ex</span> <span class="o">=</span> <span class="n">tptopi</span> <span class="o">-</span> <span class="n">lptopi</span>
<span class="n">ey</span> <span class="o">=</span> <span class="n">lpboti</span> <span class="o">-</span> <span class="n">lptopi</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">ex</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">CalcCross</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">ex</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="n">fpn</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">fpn</span> <span class="c">! quat_LPstar( conjg(foil%a_fi), dble(fpn(1:3)) )</span>
<span class="n">midpoint</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="n">lptopi</span><span class="o">+</span><span class="n">lpboti</span><span class="o">+</span><span class="n">tptopi</span><span class="o">+</span><span class="n">tpboti</span><span class="p">)</span> <span class="c">! quat_LPstar( conjg(foil%a_fi), dble(0.25*(lptopi+lpboti+tptopi+tpboti) ))</span>
<span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">midpoint</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fault plane parameters : &#39;</span><span class="p">,</span><span class="n">A</span><span class="p">,</span> <span class="n">midpoint</span>

<span class="c">! rank the corner points so that the polygon is convex</span>
<span class="c">! call rank_points(tpboti(1:2),lpboti(1:2),lptopi(1:2),tptopi(1:2),xx,yy)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tptopi</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">tpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">yy</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">lptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">tptopi</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">tpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">lpboti</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>

<span class="c">! for all of the points inside this box:</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">minx</span><span class="p">,</span><span class="n">maxx</span>
  <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="n">miny</span><span class="p">,</span><span class="n">maxy</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">point_inside_polygon</span><span class="p">(</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span> 
<span class="c">! the point lies inside the projected region, </span>
<span class="c">! so we need the depth of the SF plane at this position, taking into account the </span>
<span class="c">! proper coordinate transformation (depth must be expressed in image reference frame)</span>
        <span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zpos</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">nx</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">ny</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">end if</span>
<span class="k">  end do</span>
<span class="k">end do</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;fault plane pixels determined&#39;</span>

<span class="c">! let&#39;s also make sure that the SF displacement vector is translated to the </span>
<span class="c">! cartesian reference frame, so that it can be used directly by the CalcR routine</span>
<span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">lpbc</span> <span class="o">=</span> <span class="nb">matmul</span><span class="p">(</span><span class="n">cell</span><span class="p">%</span><span class="n">dsm</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">SF</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">Rdisp</span><span class="p">)</span>

<span class="c">! that should do it for the stacking fault...  The rest </span>
<span class="c">! takes place in the CalcR routine.</span>
<span class="k">end subroutine </span><span class="n">makestackingfaultECCI</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/adhisteq.html">adhisteq</a>
      
      <a class="list-group-item" href="../proc/aggiorno_ottimo.html">AGGIORNO_OTTIMO</a>
      
      <a class="list-group-item" href="../proc/alogam.html">alogam</a>
      
      <a class="list-group-item" href="../proc/altmov.html">altmov</a>
      
      <a class="list-group-item" href="../proc/altmov%7E2.html">altmov</a>
      
      <a class="list-group-item" href="../proc/backprojection.html">BackProjection</a>
      
      <a class="list-group-item" href="../proc/bakvec.html">bakvec</a>
      
      <a class="list-group-item" href="../proc/balanc.html">balanc</a>
      
      <a class="list-group-item" href="../proc/balbak.html">balbak</a>
      
      <a class="list-group-item" href="../proc/bandr.html">bandr</a>
      
      <a class="list-group-item" href="../proc/bandv.html">bandv</a>
      
      <a class="list-group-item" href="../proc/barreldistortion.html">BarrelDistortion</a>
      
      <a class="list-group-item" href="../proc/bisect.html">bisect</a>
      
      <a class="list-group-item" href="../proc/bobyqa.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqa%7E2.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqb.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bobyqb%7E2.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bqr.html">bqr</a>
      
      <a class="list-group-item" href="../proc/butterflymask9x9.html">ButterflyMask9x9</a>
      
      <a class="list-group-item" href="../proc/calchoughlut.html">CalcHoughLUT</a>
      
      <a class="list-group-item" href="../proc/calckinpedpatternsingle.html">CalcKINPEDPatternSingle</a>
      
      <a class="list-group-item" href="../proc/calckvectorcone.html">Calckvectorcone</a>
      
      <a class="list-group-item" href="../proc/calckvectortrace.html">Calckvectortrace</a>
      
      <a class="list-group-item" href="../proc/calcr.html">CalcR</a>
      
      <a class="list-group-item" href="../proc/calcrlocal.html">CalcRLocal</a>
      
      <a class="list-group-item" href="../proc/cardintersection.html">CardIntersection</a>
      
      <a class="list-group-item" href="../proc/cbabk2.html">cbabk2</a>
      
      <a class="list-group-item" href="../proc/cbal.html">cbal</a>
      
      <a class="list-group-item" href="../proc/cdiv.html">cdiv</a>
      
      <a class="list-group-item" href="../proc/cg.html">cg</a>
      
      <a class="list-group-item" href="../proc/ch.html">ch</a>
      
      <a class="list-group-item" href="../proc/cinvit.html">cinvit</a>
      
      <a class="list-group-item" href="../proc/clerror_check.html">CLerror_check</a>
      
      <a class="list-group-item" href="../proc/clinit_pdccq.html">CLinit_PDCCQ</a>
      
      <a class="list-group-item" href="../proc/clquery_platform_info.html">CLquery_platform_info</a>
      
      <a class="list-group-item" href="../proc/clread_source_file.html">CLread_source_file</a>
      
      <a class="list-group-item" href="../proc/combak.html">combak</a>
      
      <a class="list-group-item" href="../proc/comhes.html">comhes</a>
      
      <a class="list-group-item" href="../proc/comlr.html">comlr</a>
      
      <a class="list-group-item" href="../proc/comlr2.html">comlr2</a>
      
      <a class="list-group-item" href="../proc/comqr.html">comqr</a>
      
      <a class="list-group-item" href="../proc/comqr2.html">comqr2</a>
      
      <a class="list-group-item" href="../proc/cortb.html">cortb</a>
      
      <a class="list-group-item" href="../proc/corth.html">corth</a>
      
      <a class="list-group-item" href="../proc/csroot.html">csroot</a>
      
      <a class="list-group-item" href="../proc/ctfped_writefile.html">ctfped_writeFile</a>
      
      <a class="list-group-item" href="../proc/cubochoricneighbors.html">CubochoricNeighbors</a>
      
      <a class="list-group-item" href="../proc/cumul_histogram.html">cumul_histogram</a>
      
      <a class="list-group-item" href="../proc/dd_density.html">DD_Density</a>
      
      <a class="list-group-item" href="../proc/dd_estep.html">DD_Estep</a>
      
      <a class="list-group-item" href="../proc/dd_getqandl.html">DD_getQandL</a>
      
      <a class="list-group-item" href="../proc/dd_mstep.html">DD_Mstep</a>
      
      <a class="list-group-item" href="../proc/delete_fzlist.html">delete_FZlist</a>
      
      <a class="list-group-item" href="../proc/denoise_pattern.html">Denoise_Pattern</a>
      
      <a class="list-group-item" href="../proc/denoise_ped.html">Denoise_PED</a>
      
      <a class="list-group-item" href="../proc/di_emfordd.html">DI_EMforDD</a>
      
      <a class="list-group-item" href="../proc/di_init.html">DI_Init</a>
      
      <a class="list-group-item" href="../proc/di_rotatetomu.html">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../proc/di_sampledd.html">DI_SampleDD</a>
      
      <a class="list-group-item" href="../proc/di_similarity_classifier.html">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../proc/ebsd4calfun.html">EBSD4calfun</a>
      
      <a class="list-group-item" href="../proc/ebsdcalfun.html">EBSDcalfun</a>
      
      <a class="list-group-item" href="../proc/eccicalcsgh.html">ECCICalcSgh</a>
      
      <a class="list-group-item" href="../proc/ecpcalfun.html">ECPcalfun</a>
      
      <a class="list-group-item" href="../proc/efitebsdwrapper.html">efitEBSDWrapper</a>
      
      <a class="list-group-item" href="../proc/efitecpwrapper.html">efitECPWrapper</a>
      
      <a class="list-group-item" href="../proc/ei.html">EI</a>
      
      <a class="list-group-item" href="../proc/elmbak.html">elmbak</a>
      
      <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
      
      <a class="list-group-item" href="../proc/eltran.html">eltran</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdmaster.html">EMsoftCgetEBSDmaster</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdpatterns.html">EMsoftCgetEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetecpatterns.html">EMsoftCgetECPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetmcopencl.html">EMsoftCgetMCOpenCL</a>
      
      <a class="list-group-item" href="../proc/eshelby_disp.html">Eshelby_disp</a>
      
      <a class="list-group-item" href="../proc/fcore.html">FCORE</a>
      
      <a class="list-group-item" href="../proc/figi.html">figi</a>
      
      <a class="list-group-item" href="../proc/figi2.html">figi2</a>
      
      <a class="list-group-item" href="../proc/forwardprojection.html">ForwardProjection</a>
      
      <a class="list-group-item" href="../proc/fphon.html">FPHON</a>
      
      <a class="list-group-item" href="../proc/fscatt.html">FSCATT</a>
      
      <a class="list-group-item" href="../proc/genera_punto_sa.html">GENERA_PUNTO_SA</a>
      
      <a class="list-group-item" href="../proc/getaverageorientationnamelist.html">GetAverageOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getconvertorientationsnamelist.html">GetConvertOrientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdddensitylbm.html">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../proc/getdictindxopenclnamelist.html">GetDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../interface/getdisorientationangle.html">getDisorientationAngle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxis.html">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxistwophases.html">getDisorientationAngleAxisTwoPhases</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangledouble.html">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../proc/getdisorientationanglesingle.html">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationsnamelist.html">GetDisorientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdvsdnamelist.html">GetDvsDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdclusternamelist.html">GetEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsddetparmscannamelist.html">GetEBSDdetparmscanNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdfullnamelist.html">GetEBSDFullNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdindexingnamelist.html">GetEBSDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasternamelist.html">GetEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasteropenclnamelist.html">GetEBSDMasterOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdnamelist.html">GetEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdoverlapnamelist.html">GetEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns.html">getEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns2.html">getEBSDPatterns2</a>
      
      <a class="list-group-item" href="../proc/getebsdpatternswrapper.html">getEBSDPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/geteccinamelist.html">GetECCINameList</a>
      
      <a class="list-group-item" href="../proc/getecpatterns.html">getECPatterns</a>
      
      <a class="list-group-item" href="../proc/getecpatternswrapper.html">getECPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getecpindexingnamelist.html">GetECPIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getecpmasternamelist.html">GetECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getecpnamelist.html">GetECPNameList</a>
      
      <a class="list-group-item" href="../proc/getecppatternnamelist.html">GetECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/getecpsinglenamelist.html">GetECPSingleNameList</a>
      
      <a class="list-group-item" href="../proc/getecpzanamelist.html">GetECPZANameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfit4namelist.html">GetEMDPFit4NameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfitnamelist.html">GetEMDPFitNameList</a>
      
      <a class="list-group-item" href="../proc/geteulersfromfile.html">getEulersfromFile</a>
      
      <a class="list-group-item" href="../proc/getfitorientationpsnamelist.html">GetFitOrientationPSNameList</a>
      
      <a class="list-group-item" href="../proc/getfztypeandorder.html">getFZtypeandorder</a>
      
      <a class="list-group-item" href="../proc/getkamnamelist.html">GetKAMNameList</a>
      
      <a class="list-group-item" href="../proc/getkinematicalnamelist.html">GetkinematicalNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselmasternamelist.html">GetKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselnamelist.html">GetKosselNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselpatterns.html">getKosselPatterns</a>
      
      <a class="list-group-item" href="../proc/getkosselpatternswrapper.html">getKosselPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getlacbednamelist.html">GetLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclfoilnamelist.html">GetMCCLfoilNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclmultilayernamelist.html">GetMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclnamelist.html">GetMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclspherenamelist.html">GetMCCLsphereNameList</a>
      
      <a class="list-group-item" href="../proc/getmclipssnamelist.html">GetMCLIPSSNameList</a>
      
      <a class="list-group-item" href="../proc/getmcnamelist.html">GetMCNameList</a>
      
      <a class="list-group-item" href="../proc/getmultiphasenamelist.html">GetMultiPhaseNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationsimilaritynamelist.html">GetOrientationSimilarityNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationviznamelist.html">GetOrientationVizNameList</a>
      
      <a class="list-group-item" href="../proc/getpedindxnamelist.html">GetPEDIndxNameList</a>
      
      <a class="list-group-item" href="../proc/getpedkinnamelist.html">GetPEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/getpedzanamelist.html">GetPEDZANameList</a>
      
      <a class="list-group-item" href="../proc/getpfinversionnamelist.html">GetPFInversionNameList</a>
      
      <a class="list-group-item" href="../proc/getrefineorientationnamelist.html">GetRefineOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getreflectornamelist.html">GetreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/getrfznamelist.html">GetRFZNameList</a>
      
      <a class="list-group-item" href="../proc/getsrdefectnamelist.html">GetSRdefectNameList</a>
      
      <a class="list-group-item" href="../proc/getstemdcinamelist.html">GetSTEMDCINameList</a>
      
      <a class="list-group-item" href="../proc/gettkdindexingnamelist.html">GetTKDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdmasternamelist.html">GetTKDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdnamelist.html">GetTKDNameList</a>
      
      <a class="list-group-item" href="../proc/getwk.html">GETWK</a>
      
      <a class="list-group-item" href="../proc/getzadefectnamelist.html">GetZAdefectNameList</a>
      
      <a class="list-group-item" href="../proc/hipassfilter.html">HiPassFilter</a>
      
      <a class="list-group-item" href="../proc/houghtransform.html">HoughTransform</a>
      
      <a class="list-group-item" href="../proc/hqr.html">hqr</a>
      
      <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
      
      <a class="list-group-item" href="../proc/htrib3.html">htrib3</a>
      
      <a class="list-group-item" href="../proc/htribk.html">htribk</a>
      
      <a class="list-group-item" href="../proc/htrid3.html">htrid3</a>
      
      <a class="list-group-item" href="../proc/htridi.html">htridi</a>
      
      <a class="list-group-item" href="../proc/image_entropy.html">image_entropy</a>
      
      <a class="list-group-item" href="../proc/image_histogram.html">image_histogram</a>
      
      <a class="list-group-item" href="../proc/image_jointentropy.html">image_jointentropy</a>
      
      <a class="list-group-item" href="../proc/image_jointhistogram.html">image_jointhistogram</a>
      
      <a class="list-group-item" href="../proc/image_mutualinformation.html">image_mutualinformation</a>
      
      <a class="list-group-item" href="../proc/imtql1.html">imtql1</a>
      
      <a class="list-group-item" href="../proc/imtql2.html">imtql2</a>
      
      <a class="list-group-item" href="../proc/imtqlv.html">imtqlv</a>
      
      <a class="list-group-item" href="../proc/init_dislocation_data.html">init_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/init_einclusion_data.html">init_Einclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_foil_data.html">init_foil_data</a>
      
      <a class="list-group-item" href="../proc/init_inclusion_data.html">init_inclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_stacking_fault_data.html">init_stacking_fault_data</a>
      
      <a class="list-group-item" href="../proc/init_stem.html">init_STEM</a>
      
      <a class="list-group-item" href="../proc/init_stem_za.html">init_STEM_ZA</a>
      
      <a class="list-group-item" href="../proc/init_void_data.html">init_void_data</a>
      
      <a class="list-group-item" href="../proc/init_ysh_dislocation_data.html">init_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/initialize_foil_geometry.html">initialize_foil_geometry</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../interface/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist_ewaldsweep.html">Initialize_ReflectionList_EwaldSweep</a>
      
      <a class="list-group-item" href="../proc/initializedefects.html">InitializeDefects</a>
      
      <a class="list-group-item" href="../proc/initializeeshelbyinclusion.html">InitializeEshelbyInclusion</a>
      
      <a class="list-group-item" href="../proc/innerprodgpu.html">InnerProdGPU</a>
      
      <a class="list-group-item" href="../proc/insidecubehexfz.html">insideCubeHexFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicfz.html">insideCubicFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicmfz.html">insideCubicMFZ</a>
      
      <a class="list-group-item" href="../proc/insidecyclicfz.html">insideCyclicFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralfz.html">insideDihedralFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralmfz.html">insideDihedralMFZ</a>
      
      <a class="list-group-item" href="../proc/interfaccia.html">INTERFACCIA</a>
      
      <a class="list-group-item" href="../proc/inversiondivision.html">InversionDivision</a>
      
      <a class="list-group-item" href="../proc/invit.html">invit</a>
      
      <a class="list-group-item" href="../proc/isinsidefz.html">IsinsideFZ</a>
      
      <a class="list-group-item" href="../proc/isinsidemfz.html">IsinsideMFZ</a>
      
      <a class="list-group-item" href="../proc/jaccard_distance.html">Jaccard_Distance</a>
      
      <a class="list-group-item" href="../proc/json_cleanuppointers.html">JSON_cleanuppointers</a>
      
      <a class="list-group-item" href="../proc/json_failtest.html">JSON_failtest</a>
      
      <a class="list-group-item" href="../proc/json_initpointers.html">JSON_initpointers</a>
      
      <a class="list-group-item" href="../proc/json_minify.html">JSON_minify</a>
      
      <a class="list-group-item" href="../proc/json_writenmldoubles.html">JSON_writeNMLdoubles</a>
      
      <a class="list-group-item" href="../proc/json_writenmlintegers.html">JSON_writeNMLintegers</a>
      
      <a class="list-group-item" href="../proc/json_writenmlreals.html">JSON_writeNMLreals</a>
      
      <a class="list-group-item" href="../proc/jsongetdouble.html">JSONgetDouble</a>
      
      <a class="list-group-item" href="../proc/jsongetdoublevector.html">JSONgetDoubleVector</a>
      
      <a class="list-group-item" href="../proc/jsonreaddefectfile.html">JSONreadDefectFile</a>
      
      <a class="list-group-item" href="../proc/jsonreaddouble.html">JSONreadDouble</a>
      
      <a class="list-group-item" href="../proc/jsonreaddoublevec.html">JSONreadDoubleVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdclusternamelist.html">JSONreadEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdmasternamelist.html">JSONreadEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdnamelist.html">JSONreadEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdoverlapnamelist.html">JSONreadEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadecpmasternamelist.html">JSONreadECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadfoildata.html">JSONreadFoilData</a>
      
      <a class="list-group-item" href="../proc/jsonreadinteger.html">JSONreadInteger</a>
      
      <a class="list-group-item" href="../proc/jsonreadintegervec.html">JSONreadIntegerVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselmasternamelist.html">JSONreadKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselnamelist.html">JSONreadKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadlogical.html">JSONreadLogical</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclmultilayernamelist.html">JSONreadMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclnamelist.html">JSONreadMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcnamelist.html">JSONreadMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadreal.html">JSONreadReal</a>
      
      <a class="list-group-item" href="../proc/jsonreadrealvec.html">JSONreadRealVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadreflectornamelist.html">JSONreadreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadstring.html">JSONreadString</a>
      
      <a class="list-group-item" href="../proc/jsonwritedictindxopenclnamelist.html">JSONwriteDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdclusternamelist.html">JSONwriteEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdmasternamelist.html">JSONwriteEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdnamelist.html">JSONwriteEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteeccinamelist.html">JSONwriteECCINameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpmasternamelist.html">JSONwriteECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpnamelist.html">JSONwriteECPNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecppatternnamelist.html">JSONwriteECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselmasternamelist.html">JSONwriteKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselnamelist.html">JSONwriteKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritelacbednamelist.html">JSONwriteLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclmultilayernamelist.html">JSONwriteMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclnamelist.html">JSONwriteMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcnamelist.html">JSONwriteMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedkinnamelist.html">JSONwritePEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedzanamelist.html">JSONwritePEDZANameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriterfznamelist.html">JSONwriteRFZNameList</a>
      
      <a class="list-group-item" href="../proc/linesearch_inverti.html">LINESEARCH_INVERTI</a>
      
      <a class="list-group-item" href="../proc/linesearchbox_cont.html">linesearchbox_cont</a>
      
      <a class="list-group-item" href="../proc/logcp.html">logCp</a>
      
      <a class="list-group-item" href="../proc/mainbox1.html">MAINBOX1</a>
      
      <a class="list-group-item" href="../proc/mainbox2.html">MAINBOX2</a>
      
      <a class="list-group-item" href="../proc/makedislocation.html">makedislocation</a>
      
      <a class="list-group-item" href="../proc/makestackingfault.html">makestackingfault</a>
      
      <a class="list-group-item" href="../proc/makestackingfaultecci.html">makestackingfaultECCI</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation%7E2.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/mc_concatenatemuellermatrices.html">MC_concatenateMuellerMatrices</a>
      
      <a class="list-group-item" href="../proc/mc_get_ad_from_eo.html">MC_get_AD_from_EO</a>
      
      <a class="list-group-item" href="../proc/mc_get_auxiliaryangle.html">MC_get_AuxiliaryAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_basicmuellermatrix.html">MC_get_basicMuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_get_diattenuator.html">MC_get_diattenuator</a>
      
      <a class="list-group-item" href="../proc/mc_get_ellipticityangle.html">MC_get_EllipticityAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_eo_from_ad.html">MC_get_EO_from_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_orientationangle.html">MC_get_OrientationAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_phaseshiftangle.html">MC_get_PhaseShiftAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_polarization.html">MC_get_Polarization</a>
      
      <a class="list-group-item" href="../proc/mc_get_retarder.html">MC_get_retarder</a>
      
      <a class="list-group-item" href="../proc/mc_get_rotator.html">MC_get_rotator</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_ad.html">MC_get_Stokes_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_eo.html">MC_get_Stokes_EO</a>
      
      <a class="list-group-item" href="../proc/mc_print_muellermatrix.html">MC_print_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_propagatestokesvector.html">MC_propagateStokesVector</a>
      
      <a class="list-group-item" href="../proc/mc_rotate_muellermatrix.html">MC_rotate_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/minfit.html">minfit</a>
      
      <a class="list-group-item" href="../proc/nanchk.html">NANCHK</a>
      
      <a class="list-group-item" href="../proc/ortbak.html">ortbak</a>
      
      <a class="list-group-item" href="../proc/orthes.html">orthes</a>
      
      <a class="list-group-item" href="../proc/ortran.html">ortran</a>
      
      <a class="list-group-item" href="../proc/pgm_write_file.html">PGM_Write_File</a>
      
      <a class="list-group-item" href="../proc/poidev.html">POIDEV</a>
      
      <a class="list-group-item" href="../proc/povray_addcubochoriccube.html">PoVRay_addCubochoricCube</a>
      
      <a class="list-group-item" href="../proc/povray_addcylinder.html">PoVRay_addCylinder</a>
      
      <a class="list-group-item" href="../proc/povray_addeulerbox.html">PoVRay_addEulerBox</a>
      
      <a class="list-group-item" href="../proc/povray_addreferenceframe.html">PoVRay_addReferenceFrame</a>
      
      <a class="list-group-item" href="../proc/povray_addsphere.html">PoVRay_addSphere</a>
      
      <a class="list-group-item" href="../proc/povray_addwireframesphere.html">PoVRay_addWireFrameSphere</a>
      
      <a class="list-group-item" href="../proc/povray_declare_df3file.html">PoVRay_declare_DF3file</a>
      
      <a class="list-group-item" href="../proc/povray_drawfz.html">PoVRay_drawFZ</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz222.html">PoVRay_getpos_FZ222</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz23.html">PoVRay_getpos_FZ23</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz32.html">PoVRay_getpos_FZ32</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz422.html">PoVRay_getpos_FZ422</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz432.html">PoVRay_getpos_FZ432</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz622.html">PoVRay_getpos_FZ622</a>
      
      <a class="list-group-item" href="../proc/povray_initfz2.html">PoVRay_initFZ2</a>
      
      <a class="list-group-item" href="../proc/povray_initfz3.html">PoVRay_initFZ3</a>
      
      <a class="list-group-item" href="../proc/povray_initfz4.html">PoVRay_initFZ4</a>
      
      <a class="list-group-item" href="../proc/povray_initfz6.html">PoVRay_initFZ6</a>
      
      <a class="list-group-item" href="../proc/povray_openfile.html">PoVRay_openFile</a>
      
      <a class="list-group-item" href="../proc/povray_setcamera.html">PoVRay_setCamera</a>
      
      <a class="list-group-item" href="../proc/povray_setlightsource.html">PoVRay_setLightSource</a>
      
      <a class="list-group-item" href="../proc/povray_write_df3file.html">PoVRay_write_DF3file</a>
      
      <a class="list-group-item" href="../proc/prelim.html">prelim</a>
      
      <a class="list-group-item" href="../proc/prelim%7E2.html">prelim</a>
      
      <a class="list-group-item" href="../proc/printtime.html">PrintTime</a>
      
      <a class="list-group-item" href="../proc/pythag.html">pythag</a>
      
      <a class="list-group-item" href="../proc/qsortd.html">qsortd</a>
      
      <a class="list-group-item" href="../proc/qzhes.html">qzhes</a>
      
      <a class="list-group-item" href="../proc/qzit.html">qzit</a>
      
      <a class="list-group-item" href="../proc/qzval.html">qzval</a>
      
      <a class="list-group-item" href="../proc/qzvec.html">qzvec</a>
      
      <a class="list-group-item" href="../proc/r8_swap.html">r8_swap</a>
      
      <a class="list-group-item" href="../proc/r8mat_print.html">r8mat_print</a>
      
      <a class="list-group-item" href="../proc/r8mat_print_some.html">r8mat_print_some</a>
      
      <a class="list-group-item" href="../proc/r8vec2_print.html">r8vec2_print</a>
      
      <a class="list-group-item" href="../proc/r8vec_print.html">r8vec_print</a>
      
      <a class="list-group-item" href="../proc/ran.html">ran</a>
      
      <a class="list-group-item" href="../proc/randddmarginal.html">randDDMarginal</a>
      
      <a class="list-group-item" href="../proc/randuniformsphere.html">randUniformSphere</a>
      
      <a class="list-group-item" href="../proc/ratqr.html">ratqr</a>
      
      <a class="list-group-item" href="../proc/read_apb_data.html">read_apb_data</a>
      
      <a class="list-group-item" href="../proc/read_stem_data.html">read_STEM_data</a>
      
      <a class="list-group-item" href="../proc/read_ysh_dislocation_data.html">read_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/rebak.html">rebak</a>
      
      <a class="list-group-item" href="../proc/rebakb.html">rebakb</a>
      
      <a class="list-group-item" href="../proc/reduc.html">reduc</a>
      
      <a class="list-group-item" href="../proc/reduc2.html">reduc2</a>
      
      <a class="list-group-item" href="../proc/reducedisorientationtomfz.html">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtocubicefz.html">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtorfz.html">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../proc/rescue.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rescue%7E2.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rg.html">rg</a>
      
      <a class="list-group-item" href="../proc/rgg.html">rgg</a>
      
      <a class="list-group-item" href="../proc/ri1.html">RI1</a>
      
      <a class="list-group-item" href="../proc/ri2.html">RI2</a>
      
      <a class="list-group-item" href="../proc/ricerca_lungo_assi.html">RICERCA_LUNGO_ASSI</a>
      
      <a class="list-group-item" href="../proc/rih1.html">RIH1</a>
      
      <a class="list-group-item" href="../proc/rih2.html">RIH2</a>
      
      <a class="list-group-item" href="../proc/rih3.html">RIH3</a>
      
      <a class="list-group-item" href="../proc/rng_seed.html">rng_seed</a>
      
      <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
      
      <a class="list-group-item" href="../proc/rs.html">rs</a>
      
      <a class="list-group-item" href="../proc/rsb.html">rsb</a>
      
      <a class="list-group-item" href="../proc/rsg.html">rsg</a>
      
      <a class="list-group-item" href="../proc/rsgab.html">rsgab</a>
      
      <a class="list-group-item" href="../proc/rsgba.html">rsgba</a>
      
      <a class="list-group-item" href="../proc/rsm.html">rsm</a>
      
      <a class="list-group-item" href="../proc/rsp.html">rsp</a>
      
      <a class="list-group-item" href="../proc/rspp.html">rspp</a>
      
      <a class="list-group-item" href="../proc/rst.html">rst</a>
      
      <a class="list-group-item" href="../proc/rt.html">rt</a>
      
      <a class="list-group-item" href="../proc/sample_cone.html">sample_Cone</a>
      
      <a class="list-group-item" href="../proc/sample_isocube.html">sample_isoCube</a>
      
      <a class="list-group-item" href="../proc/sample_isocubefilled.html">sample_isoCubeFilled</a>
      
      <a class="list-group-item" href="../proc/samplefcctwinrfz.html">SamplefcctwinRFZ</a>
      
      <a class="list-group-item" href="../proc/sampleisomisorientation.html">SampleIsoMisorientation</a>
      
      <a class="list-group-item" href="../proc/samplerfz.html">SampleRFZ</a>
      
      <a class="list-group-item" href="../proc/samplerfztwin.html">SampleRFZtwin</a>
      
      <a class="list-group-item" href="../proc/senzaderglob.html">SENZADERGLOB</a>
      
      <a class="list-group-item" href="../proc/ssort.html">SSORT</a>
      
      <a class="list-group-item" href="../proc/stop.html">STOP</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/time_estimate.html">Time_estimate</a>
      
      <a class="list-group-item" href="../proc/time_remaining.html">Time_remaining</a>
      
      <a class="list-group-item" href="../proc/time_report.html">Time_report</a>
      
      <a class="list-group-item" href="../proc/time_reset.html">Time_reset</a>
      
      <a class="list-group-item" href="../proc/time_start.html">Time_start</a>
      
      <a class="list-group-item" href="../proc/time_stop.html">Time_stop</a>
      
      <a class="list-group-item" href="../proc/time_tick.html">Time_tick</a>
      
      <a class="list-group-item" href="../proc/time_tock.html">Time_tock</a>
      
      <a class="list-group-item" href="../proc/timestamp.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/timestamp%7E2.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/tinvit.html">tinvit</a>
      
      <a class="list-group-item" href="../proc/tql1.html">tql1</a>
      
      <a class="list-group-item" href="../proc/tql2.html">tql2</a>
      
      <a class="list-group-item" href="../proc/tqlrat.html">tqlrat</a>
      
      <a class="list-group-item" href="../proc/trbak1.html">trbak1</a>
      
      <a class="list-group-item" href="../proc/trbak3.html">trbak3</a>
      
      <a class="list-group-item" href="../proc/tred1.html">tred1</a>
      
      <a class="list-group-item" href="../proc/tred2.html">tred2</a>
      
      <a class="list-group-item" href="../proc/tred3.html">tred3</a>
      
      <a class="list-group-item" href="../proc/tridib.html">tridib</a>
      
      <a class="list-group-item" href="../proc/trsbox.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/trsbox%7E2.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/tsturm.html">tsturm</a>
      
      <a class="list-group-item" href="../proc/update.html">update</a>
      
      <a class="list-group-item" href="../proc/update%7E2.html">update</a>
      
      <a class="list-group-item" href="../proc/vmfmeandirdensity.html">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/watsonmeandirdensity.html">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/weko.html">WEKO</a>
      
      <a class="list-group-item" href="../proc/yshdisp%7E2.html">YSHDisp</a>
      
      <a class="list-group-item" href="../proc/yshdisp.html">YSHDisp</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Fortran Program was developed by Marc De Graef Research Group/Carnegie Mellon University</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>