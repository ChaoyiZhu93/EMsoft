<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="EMsoft main library">
    
    <meta name="author" content="Marc De Graef Research Group/Carnegie Mellon University" >
    <link rel="icon" href="../favicon.png">

    <title>makedislocation &ndash; Fortran Program</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>makedislocation
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 0.8% of total for procedures.">219 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/defectmodule.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/defectmodule.f90.html'>defectmodule.f90</a></li>
  
     <li><a href='../module/defectmodule.html'>defectmodule</a></li>
  
     <li class="active">makedislocation</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/makedislocation.html#src">makedislocation</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/adhisteq.html">adhisteq</a>
      
      <a class="list-group-item" href="../proc/aggiorno_ottimo.html">AGGIORNO_OTTIMO</a>
      
      <a class="list-group-item" href="../proc/alogam.html">alogam</a>
      
      <a class="list-group-item" href="../proc/altmov.html">altmov</a>
      
      <a class="list-group-item" href="../proc/altmov%7E2.html">altmov</a>
      
      <a class="list-group-item" href="../proc/backprojection.html">BackProjection</a>
      
      <a class="list-group-item" href="../proc/bakvec.html">bakvec</a>
      
      <a class="list-group-item" href="../proc/balanc.html">balanc</a>
      
      <a class="list-group-item" href="../proc/balbak.html">balbak</a>
      
      <a class="list-group-item" href="../proc/bandr.html">bandr</a>
      
      <a class="list-group-item" href="../proc/bandv.html">bandv</a>
      
      <a class="list-group-item" href="../proc/barreldistortion.html">BarrelDistortion</a>
      
      <a class="list-group-item" href="../proc/bisect.html">bisect</a>
      
      <a class="list-group-item" href="../proc/bobyqa.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqa%7E2.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqb.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bobyqb%7E2.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bqr.html">bqr</a>
      
      <a class="list-group-item" href="../proc/butterflymask9x9.html">ButterflyMask9x9</a>
      
      <a class="list-group-item" href="../proc/calchoughlut.html">CalcHoughLUT</a>
      
      <a class="list-group-item" href="../proc/calckinpedpatternsingle.html">CalcKINPEDPatternSingle</a>
      
      <a class="list-group-item" href="../proc/calckvectorcone.html">Calckvectorcone</a>
      
      <a class="list-group-item" href="../proc/calckvectortrace.html">Calckvectortrace</a>
      
      <a class="list-group-item" href="../proc/calcr.html">CalcR</a>
      
      <a class="list-group-item" href="../proc/calcrlocal.html">CalcRLocal</a>
      
      <a class="list-group-item" href="../proc/cardintersection.html">CardIntersection</a>
      
      <a class="list-group-item" href="../proc/cbabk2.html">cbabk2</a>
      
      <a class="list-group-item" href="../proc/cbal.html">cbal</a>
      
      <a class="list-group-item" href="../proc/cdiv.html">cdiv</a>
      
      <a class="list-group-item" href="../proc/cg.html">cg</a>
      
      <a class="list-group-item" href="../proc/ch.html">ch</a>
      
      <a class="list-group-item" href="../proc/cinvit.html">cinvit</a>
      
      <a class="list-group-item" href="../proc/clerror_check.html">CLerror_check</a>
      
      <a class="list-group-item" href="../proc/clinit_pdccq.html">CLinit_PDCCQ</a>
      
      <a class="list-group-item" href="../proc/clquery_platform_info.html">CLquery_platform_info</a>
      
      <a class="list-group-item" href="../proc/clread_source_file.html">CLread_source_file</a>
      
      <a class="list-group-item" href="../proc/combak.html">combak</a>
      
      <a class="list-group-item" href="../proc/comhes.html">comhes</a>
      
      <a class="list-group-item" href="../proc/comlr.html">comlr</a>
      
      <a class="list-group-item" href="../proc/comlr2.html">comlr2</a>
      
      <a class="list-group-item" href="../proc/comqr.html">comqr</a>
      
      <a class="list-group-item" href="../proc/comqr2.html">comqr2</a>
      
      <a class="list-group-item" href="../proc/cortb.html">cortb</a>
      
      <a class="list-group-item" href="../proc/corth.html">corth</a>
      
      <a class="list-group-item" href="../proc/csroot.html">csroot</a>
      
      <a class="list-group-item" href="../proc/ctfped_writefile.html">ctfped_writeFile</a>
      
      <a class="list-group-item" href="../proc/cubochoricneighbors.html">CubochoricNeighbors</a>
      
      <a class="list-group-item" href="../proc/cumul_histogram.html">cumul_histogram</a>
      
      <a class="list-group-item" href="../proc/dd_density.html">DD_Density</a>
      
      <a class="list-group-item" href="../proc/dd_estep.html">DD_Estep</a>
      
      <a class="list-group-item" href="../proc/dd_getqandl.html">DD_getQandL</a>
      
      <a class="list-group-item" href="../proc/dd_mstep.html">DD_Mstep</a>
      
      <a class="list-group-item" href="../proc/delete_fzlist.html">delete_FZlist</a>
      
      <a class="list-group-item" href="../proc/denoise_pattern.html">Denoise_Pattern</a>
      
      <a class="list-group-item" href="../proc/denoise_ped.html">Denoise_PED</a>
      
      <a class="list-group-item" href="../proc/di_emfordd.html">DI_EMforDD</a>
      
      <a class="list-group-item" href="../proc/di_init.html">DI_Init</a>
      
      <a class="list-group-item" href="../proc/di_rotatetomu.html">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../proc/di_sampledd.html">DI_SampleDD</a>
      
      <a class="list-group-item" href="../proc/di_similarity_classifier.html">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../proc/ebsd4calfun.html">EBSD4calfun</a>
      
      <a class="list-group-item" href="../proc/ebsdcalfun.html">EBSDcalfun</a>
      
      <a class="list-group-item" href="../proc/eccicalcsgh.html">ECCICalcSgh</a>
      
      <a class="list-group-item" href="../proc/ecpcalfun.html">ECPcalfun</a>
      
      <a class="list-group-item" href="../proc/efitebsdwrapper.html">efitEBSDWrapper</a>
      
      <a class="list-group-item" href="../proc/efitecpwrapper.html">efitECPWrapper</a>
      
      <a class="list-group-item" href="../proc/ei.html">EI</a>
      
      <a class="list-group-item" href="../proc/elmbak.html">elmbak</a>
      
      <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
      
      <a class="list-group-item" href="../proc/eltran.html">eltran</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdmaster.html">EMsoftCgetEBSDmaster</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdpatterns.html">EMsoftCgetEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetecpatterns.html">EMsoftCgetECPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetmcopencl.html">EMsoftCgetMCOpenCL</a>
      
      <a class="list-group-item" href="../proc/eshelby_disp.html">Eshelby_disp</a>
      
      <a class="list-group-item" href="../proc/fcore.html">FCORE</a>
      
      <a class="list-group-item" href="../proc/figi.html">figi</a>
      
      <a class="list-group-item" href="../proc/figi2.html">figi2</a>
      
      <a class="list-group-item" href="../proc/forwardprojection.html">ForwardProjection</a>
      
      <a class="list-group-item" href="../proc/fphon.html">FPHON</a>
      
      <a class="list-group-item" href="../proc/fscatt.html">FSCATT</a>
      
      <a class="list-group-item" href="../proc/genera_punto_sa.html">GENERA_PUNTO_SA</a>
      
      <a class="list-group-item" href="../proc/getaverageorientationnamelist.html">GetAverageOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getconvertorientationsnamelist.html">GetConvertOrientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdddensitylbm.html">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../proc/getdictindxopenclnamelist.html">GetDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../interface/getdisorientationangle.html">getDisorientationAngle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxis.html">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxistwophases.html">getDisorientationAngleAxisTwoPhases</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangledouble.html">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../proc/getdisorientationanglesingle.html">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationsnamelist.html">GetDisorientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdvsdnamelist.html">GetDvsDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdclusternamelist.html">GetEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsddetparmscannamelist.html">GetEBSDdetparmscanNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdfullnamelist.html">GetEBSDFullNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdindexingnamelist.html">GetEBSDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasternamelist.html">GetEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasteropenclnamelist.html">GetEBSDMasterOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdnamelist.html">GetEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdoverlapnamelist.html">GetEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns.html">getEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns2.html">getEBSDPatterns2</a>
      
      <a class="list-group-item" href="../proc/getebsdpatternswrapper.html">getEBSDPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/geteccinamelist.html">GetECCINameList</a>
      
      <a class="list-group-item" href="../proc/getecpatterns.html">getECPatterns</a>
      
      <a class="list-group-item" href="../proc/getecpatternswrapper.html">getECPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getecpindexingnamelist.html">GetECPIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getecpmasternamelist.html">GetECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getecpnamelist.html">GetECPNameList</a>
      
      <a class="list-group-item" href="../proc/getecppatternnamelist.html">GetECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/getecpsinglenamelist.html">GetECPSingleNameList</a>
      
      <a class="list-group-item" href="../proc/getecpzanamelist.html">GetECPZANameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfit4namelist.html">GetEMDPFit4NameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfitnamelist.html">GetEMDPFitNameList</a>
      
      <a class="list-group-item" href="../proc/geteulersfromfile.html">getEulersfromFile</a>
      
      <a class="list-group-item" href="../proc/getfitorientationpsnamelist.html">GetFitOrientationPSNameList</a>
      
      <a class="list-group-item" href="../proc/getfztypeandorder.html">getFZtypeandorder</a>
      
      <a class="list-group-item" href="../proc/getkamnamelist.html">GetKAMNameList</a>
      
      <a class="list-group-item" href="../proc/getkinematicalnamelist.html">GetkinematicalNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselmasternamelist.html">GetKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselnamelist.html">GetKosselNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselpatterns.html">getKosselPatterns</a>
      
      <a class="list-group-item" href="../proc/getkosselpatternswrapper.html">getKosselPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getlacbednamelist.html">GetLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclfoilnamelist.html">GetMCCLfoilNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclmultilayernamelist.html">GetMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclnamelist.html">GetMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclspherenamelist.html">GetMCCLsphereNameList</a>
      
      <a class="list-group-item" href="../proc/getmclipssnamelist.html">GetMCLIPSSNameList</a>
      
      <a class="list-group-item" href="../proc/getmcnamelist.html">GetMCNameList</a>
      
      <a class="list-group-item" href="../proc/getmultiphasenamelist.html">GetMultiPhaseNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationsimilaritynamelist.html">GetOrientationSimilarityNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationviznamelist.html">GetOrientationVizNameList</a>
      
      <a class="list-group-item" href="../proc/getpedindxnamelist.html">GetPEDIndxNameList</a>
      
      <a class="list-group-item" href="../proc/getpedkinnamelist.html">GetPEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/getpedzanamelist.html">GetPEDZANameList</a>
      
      <a class="list-group-item" href="../proc/getpfinversionnamelist.html">GetPFInversionNameList</a>
      
      <a class="list-group-item" href="../proc/getrefineorientationnamelist.html">GetRefineOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getreflectornamelist.html">GetreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/getrfznamelist.html">GetRFZNameList</a>
      
      <a class="list-group-item" href="../proc/getsrdefectnamelist.html">GetSRdefectNameList</a>
      
      <a class="list-group-item" href="../proc/getstemdcinamelist.html">GetSTEMDCINameList</a>
      
      <a class="list-group-item" href="../proc/gettkdindexingnamelist.html">GetTKDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdmasternamelist.html">GetTKDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdnamelist.html">GetTKDNameList</a>
      
      <a class="list-group-item" href="../proc/getwk.html">GETWK</a>
      
      <a class="list-group-item" href="../proc/getzadefectnamelist.html">GetZAdefectNameList</a>
      
      <a class="list-group-item" href="../proc/hipassfilter.html">HiPassFilter</a>
      
      <a class="list-group-item" href="../proc/houghtransform.html">HoughTransform</a>
      
      <a class="list-group-item" href="../proc/hqr.html">hqr</a>
      
      <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
      
      <a class="list-group-item" href="../proc/htrib3.html">htrib3</a>
      
      <a class="list-group-item" href="../proc/htribk.html">htribk</a>
      
      <a class="list-group-item" href="../proc/htrid3.html">htrid3</a>
      
      <a class="list-group-item" href="../proc/htridi.html">htridi</a>
      
      <a class="list-group-item" href="../proc/image_entropy.html">image_entropy</a>
      
      <a class="list-group-item" href="../proc/image_histogram.html">image_histogram</a>
      
      <a class="list-group-item" href="../proc/image_jointentropy.html">image_jointentropy</a>
      
      <a class="list-group-item" href="../proc/image_jointhistogram.html">image_jointhistogram</a>
      
      <a class="list-group-item" href="../proc/image_mutualinformation.html">image_mutualinformation</a>
      
      <a class="list-group-item" href="../proc/imtql1.html">imtql1</a>
      
      <a class="list-group-item" href="../proc/imtql2.html">imtql2</a>
      
      <a class="list-group-item" href="../proc/imtqlv.html">imtqlv</a>
      
      <a class="list-group-item" href="../proc/init_dislocation_data.html">init_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/init_einclusion_data.html">init_Einclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_foil_data.html">init_foil_data</a>
      
      <a class="list-group-item" href="../proc/init_inclusion_data.html">init_inclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_stacking_fault_data.html">init_stacking_fault_data</a>
      
      <a class="list-group-item" href="../proc/init_stem.html">init_STEM</a>
      
      <a class="list-group-item" href="../proc/init_stem_za.html">init_STEM_ZA</a>
      
      <a class="list-group-item" href="../proc/init_void_data.html">init_void_data</a>
      
      <a class="list-group-item" href="../proc/init_ysh_dislocation_data.html">init_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/initialize_foil_geometry.html">initialize_foil_geometry</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../interface/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist_ewaldsweep.html">Initialize_ReflectionList_EwaldSweep</a>
      
      <a class="list-group-item" href="../proc/initializedefects.html">InitializeDefects</a>
      
      <a class="list-group-item" href="../proc/initializeeshelbyinclusion.html">InitializeEshelbyInclusion</a>
      
      <a class="list-group-item" href="../proc/innerprodgpu.html">InnerProdGPU</a>
      
      <a class="list-group-item" href="../proc/insidecubehexfz.html">insideCubeHexFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicfz.html">insideCubicFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicmfz.html">insideCubicMFZ</a>
      
      <a class="list-group-item" href="../proc/insidecyclicfz.html">insideCyclicFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralfz.html">insideDihedralFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralmfz.html">insideDihedralMFZ</a>
      
      <a class="list-group-item" href="../proc/interfaccia.html">INTERFACCIA</a>
      
      <a class="list-group-item" href="../proc/inversiondivision.html">InversionDivision</a>
      
      <a class="list-group-item" href="../proc/invit.html">invit</a>
      
      <a class="list-group-item" href="../proc/isinsidefz.html">IsinsideFZ</a>
      
      <a class="list-group-item" href="../proc/isinsidemfz.html">IsinsideMFZ</a>
      
      <a class="list-group-item" href="../proc/jaccard_distance.html">Jaccard_Distance</a>
      
      <a class="list-group-item" href="../proc/json_cleanuppointers.html">JSON_cleanuppointers</a>
      
      <a class="list-group-item" href="../proc/json_failtest.html">JSON_failtest</a>
      
      <a class="list-group-item" href="../proc/json_initpointers.html">JSON_initpointers</a>
      
      <a class="list-group-item" href="../proc/json_minify.html">JSON_minify</a>
      
      <a class="list-group-item" href="../proc/json_writenmldoubles.html">JSON_writeNMLdoubles</a>
      
      <a class="list-group-item" href="../proc/json_writenmlintegers.html">JSON_writeNMLintegers</a>
      
      <a class="list-group-item" href="../proc/json_writenmlreals.html">JSON_writeNMLreals</a>
      
      <a class="list-group-item" href="../proc/jsongetdouble.html">JSONgetDouble</a>
      
      <a class="list-group-item" href="../proc/jsongetdoublevector.html">JSONgetDoubleVector</a>
      
      <a class="list-group-item" href="../proc/jsonreaddefectfile.html">JSONreadDefectFile</a>
      
      <a class="list-group-item" href="../proc/jsonreaddouble.html">JSONreadDouble</a>
      
      <a class="list-group-item" href="../proc/jsonreaddoublevec.html">JSONreadDoubleVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdclusternamelist.html">JSONreadEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdmasternamelist.html">JSONreadEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdnamelist.html">JSONreadEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdoverlapnamelist.html">JSONreadEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadecpmasternamelist.html">JSONreadECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadfoildata.html">JSONreadFoilData</a>
      
      <a class="list-group-item" href="../proc/jsonreadinteger.html">JSONreadInteger</a>
      
      <a class="list-group-item" href="../proc/jsonreadintegervec.html">JSONreadIntegerVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselmasternamelist.html">JSONreadKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselnamelist.html">JSONreadKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadlogical.html">JSONreadLogical</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclmultilayernamelist.html">JSONreadMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclnamelist.html">JSONreadMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcnamelist.html">JSONreadMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadreal.html">JSONreadReal</a>
      
      <a class="list-group-item" href="../proc/jsonreadrealvec.html">JSONreadRealVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadreflectornamelist.html">JSONreadreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadstring.html">JSONreadString</a>
      
      <a class="list-group-item" href="../proc/jsonwritedictindxopenclnamelist.html">JSONwriteDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdclusternamelist.html">JSONwriteEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdmasternamelist.html">JSONwriteEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdnamelist.html">JSONwriteEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteeccinamelist.html">JSONwriteECCINameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpmasternamelist.html">JSONwriteECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpnamelist.html">JSONwriteECPNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecppatternnamelist.html">JSONwriteECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselmasternamelist.html">JSONwriteKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselnamelist.html">JSONwriteKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritelacbednamelist.html">JSONwriteLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclmultilayernamelist.html">JSONwriteMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclnamelist.html">JSONwriteMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcnamelist.html">JSONwriteMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedkinnamelist.html">JSONwritePEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedzanamelist.html">JSONwritePEDZANameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriterfznamelist.html">JSONwriteRFZNameList</a>
      
      <a class="list-group-item" href="../proc/linesearch_inverti.html">LINESEARCH_INVERTI</a>
      
      <a class="list-group-item" href="../proc/linesearchbox_cont.html">linesearchbox_cont</a>
      
      <a class="list-group-item" href="../proc/logcp.html">logCp</a>
      
      <a class="list-group-item" href="../proc/mainbox1.html">MAINBOX1</a>
      
      <a class="list-group-item" href="../proc/mainbox2.html">MAINBOX2</a>
      
      <a class="list-group-item" href="../proc/makedislocation.html">makedislocation</a>
      
      <a class="list-group-item" href="../proc/makestackingfault.html">makestackingfault</a>
      
      <a class="list-group-item" href="../proc/makestackingfaultecci.html">makestackingfaultECCI</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation%7E2.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/mc_concatenatemuellermatrices.html">MC_concatenateMuellerMatrices</a>
      
      <a class="list-group-item" href="../proc/mc_get_ad_from_eo.html">MC_get_AD_from_EO</a>
      
      <a class="list-group-item" href="../proc/mc_get_auxiliaryangle.html">MC_get_AuxiliaryAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_basicmuellermatrix.html">MC_get_basicMuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_get_diattenuator.html">MC_get_diattenuator</a>
      
      <a class="list-group-item" href="../proc/mc_get_ellipticityangle.html">MC_get_EllipticityAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_eo_from_ad.html">MC_get_EO_from_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_orientationangle.html">MC_get_OrientationAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_phaseshiftangle.html">MC_get_PhaseShiftAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_polarization.html">MC_get_Polarization</a>
      
      <a class="list-group-item" href="../proc/mc_get_retarder.html">MC_get_retarder</a>
      
      <a class="list-group-item" href="../proc/mc_get_rotator.html">MC_get_rotator</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_ad.html">MC_get_Stokes_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_eo.html">MC_get_Stokes_EO</a>
      
      <a class="list-group-item" href="../proc/mc_print_muellermatrix.html">MC_print_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_propagatestokesvector.html">MC_propagateStokesVector</a>
      
      <a class="list-group-item" href="../proc/mc_rotate_muellermatrix.html">MC_rotate_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/minfit.html">minfit</a>
      
      <a class="list-group-item" href="../proc/nanchk.html">NANCHK</a>
      
      <a class="list-group-item" href="../proc/ortbak.html">ortbak</a>
      
      <a class="list-group-item" href="../proc/orthes.html">orthes</a>
      
      <a class="list-group-item" href="../proc/ortran.html">ortran</a>
      
      <a class="list-group-item" href="../proc/pgm_write_file.html">PGM_Write_File</a>
      
      <a class="list-group-item" href="../proc/poidev.html">POIDEV</a>
      
      <a class="list-group-item" href="../proc/povray_addcubochoriccube.html">PoVRay_addCubochoricCube</a>
      
      <a class="list-group-item" href="../proc/povray_addcylinder.html">PoVRay_addCylinder</a>
      
      <a class="list-group-item" href="../proc/povray_addeulerbox.html">PoVRay_addEulerBox</a>
      
      <a class="list-group-item" href="../proc/povray_addreferenceframe.html">PoVRay_addReferenceFrame</a>
      
      <a class="list-group-item" href="../proc/povray_addsphere.html">PoVRay_addSphere</a>
      
      <a class="list-group-item" href="../proc/povray_addwireframesphere.html">PoVRay_addWireFrameSphere</a>
      
      <a class="list-group-item" href="../proc/povray_declare_df3file.html">PoVRay_declare_DF3file</a>
      
      <a class="list-group-item" href="../proc/povray_drawfz.html">PoVRay_drawFZ</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz222.html">PoVRay_getpos_FZ222</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz23.html">PoVRay_getpos_FZ23</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz32.html">PoVRay_getpos_FZ32</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz422.html">PoVRay_getpos_FZ422</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz432.html">PoVRay_getpos_FZ432</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz622.html">PoVRay_getpos_FZ622</a>
      
      <a class="list-group-item" href="../proc/povray_initfz2.html">PoVRay_initFZ2</a>
      
      <a class="list-group-item" href="../proc/povray_initfz3.html">PoVRay_initFZ3</a>
      
      <a class="list-group-item" href="../proc/povray_initfz4.html">PoVRay_initFZ4</a>
      
      <a class="list-group-item" href="../proc/povray_initfz6.html">PoVRay_initFZ6</a>
      
      <a class="list-group-item" href="../proc/povray_openfile.html">PoVRay_openFile</a>
      
      <a class="list-group-item" href="../proc/povray_setcamera.html">PoVRay_setCamera</a>
      
      <a class="list-group-item" href="../proc/povray_setlightsource.html">PoVRay_setLightSource</a>
      
      <a class="list-group-item" href="../proc/povray_write_df3file.html">PoVRay_write_DF3file</a>
      
      <a class="list-group-item" href="../proc/prelim.html">prelim</a>
      
      <a class="list-group-item" href="../proc/prelim%7E2.html">prelim</a>
      
      <a class="list-group-item" href="../proc/printtime.html">PrintTime</a>
      
      <a class="list-group-item" href="../proc/pythag.html">pythag</a>
      
      <a class="list-group-item" href="../proc/qsortd.html">qsortd</a>
      
      <a class="list-group-item" href="../proc/qzhes.html">qzhes</a>
      
      <a class="list-group-item" href="../proc/qzit.html">qzit</a>
      
      <a class="list-group-item" href="../proc/qzval.html">qzval</a>
      
      <a class="list-group-item" href="../proc/qzvec.html">qzvec</a>
      
      <a class="list-group-item" href="../proc/r8_swap.html">r8_swap</a>
      
      <a class="list-group-item" href="../proc/r8mat_print.html">r8mat_print</a>
      
      <a class="list-group-item" href="../proc/r8mat_print_some.html">r8mat_print_some</a>
      
      <a class="list-group-item" href="../proc/r8vec2_print.html">r8vec2_print</a>
      
      <a class="list-group-item" href="../proc/r8vec_print.html">r8vec_print</a>
      
      <a class="list-group-item" href="../proc/ran.html">ran</a>
      
      <a class="list-group-item" href="../proc/randddmarginal.html">randDDMarginal</a>
      
      <a class="list-group-item" href="../proc/randuniformsphere.html">randUniformSphere</a>
      
      <a class="list-group-item" href="../proc/ratqr.html">ratqr</a>
      
      <a class="list-group-item" href="../proc/read_apb_data.html">read_apb_data</a>
      
      <a class="list-group-item" href="../proc/read_stem_data.html">read_STEM_data</a>
      
      <a class="list-group-item" href="../proc/read_ysh_dislocation_data.html">read_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/rebak.html">rebak</a>
      
      <a class="list-group-item" href="../proc/rebakb.html">rebakb</a>
      
      <a class="list-group-item" href="../proc/reduc.html">reduc</a>
      
      <a class="list-group-item" href="../proc/reduc2.html">reduc2</a>
      
      <a class="list-group-item" href="../proc/reducedisorientationtomfz.html">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtocubicefz.html">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtorfz.html">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../proc/rescue.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rescue%7E2.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rg.html">rg</a>
      
      <a class="list-group-item" href="../proc/rgg.html">rgg</a>
      
      <a class="list-group-item" href="../proc/ri1.html">RI1</a>
      
      <a class="list-group-item" href="../proc/ri2.html">RI2</a>
      
      <a class="list-group-item" href="../proc/ricerca_lungo_assi.html">RICERCA_LUNGO_ASSI</a>
      
      <a class="list-group-item" href="../proc/rih1.html">RIH1</a>
      
      <a class="list-group-item" href="../proc/rih2.html">RIH2</a>
      
      <a class="list-group-item" href="../proc/rih3.html">RIH3</a>
      
      <a class="list-group-item" href="../proc/rng_seed.html">rng_seed</a>
      
      <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
      
      <a class="list-group-item" href="../proc/rs.html">rs</a>
      
      <a class="list-group-item" href="../proc/rsb.html">rsb</a>
      
      <a class="list-group-item" href="../proc/rsg.html">rsg</a>
      
      <a class="list-group-item" href="../proc/rsgab.html">rsgab</a>
      
      <a class="list-group-item" href="../proc/rsgba.html">rsgba</a>
      
      <a class="list-group-item" href="../proc/rsm.html">rsm</a>
      
      <a class="list-group-item" href="../proc/rsp.html">rsp</a>
      
      <a class="list-group-item" href="../proc/rspp.html">rspp</a>
      
      <a class="list-group-item" href="../proc/rst.html">rst</a>
      
      <a class="list-group-item" href="../proc/rt.html">rt</a>
      
      <a class="list-group-item" href="../proc/sample_cone.html">sample_Cone</a>
      
      <a class="list-group-item" href="../proc/sample_isocube.html">sample_isoCube</a>
      
      <a class="list-group-item" href="../proc/sample_isocubefilled.html">sample_isoCubeFilled</a>
      
      <a class="list-group-item" href="../proc/samplefcctwinrfz.html">SamplefcctwinRFZ</a>
      
      <a class="list-group-item" href="../proc/sampleisomisorientation.html">SampleIsoMisorientation</a>
      
      <a class="list-group-item" href="../proc/samplerfz.html">SampleRFZ</a>
      
      <a class="list-group-item" href="../proc/samplerfztwin.html">SampleRFZtwin</a>
      
      <a class="list-group-item" href="../proc/senzaderglob.html">SENZADERGLOB</a>
      
      <a class="list-group-item" href="../proc/ssort.html">SSORT</a>
      
      <a class="list-group-item" href="../proc/stop.html">STOP</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/time_estimate.html">Time_estimate</a>
      
      <a class="list-group-item" href="../proc/time_remaining.html">Time_remaining</a>
      
      <a class="list-group-item" href="../proc/time_report.html">Time_report</a>
      
      <a class="list-group-item" href="../proc/time_reset.html">Time_reset</a>
      
      <a class="list-group-item" href="../proc/time_start.html">Time_start</a>
      
      <a class="list-group-item" href="../proc/time_stop.html">Time_stop</a>
      
      <a class="list-group-item" href="../proc/time_tick.html">Time_tick</a>
      
      <a class="list-group-item" href="../proc/time_tock.html">Time_tock</a>
      
      <a class="list-group-item" href="../proc/timestamp.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/timestamp%7E2.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/tinvit.html">tinvit</a>
      
      <a class="list-group-item" href="../proc/tql1.html">tql1</a>
      
      <a class="list-group-item" href="../proc/tql2.html">tql2</a>
      
      <a class="list-group-item" href="../proc/tqlrat.html">tqlrat</a>
      
      <a class="list-group-item" href="../proc/trbak1.html">trbak1</a>
      
      <a class="list-group-item" href="../proc/trbak3.html">trbak3</a>
      
      <a class="list-group-item" href="../proc/tred1.html">tred1</a>
      
      <a class="list-group-item" href="../proc/tred2.html">tred2</a>
      
      <a class="list-group-item" href="../proc/tred3.html">tred3</a>
      
      <a class="list-group-item" href="../proc/tridib.html">tridib</a>
      
      <a class="list-group-item" href="../proc/trsbox.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/trsbox%7E2.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/tsturm.html">tsturm</a>
      
      <a class="list-group-item" href="../proc/update.html">update</a>
      
      <a class="list-group-item" href="../proc/update%7E2.html">update</a>
      
      <a class="list-group-item" href="../proc/vmfmeandirdensity.html">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/watsonmeandirdensity.html">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/weko.html">WEKO</a>
      
      <a class="list-group-item" href="../proc/yshdisp%7E2.html">YSHDisp</a>
      
      <a class="list-group-item" href="../proc/yshdisp.html">YSHDisp</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public recursive subroutine makedislocation(cell, defects, inum, dinfo, DF_L)
    
    
	 
</h2>
    
  
    <ul class="list-inline">
      <li><h4>Uses:</h4></li>
      
      <li>math</li>
      
      <li><a href='../module/constants.html'>constants</a></li>
      
      <li>crystal</li>
      
      <li>math</li>
      
      <li>io</li>
      
      <li>symmetry</li>
      
      <li>rotations</li>
      
    </ul>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makedislocation~~UsesGraph Pages: 1 -->
<svg id="procmakedislocationUsesGraph" width="280pt" height="242pt"
 viewBox="0.00 0.00 280.00 242.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makedislocation~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 238)">
<title>proc~~makedislocation~~UsesGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-238 276,-238 276,4 -4,4"/>
<!-- proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_node1" class="node"><title>proc~makedislocation</title>
<polygon fill="none" stroke="black" points="272,-129 184,-129 184,-105 272,-105 272,-129"/>
<text text-anchor="middle" x="228" y="-114.6" font-family="Helvetica,sans-Serif" font-size="10.50">makedislocation</text>
</g>
<!-- module~constants -->
<g id="proc~~makedislocation~~UsesGraph_node2" class="node"><title>module~constants</title>
<g id="a_proc~~makedislocation~~UsesGraph_node2"><a xlink:href="../module/constants.html" xlink:title="constants">
<polygon fill="#337ab7" stroke="#337ab7" points="147.5,-234 90.5,-234 90.5,-210 147.5,-210 147.5,-234"/>
<text text-anchor="middle" x="119" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">constants</text>
</a>
</g>
</g>
<!-- module~constants&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge2" class="edge"><title>module~constants&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M137.252,-209.795C140.895,-207.017 144.649,-203.998 148,-201 170.824,-180.583 194.579,-154.574 210.002,-136.945"/>
<polygon fill="#ff0000" stroke="#ff0000" points="212.961,-138.875 216.864,-129.026 207.671,-134.292 212.961,-138.875"/>
</g>
<!-- io -->
<g id="proc~~makedislocation~~UsesGraph_node3" class="node"><title>io</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-192 92,-192 92,-168 146,-168 146,-192"/>
<text text-anchor="middle" x="119" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">io</text>
</g>
<!-- io&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge3" class="edge"><title>io&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M140.631,-167.853C156.765,-158.353 179.412,-145.019 197.468,-134.388"/>
<polygon fill="#ff0000" stroke="#ff0000" points="199.591,-137.2 206.433,-129.11 196.04,-131.167 199.591,-137.2"/>
</g>
<!-- symmetry -->
<g id="proc~~makedislocation~~UsesGraph_node4" class="node"><title>symmetry</title>
<polygon fill="#337ab7" stroke="#337ab7" points="148,-150 90,-150 90,-126 148,-126 148,-150"/>
<text text-anchor="middle" x="119" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">symmetry</text>
</g>
<!-- symmetry&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge4" class="edge"><title>symmetry&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M148.113,-132.482C156.031,-130.929 164.914,-129.185 173.787,-127.444"/>
<polygon fill="#ff0000" stroke="#ff0000" points="174.61,-130.849 183.749,-125.489 173.262,-123.98 174.61,-130.849"/>
</g>
<!-- rotations -->
<g id="proc~~makedislocation~~UsesGraph_node5" class="node"><title>rotations</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-108 92,-108 92,-84 146,-84 146,-108"/>
<text text-anchor="middle" x="119" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">rotations</text>
</g>
<!-- rotations&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge5" class="edge"><title>rotations&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.175,-101.137C154.532,-102.777 164.106,-104.656 173.671,-106.534"/>
<polygon fill="#ff0000" stroke="#ff0000" points="173.099,-109.988 183.586,-108.48 174.448,-103.119 173.099,-109.988"/>
</g>
<!-- crystal -->
<g id="proc~~makedislocation~~UsesGraph_node6" class="node"><title>crystal</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-66 92,-66 92,-42 146,-42 146,-66"/>
<text text-anchor="middle" x="119" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">crystal</text>
</g>
<!-- crystal&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge6" class="edge"><title>crystal&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M140.631,-66.147C156.765,-75.647 179.412,-88.9811 197.468,-99.612"/>
<polygon fill="#ff0000" stroke="#ff0000" points="196.04,-102.833 206.433,-104.89 199.591,-96.8004 196.04,-102.833"/>
</g>
<!-- math -->
<g id="proc~~makedislocation~~UsesGraph_node7" class="node"><title>math</title>
<polygon fill="#337ab7" stroke="#337ab7" points="146,-24 92,-24 92,-0 146,-0 146,-24"/>
<text text-anchor="middle" x="119" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">math</text>
</g>
<!-- math&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~UsesGraph_edge7" class="edge"><title>math&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M137.252,-24.2047C140.895,-26.9827 144.649,-30.0021 148,-33 170.824,-53.417 194.579,-79.4263 210.002,-97.0548"/>
<polygon fill="#ff0000" stroke="#ff0000" points="207.671,-99.7085 216.864,-104.974 212.961,-95.1247 207.671,-99.7085"/>
</g>
<!-- local -->
<g id="proc~~makedislocation~~UsesGraph_node8" class="node"><title>local</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-234 0,-234 0,-210 54,-210 54,-234"/>
<text text-anchor="middle" x="27" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">local</text>
</g>
<!-- local&#45;&gt;module~constants -->
<g id="proc~~makedislocation~~UsesGraph_edge1" class="edge"><title>local&#45;&gt;module~constants</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M54.0317,-222C62.2408,-222 71.4806,-222 80.3316,-222"/>
<polygon fill="#ff0000" stroke="#ff0000" points="80.4582,-225.5 90.4582,-222 80.4582,-218.5 80.4582,-225.5"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="486pt" height="32pt"
 viewBox="0.00 0.00 486.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 482,-28 482,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-24 72,-24 72,-0 138,-0 138,-24"/>
<text text-anchor="middle" x="105" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="219.5,-24 156.5,-24 156.5,-0 219.5,-0 219.5,-24"/>
<text text-anchor="middle" x="188" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="292,-24 238,-24 238,-0 292,-0 292,-24"/>
<text text-anchor="middle" x="265" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="478,-24 382,-24 382,-0 478,-0 478,-24"/>
<text text-anchor="middle" x="430" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a parent (sub)module to the submodule which is
    descended from it. Dashed arrows point from a module being used to the
    module or program unit using it. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    


    
    <p>@author Marc De Graef, Carnegie Mellon University
 @brief  Compute the dismat displacement matrix for a given dislocation
 @details This subroutine computes the matrix dismat that describes the displacement field
 of a dislocation.  The routine needs the elastic moduli tensor, the transformation
 matrix between the crystal and dislocation reference frames, and the dislocation
 Burgers vector.  The routine computes the arrays dismat and pa, which should be used as follows:</p>
<p>R_k = 2.0<em>real([ sum_a=1^3 (dismat(k,a)</em>log(Z_a)) ]),</p>
<p>with Z_a = x_1 + pa(a)*x_2</p>
<p>[see CalcR subroutine for more information]</p>
<p>We must also make sure that the x=0 plane of the defect reference frame contains the 
 incident beam direction, to avoid getting stacking-fault fringes in the wrong plane...
 Actual stacking faults are added in using a different module (stacking_fault.f90).</p>
<p>@param cell unit cell pointer
 @param defects defect structure
 @param inum
 @param dinfo
 @param DF_L column width
 @date   1/ 5/99 MDG 1.0 original
 @date   5/19/01 MDG 2.0 f90 version
 @date  11/27/01 MDG 2.1 added kind support
 @date  06/04/13 MDG 3.0 rewrite
 @date  10/30/13 MDG 3.1 debug of all rotation parts
 @date  06/09/14 MDG 4.0 added cell, defects arguments
 @date  06/10/14 MDG 4.1 added foil as argument
 @date  11/21/15 MDG 4.2 moved foil into defects structure</p>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-cell%7E9"></span>type(unitcell),</td>
  <td></td>
  <td></td>
  
  <td>pointer</td><td>::</td>
  <td><strong>cell</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-defects%7E12"></span>type(defecttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>defects</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-inum"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>inum</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-dinfo%7E13"></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dinfo</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-df_l%7E10"></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>DF_L</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makedislocation~~CallsGraph Pages: 1 -->
<svg id="procmakedislocationCallsGraph" width="244pt" height="662pt"
 viewBox="0.00 0.00 244.00 662.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makedislocation~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 658)">
<title>proc~~makedislocation~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-658 240,-658 240,4 -4,4"/>
<!-- proc~makedislocation -->
<g id="proc~~makedislocation~~CallsGraph_node1" class="node"><title>proc~makedislocation</title>
<polygon fill="none" stroke="black" points="88,-339 0,-339 0,-315 88,-315 88,-339"/>
<text text-anchor="middle" x="44" y="-324.6" font-family="Helvetica,sans-Serif" font-size="10.50">makedislocation</text>
</g>
<!-- printmatrixcd -->
<g id="proc~~makedislocation~~CallsGraph_node2" class="node"><title>printmatrixcd</title>
<polygon fill="#777777" stroke="#777777" points="216.5,-654 143.5,-654 143.5,-630 216.5,-630 216.5,-654"/>
<text text-anchor="middle" x="180" y="-639.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">printmatrixcd</text>
</g>
<!-- proc~makedislocation&#45;&gt;printmatrixcd -->
<g id="proc~~makedislocation~~CallsGraph_edge1" class="edge"><title>proc~makedislocation&#45;&gt;printmatrixcd</title>
<path fill="none" stroke="#ff0000" d="M44.5966,-339.159C43.8072,-383.114 46.9746,-535.669 124,-621 126.928,-624.243 130.411,-626.989 134.184,-629.313"/>
<polygon fill="#ff0000" stroke="#ff0000" points="132.885,-632.58 143.384,-634.006 136.066,-626.344 132.885,-632.58"/>
</g>
<!-- om2qu -->
<g id="proc~~makedislocation~~CallsGraph_node3" class="node"><title>om2qu</title>
<polygon fill="#777777" stroke="#777777" points="207,-612 153,-612 153,-588 207,-588 207,-612"/>
<text text-anchor="middle" x="180" y="-597.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">om2qu</text>
</g>
<!-- proc~makedislocation&#45;&gt;om2qu -->
<g id="proc~~makedislocation~~CallsGraph_edge2" class="edge"><title>proc~makedislocation&#45;&gt;om2qu</title>
<path fill="none" stroke="#ff0000" d="M45.2422,-339.073C46.6879,-378.857 56.6093,-507.372 124,-579 129.248,-584.578 136.137,-588.69 143.256,-591.717"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.379,-595.12 152.973,-595.206 144.744,-588.532 142.379,-595.12"/>
</g>
<!-- transspace -->
<g id="proc~~makedislocation~~CallsGraph_node4" class="node"><title>transspace</title>
<polygon fill="#777777" stroke="#777777" points="212,-570 148,-570 148,-546 212,-546 212,-570"/>
<text text-anchor="middle" x="180" y="-555.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transspace</text>
</g>
<!-- proc~makedislocation&#45;&gt;transspace -->
<g id="proc~~makedislocation~~CallsGraph_edge3" class="edge"><title>proc~makedislocation&#45;&gt;transspace</title>
<path fill="none" stroke="#ff0000" d="M46.1185,-339.035C50.0273,-374.354 66.1632,-478.878 124,-537 128.157,-541.177 133.231,-544.538 138.598,-547.238"/>
<polygon fill="#ff0000" stroke="#ff0000" points="137.229,-550.459 147.798,-551.187 139.989,-544.027 137.229,-550.459"/>
</g>
<!-- print_orientation_d -->
<g id="proc~~makedislocation~~CallsGraph_node5" class="node"><title>print_orientation_d</title>
<polygon fill="#777777" stroke="#777777" points="229.5,-528 130.5,-528 130.5,-504 229.5,-504 229.5,-528"/>
<text text-anchor="middle" x="180" y="-513.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">print_orientation_d</text>
</g>
<!-- proc~makedislocation&#45;&gt;print_orientation_d -->
<g id="proc~~makedislocation~~CallsGraph_edge4" class="edge"><title>proc~makedislocation&#45;&gt;print_orientation_d</title>
<path fill="none" stroke="#ff0000" d="M47.4884,-339.443C54.2535,-370.15 75.8012,-450.279 124,-495 125.314,-496.219 126.705,-497.369 128.158,-498.455"/>
<polygon fill="#ff0000" stroke="#ff0000" points="126.693,-501.666 137.03,-503.989 130.398,-495.727 126.693,-501.666"/>
</g>
<!-- minvert -->
<g id="proc~~makedislocation~~CallsGraph_node6" class="node"><title>minvert</title>
<polygon fill="#777777" stroke="#777777" points="207,-486 153,-486 153,-462 207,-462 207,-486"/>
<text text-anchor="middle" x="180" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">minvert</text>
</g>
<!-- proc~makedislocation&#45;&gt;minvert -->
<g id="proc~~makedislocation~~CallsGraph_edge5" class="edge"><title>proc~makedislocation&#45;&gt;minvert</title>
<path fill="none" stroke="#ff0000" d="M49.5409,-339.226C59.3628,-364.083 84.8985,-420.876 124,-453 129.571,-457.577 136.249,-461.227 143,-464.112"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.231,-467.562 152.823,-467.811 144.698,-461.011 142.231,-467.562"/>
</g>
<!-- zroots -->
<g id="proc~~makedislocation~~CallsGraph_node7" class="node"><title>zroots</title>
<polygon fill="#777777" stroke="#777777" points="207,-444 153,-444 153,-420 207,-420 207,-444"/>
<text text-anchor="middle" x="180" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">zroots</text>
</g>
<!-- proc~makedislocation&#45;&gt;zroots -->
<g id="proc~~makedislocation~~CallsGraph_edge6" class="edge"><title>proc~makedislocation&#45;&gt;zroots</title>
<path fill="none" stroke="#ff0000" d="M53.618,-339.211C66.8709,-357.189 93.8986,-390.828 124,-411 129.876,-414.938 136.594,-418.281 143.27,-421.064"/>
<polygon fill="#ff0000" stroke="#ff0000" points="142.326,-424.45 152.917,-424.743 144.821,-417.909 142.326,-424.45"/>
</g>
<!-- quat_mult -->
<g id="proc~~makedislocation~~CallsGraph_node8" class="node"><title>quat_mult</title>
<polygon fill="#777777" stroke="#777777" points="209.5,-402 150.5,-402 150.5,-378 209.5,-378 209.5,-402"/>
<text text-anchor="middle" x="180" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quat_mult</text>
</g>
<!-- proc~makedislocation&#45;&gt;quat_mult -->
<g id="proc~~makedislocation~~CallsGraph_edge7" class="edge"><title>proc~makedislocation&#45;&gt;quat_mult</title>
<path fill="none" stroke="#ff0000" d="M66.0999,-339.138C81.8102,-347.947 103.921,-359.872 124,-369 129.424,-371.466 135.23,-373.898 140.963,-376.183"/>
<polygon fill="#ff0000" stroke="#ff0000" points="139.872,-379.514 150.461,-379.871 142.406,-372.989 139.872,-379.514"/>
</g>
<!-- calccross -->
<g id="proc~~makedislocation~~CallsGraph_node9" class="node"><title>calccross</title>
<polygon fill="#777777" stroke="#777777" points="208,-360 152,-360 152,-336 208,-336 208,-360"/>
<text text-anchor="middle" x="180" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calccross</text>
</g>
<!-- proc~makedislocation&#45;&gt;calccross -->
<g id="proc~~makedislocation~~CallsGraph_edge8" class="edge"><title>proc~makedislocation&#45;&gt;calccross</title>
<path fill="none" stroke="#ff0000" d="M88.136,-333.76C105.496,-336.481 125.315,-339.587 142.004,-342.202"/>
<polygon fill="#ff0000" stroke="#ff0000" points="141.52,-345.669 151.941,-343.759 142.604,-338.753 141.52,-345.669"/>
</g>
<!-- cinvert -->
<g id="proc~~makedislocation~~CallsGraph_node10" class="node"><title>cinvert</title>
<polygon fill="#777777" stroke="#777777" points="207,-318 153,-318 153,-294 207,-294 207,-318"/>
<text text-anchor="middle" x="180" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cinvert</text>
</g>
<!-- proc~makedislocation&#45;&gt;cinvert -->
<g id="proc~~makedislocation~~CallsGraph_edge9" class="edge"><title>proc~makedislocation&#45;&gt;cinvert</title>
<path fill="none" stroke="#ff0000" d="M88.136,-320.24C105.75,-317.48 125.895,-314.322 142.733,-311.684"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.401,-315.122 152.738,-310.116 142.317,-308.206 143.401,-315.122"/>
</g>
<!-- init_orientation_d -->
<g id="proc~~makedislocation~~CallsGraph_node11" class="node"><title>init_orientation_d</title>
<polygon fill="#777777" stroke="#777777" points="226,-276 134,-276 134,-252 226,-252 226,-276"/>
<text text-anchor="middle" x="180" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_orientation_d</text>
</g>
<!-- proc~makedislocation&#45;&gt;init_orientation_d -->
<g id="proc~~makedislocation~~CallsGraph_edge10" class="edge"><title>proc~makedislocation&#45;&gt;init_orientation_d</title>
<path fill="none" stroke="#ff0000" d="M66.0999,-314.862C81.8102,-306.053 103.921,-294.128 124,-285 127.873,-283.239 131.941,-281.496 136.037,-279.811"/>
<polygon fill="#ff0000" stroke="#ff0000" points="137.581,-282.963 145.57,-276.004 134.985,-276.462 137.581,-282.963"/>
</g>
<!-- transfourthranktensor -->
<g id="proc~~makedislocation~~CallsGraph_node12" class="node"><title>transfourthranktensor</title>
<polygon fill="#777777" stroke="#777777" points="236,-234 124,-234 124,-210 236,-210 236,-234"/>
<text text-anchor="middle" x="180" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">transfourthranktensor</text>
</g>
<!-- proc~makedislocation&#45;&gt;transfourthranktensor -->
<g id="proc~~makedislocation~~CallsGraph_edge11" class="edge"><title>proc~makedislocation&#45;&gt;transfourthranktensor</title>
<path fill="none" stroke="#ff0000" d="M53.618,-314.789C66.8709,-296.811 93.8986,-263.172 124,-243 126.388,-241.4 128.915,-239.898 131.522,-238.491"/>
<polygon fill="#ff0000" stroke="#ff0000" points="133.142,-241.596 140.606,-234.076 130.082,-235.3 133.142,-241.596"/>
</g>
<!-- qu2om -->
<g id="proc~~makedislocation~~CallsGraph_node13" class="node"><title>qu2om</title>
<polygon fill="#777777" stroke="#777777" points="207,-192 153,-192 153,-168 207,-168 207,-192"/>
<text text-anchor="middle" x="180" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">qu2om</text>
</g>
<!-- proc~makedislocation&#45;&gt;qu2om -->
<g id="proc~~makedislocation~~CallsGraph_edge12" class="edge"><title>proc~makedislocation&#45;&gt;qu2om</title>
<path fill="none" stroke="#ff0000" d="M49.5409,-314.774C59.3628,-289.917 84.8985,-233.124 124,-201 129.571,-196.423 136.249,-192.773 143,-189.888"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.698,-192.989 152.823,-186.189 142.231,-186.438 144.698,-192.989"/>
</g>
<!-- quat_lp -->
<g id="proc~~makedislocation~~CallsGraph_node14" class="node"><title>quat_lp</title>
<polygon fill="#777777" stroke="#777777" points="207,-150 153,-150 153,-126 207,-126 207,-150"/>
<text text-anchor="middle" x="180" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">quat_lp</text>
</g>
<!-- proc~makedislocation&#45;&gt;quat_lp -->
<g id="proc~~makedislocation~~CallsGraph_edge13" class="edge"><title>proc~makedislocation&#45;&gt;quat_lp</title>
<path fill="none" stroke="#ff0000" d="M47.4884,-314.557C54.2535,-283.85 75.8012,-203.721 124,-159 129.512,-153.886 136.397,-149.977 143.412,-147.003"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.762,-150.236 152.941,-143.501 142.347,-143.665 144.762,-150.236"/>
</g>
<!-- printmatrixd -->
<g id="proc~~makedislocation~~CallsGraph_node15" class="node"><title>printmatrixd</title>
<polygon fill="#777777" stroke="#777777" points="213.5,-108 146.5,-108 146.5,-84 213.5,-84 213.5,-108"/>
<text text-anchor="middle" x="180" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">printmatrixd</text>
</g>
<!-- proc~makedislocation&#45;&gt;printmatrixd -->
<g id="proc~~makedislocation~~CallsGraph_edge14" class="edge"><title>proc~makedislocation&#45;&gt;printmatrixd</title>
<path fill="none" stroke="#ff0000" d="M46.1185,-314.965C50.0273,-279.646 66.1632,-175.122 124,-117 127.734,-113.247 132.209,-110.153 136.972,-107.606"/>
<polygon fill="#ff0000" stroke="#ff0000" points="138.702,-110.664 146.367,-103.349 135.813,-104.288 138.702,-110.664"/>
</g>
<!-- calcangle -->
<g id="proc~~makedislocation~~CallsGraph_node16" class="node"><title>calcangle</title>
<polygon fill="#777777" stroke="#777777" points="208.5,-66 151.5,-66 151.5,-42 208.5,-42 208.5,-66"/>
<text text-anchor="middle" x="180" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">calcangle</text>
</g>
<!-- proc~makedislocation&#45;&gt;calcangle -->
<g id="proc~~makedislocation~~CallsGraph_edge15" class="edge"><title>proc~makedislocation&#45;&gt;calcangle</title>
<path fill="none" stroke="#ff0000" d="M45.2422,-314.927C46.6879,-275.143 56.6093,-146.628 124,-75 128.847,-69.8484 135.092,-65.9474 141.626,-62.9974"/>
<polygon fill="#ff0000" stroke="#ff0000" points="143.177,-66.1519 151.276,-59.3207 140.685,-59.6106 143.177,-66.1519"/>
</g>
<!-- normvec -->
<g id="proc~~makedislocation~~CallsGraph_node17" class="node"><title>normvec</title>
<polygon fill="#777777" stroke="#777777" points="207,-24 153,-24 153,-0 207,-0 207,-24"/>
<text text-anchor="middle" x="180" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">normvec</text>
</g>
<!-- proc~makedislocation&#45;&gt;normvec -->
<g id="proc~~makedislocation~~CallsGraph_edge16" class="edge"><title>proc~makedislocation&#45;&gt;normvec</title>
<path fill="none" stroke="#ff0000" d="M44.5966,-314.841C43.8072,-270.886 46.9746,-118.331 124,-33 129.132,-27.3144 135.973,-23.158 143.081,-20.1227"/>
<polygon fill="#ff0000" stroke="#ff0000" points="144.572,-23.3067 152.806,-16.6402 142.212,-16.7165 144.572,-23.3067"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,-0 63,-0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,-0 135.5,-0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,-0 207.5,-0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,-0 359.5,-0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,-0 431.5,-0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="545.5,-24 449.5,-24 449.5,-0 545.5,-0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
     
     <h3>Called By</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: proc~~makedislocation~~CalledByGraph Pages: 1 -->
<svg id="procmakedislocationCalledByGraph" width="520pt" height="74pt"
 viewBox="0.00 0.00 520.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~makedislocation~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~makedislocation~~CalledByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 516,-70 516,4 -4,4"/>
<!-- proc~makedislocation -->
<g id="proc~~makedislocation~~CalledByGraph_node1" class="node"><title>proc~makedislocation</title>
<polygon fill="none" stroke="black" points="512,-45 424,-45 424,-21 512,-21 512,-45"/>
<text text-anchor="middle" x="468" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">makedislocation</text>
</g>
<!-- proc~init_dislocation_data -->
<g id="proc~~makedislocation~~CalledByGraph_node2" class="node"><title>proc~init_dislocation_data</title>
<g id="a_proc~~makedislocation~~CalledByGraph_node2"><a xlink:href="../proc/init_dislocation_data.html" xlink:title="init_dislocation_data">
<polygon fill="#d9534f" stroke="#d9534f" points="388,-66 280,-66 280,-42 388,-42 388,-66"/>
<text text-anchor="middle" x="334" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_dislocation_data</text>
</a>
</g>
</g>
<!-- proc~init_dislocation_data&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~CalledByGraph_edge4" class="edge"><title>proc~init_dislocation_data&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" d="M388.309,-45.519C396.652,-44.1918 405.275,-42.8198 413.619,-41.4924"/>
<polygon fill="#ff0000" stroke="#ff0000" points="414.295,-44.9289 423.621,-39.9012 413.195,-38.0159 414.295,-44.9289"/>
</g>
<!-- proc~makestackingfault -->
<g id="proc~~makedislocation~~CalledByGraph_node3" class="node"><title>proc~makestackingfault</title>
<g id="a_proc~~makedislocation~~CalledByGraph_node3"><a xlink:href="../proc/makestackingfault.html" xlink:title="makestackingfault">
<polygon fill="#d9534f" stroke="#d9534f" points="382.5,-24 285.5,-24 285.5,-0 382.5,-0 382.5,-24"/>
<text text-anchor="middle" x="334" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">makestackingfault</text>
</a>
</g>
</g>
<!-- proc~makestackingfault&#45;&gt;proc~makedislocation -->
<g id="proc~~makedislocation~~CalledByGraph_edge5" class="edge"><title>proc~makestackingfault&#45;&gt;proc~makedislocation</title>
<path fill="none" stroke="#ff0000" d="M382.655,-19.5815C392.735,-21.1851 403.436,-22.8875 413.709,-24.5219"/>
<polygon fill="#ff0000" stroke="#ff0000" points="413.375,-28.0127 423.801,-26.1274 414.475,-21.0997 413.375,-28.0127"/>
</g>
<!-- proc~initializedefects -->
<g id="proc~~makedislocation~~CalledByGraph_node4" class="node"><title>proc~initializedefects</title>
<g id="a_proc~~makedislocation~~CalledByGraph_node4"><a xlink:href="../proc/initializedefects.html" xlink:title="InitializeDefects">
<polygon fill="#d9534f" stroke="#d9534f" points="86,-45 0,-45 0,-21 86,-21 86,-45"/>
<text text-anchor="middle" x="43" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">InitializeDefects</text>
</a>
</g>
</g>
<!-- proc~initializedefects&#45;&gt;proc~init_dislocation_data -->
<g id="proc~~makedislocation~~CalledByGraph_edge1" class="edge"><title>proc~initializedefects&#45;&gt;proc~init_dislocation_data</title>
<path fill="none" stroke="#ff0000" d="M86.0231,-36.0536C134.289,-39.5608 213.982,-45.3516 269.752,-49.4041"/>
<polygon fill="#ff0000" stroke="#ff0000" points="269.647,-52.9056 279.874,-50.1396 270.154,-45.924 269.647,-52.9056"/>
</g>
<!-- proc~init_stacking_fault_data -->
<g id="proc~~makedislocation~~CalledByGraph_node5" class="node"><title>proc~init_stacking_fault_data</title>
<g id="a_proc~~makedislocation~~CalledByGraph_node5"><a xlink:href="../proc/init_stacking_fault_data.html" xlink:title="init_stacking_fault_data">
<polygon fill="#d9534f" stroke="#d9534f" points="244,-25 122,-25 122,-1 244,-1 244,-25"/>
<text text-anchor="middle" x="183" y="-10.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_stacking_fault_data</text>
</a>
</g>
</g>
<!-- proc~initializedefects&#45;&gt;proc~init_stacking_fault_data -->
<g id="proc~~makedislocation~~CalledByGraph_edge2" class="edge"><title>proc~initializedefects&#45;&gt;proc~init_stacking_fault_data</title>
<path fill="none" stroke="#ff0000" d="M86.1544,-26.8907C94.3322,-25.7055 103.106,-24.4339 111.904,-23.1589"/>
<polygon fill="#ff0000" stroke="#ff0000" points="112.422,-26.6205 121.816,-21.7223 111.418,-19.6929 112.422,-26.6205"/>
</g>
<!-- proc~init_stacking_fault_data&#45;&gt;proc~makestackingfault -->
<g id="proc~~makedislocation~~CalledByGraph_edge3" class="edge"><title>proc~init_stacking_fault_data&#45;&gt;proc~makestackingfault</title>
<path fill="none" stroke="#00ffff" d="M244.175,-12.5961C254.472,-12.527 265.15,-12.4554 275.379,-12.3867"/>
<polygon fill="#00ffff" stroke="#00ffff" points="275.452,-15.8864 285.428,-12.3193 275.405,-8.88656 275.452,-15.8864"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="554pt" height="32pt"
 viewBox="0.00 0.00 553.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 549.5,-28 549.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="63,-24 0,-24 0,-0 63,-0 63,-24"/>
<text text-anchor="middle" x="31.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="135.5,-24 81.5,-24 81.5,-0 135.5,-0 135.5,-24"/>
<text text-anchor="middle" x="108.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="207.5,-24 153.5,-24 153.5,-0 207.5,-0 207.5,-24"/>
<text text-anchor="middle" x="180.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="359.5,-24 225.5,-24 225.5,-0 359.5,-0 359.5,-24"/>
<text text-anchor="middle" x="292.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="431.5,-24 377.5,-24 377.5,-0 431.5,-0 431.5,-24"/>
<text text-anchor="middle" x="404.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="545.5,-24 449.5,-24 449.5,-0 545.5,-0 545.5,-24"/>
<text text-anchor="middle" x="497.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/makedislocation.html#src">makedislocation</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span><span class="k">recursive subroutine </span><span class="n">makedislocation</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">,</span><span class="n">inum</span><span class="p">,</span><span class="n">dinfo</span><span class="p">,</span><span class="n">DF_L</span><span class="p">)</span>
<span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: makedislocation</span>

<span class="k">use </span><span class="n">math</span>
<span class="k">use </span><span class="n">constants</span>
<span class="k">use </span><span class="n">crystal</span>
<span class="k">use </span><span class="n">math</span>
<span class="k">use </span><span class="n">io</span>
<span class="k">use </span><span class="n">symmetry</span>
<span class="k">use </span><span class="n">rotations</span>

<span class="k">IMPLICIT NONE</span>

<span class="k">type</span><span class="p">(</span><span class="n">unitcell</span><span class="p">),</span><span class="k">pointer</span>                  <span class="kd">::</span> <span class="n">cell</span>
<span class="k">type</span><span class="p">(</span><span class="n">defecttype</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">INOUT</span><span class="p">)</span>          <span class="kd">::</span> <span class="n">defects</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">inum</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">dinfo</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>               <span class="kd">::</span> <span class="n">DF_L</span>

<span class="k">type</span><span class="p">(</span><span class="n">foiltype</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">foil</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dbl</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">zz</span><span class="p">,</span><span class="n">zang</span><span class="p">,</span><span class="n">zmin</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">lec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dbl</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">a_dc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">tmp</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ex</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">ey</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dbl</span><span class="p">)</span>                          <span class="kd">::</span> <span class="n">Bij</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Hij</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="kt">complex</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">dbl</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">e</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">ff</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">tt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">s</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">),</span><span class="n">roots</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">&amp;</span>
                                           <span class="n">zero</span><span class="p">,</span><span class="n">pasq</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">aka</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Lia</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">Mai</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">v</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">pas</span>
<span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">)</span>                       <span class="kd">::</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">imin</span><span class="p">,</span><span class="n">ind</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">jnd</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">foil</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">foil</span>

<span class="c">! convert line direction and g-vector to the Cartesian crystal reference frame</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">u</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">g</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">gn</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="c">! normalize both vectors</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">gn</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="c">! first find the length of the dislocation line inside the foil along the</span>
<span class="c">! dislocation z-axis, which is the line direction; also, compute the intersection</span>
<span class="c">! points of the line with the top and bottom surfaces  (all components in [nm])</span>
<span class="n">zang</span> <span class="o">=</span> <span class="n">CalcAngle</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">u</span><span class="p">,</span><span class="nb">dble</span><span class="p">(</span><span class="n">foil</span><span class="p">%</span><span class="n">F</span><span class="p">),</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="n">zz</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">zang</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">zz</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.00001</span><span class="p">)</span> <span class="k">then </span>
<span class="k">  </span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span><span class="o">/</span><span class="n">zz</span>
<span class="k">else</span>
<span class="k">  </span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span> <span class="o">=</span> <span class="mi">10000</span><span class="mf">0.0</span>         <span class="c">! this is when the dislocation is nearly parallel to the foil</span>
<span class="k">end if</span>

<span class="c">! transform the line direction to the foil reference frame</span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">foil</span><span class="p">%</span><span class="n">a_fc</span><span class="p">,</span> <span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">)</span> <span class="p">)</span> <span class="o">/</span> <span class="n">DF_L</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;transformed line direction &#39;</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">zang</span><span class="p">,</span> <span class="n">zz</span>
<span class="k">end if</span>

<span class="c">! determine the top and bottom intersection coordinates </span>
<span class="k">if</span> <span class="p">(</span><span class="n">zz</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">! u points to the top of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span> <span class="o">+</span> <span class="p">&amp;</span>
        <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="mf">0.5D0</span><span class="o">*</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span> <span class="o">-</span> <span class="p">&amp;</span>
        <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
<span class="k">else</span>                 <span class="c">! u points to the bottom of the foil</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span> <span class="o">-</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span> <span class="o">-</span> <span class="p">&amp;</span>
        <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5D0</span><span class="o">*</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
    <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">bottom</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span> <span class="o">+</span> <span class="n">tmp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span> <span class="o">+</span> <span class="p">&amp;</span>
        <span class="n">tmp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">zu</span><span class="p">,</span> <span class="mf">0.5D0</span><span class="o">*</span><span class="n">foil</span><span class="p">%</span><span class="n">z0</span> <span class="o">/</span><span class="p">)</span>
<span class="k">end if  </span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">id</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">jd</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;dislocation top intersection at &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">top</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;dislocation bottom intersection at &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">bottom</span>
<span class="k">end if</span> 

<span class="c">! a_dc (crystal to defect)  matrix corrected on 11/29/10 to put defect x-axis in the plane of u and B</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;cartesian quantities&#39;</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;unit line direction = &#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span>
  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;unit beam direction = &#39;</span><span class="p">,</span><span class="n">foil</span><span class="p">%</span><span class="n">Bn</span>
<span class="k">end if</span>

<span class="c">! transform beam direction (currently in foil frame) to cartesian </span>
<span class="n">tmp</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fc</span><span class="p">),</span> <span class="nb">dble</span><span class="p">(</span><span class="n">foil</span><span class="p">%</span><span class="n">Bn</span><span class="p">))</span>
<span class="c">!tmp = quat_rotate_vector(conjg(foil%a_fc), (/ 0.0D0, 0.0D0, -1.0D0/) )</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">tmp</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>

<span class="c">! the defect z axis is the line direction and x is in the plane of u and B to avoid the intrinsic discontinuity (cut plane)</span>
<span class="n">a_dc</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="k">call </span><span class="n">CalcCross</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">),</span><span class="n">tmp</span><span class="p">,</span><span class="n">ex</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">ex</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">a_dc</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ex</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="k">call </span><span class="n">CalcCross</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">un</span><span class="p">),</span><span class="n">ex</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="k">call </span><span class="n">NormVec</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="n">a_dc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ey</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_dc</span> <span class="o">=</span> <span class="n">om2qu</span><span class="p">(</span><span class="n">a_dc</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">PrintMatrixd</span><span class="p">(</span><span class="s1">&#39;a_dc&#39;</span><span class="p">,</span><span class="n">a_dc</span><span class="p">)</span>
<span class="k">end if</span>

<span class="c">! a_di (image to defect)</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_di</span> <span class="o">=</span> <span class="n">quat_mult</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_dc</span><span class="p">,</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">foil</span><span class="p">%</span><span class="n">a_ic</span><span class="p">)</span> <span class="p">)</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_id</span> <span class="o">=</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_di</span><span class="p">)</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  call </span><span class="n">print_orientation_d</span><span class="p">(</span><span class="n">init_orientation_d</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_di</span><span class="p">,</span><span class="s1">&#39;qu&#39;</span><span class="p">),</span><span class="s1">&#39;om&#39;</span><span class="p">,</span><span class="s1">&#39;a_di:     &#39;</span><span class="p">)</span>
  <span class="k">call </span><span class="n">print_orientation_d</span><span class="p">(</span><span class="n">init_orientation_d</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_id</span><span class="p">,</span><span class="s1">&#39;qu&#39;</span><span class="p">),</span><span class="s1">&#39;om&#39;</span><span class="p">,</span><span class="s1">&#39;a_id:     &#39;</span><span class="p">)</span>
<span class="k">end if</span>

<span class="c">! finally, get the foil to defect transformation (used in defect module)</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_df</span> <span class="o">=</span> <span class="n">quat_mult</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_di</span><span class="p">,</span> <span class="nb">conjg</span><span class="p">(</span><span class="n">foil</span><span class="p">%</span><span class="n">a_fi</span><span class="p">)</span> <span class="p">)</span>

<span class="c">! Burgers vector (in the defect reference frame !!!)</span>
<span class="c">! first transform Burgers vector to crystal cartesian reference frame</span>
<span class="k">call </span><span class="n">TransSpace</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span><span class="nb">dble</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">burg</span><span class="p">),</span><span class="n">tmp</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="c">! then convert this to the defect reference frame</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">burgd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">quat_Lp</span><span class="p">(</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_dc</span><span class="p">,</span><span class="nb">dble</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>

<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;rotated burgers vector  = &#39;</span><span class="p">,</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">burgd</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> 
<span class="k">end if</span>

<span class="c">! transform the elastic moduli</span>
<span class="n">lec</span> <span class="o">=</span> <span class="n">foil</span><span class="p">%</span><span class="n">elmo</span>

<span class="c">! transform lec to defect reference frame</span>
<span class="n">a_dc</span> <span class="o">=</span> <span class="n">qu2om</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">a_dc</span><span class="p">)</span>
<span class="k">call </span><span class="n">TransFourthRankTensor</span><span class="p">(</span><span class="n">a_dc</span><span class="p">,</span><span class="n">lec</span><span class="p">,</span><span class="n">ec</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>  <span class="k">then </span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Elasticity tensor in defect reference frame&#39;</span>
  <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span> 
    <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s2">&quot;(6(F8.4,2x))&quot;</span><span class="p">)</span> <span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
  <span class="k">end do</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;----&#39;</span>
<span class="k">end if</span>

<span class="c">! next, create the sextic polynomial</span>
<span class="n">zero</span> <span class="o">=</span> <span class="nb">cmplx</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span>
<span class="n">a</span><span class="o">=</span><span class="n">zero</span><span class="p">;</span> <span class="n">b</span><span class="o">=</span><span class="n">zero</span><span class="p">;</span> <span class="n">c</span><span class="o">=</span><span class="n">zero</span><span class="p">;</span> <span class="n">d</span><span class="o">=</span><span class="n">zero</span><span class="p">;</span> <span class="n">e</span><span class="o">=</span><span class="n">zero</span><span class="p">;</span> <span class="n">ff</span><span class="o">=</span><span class="n">zero</span>
<span class="n">a</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span>     <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">b</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span>     <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span>     <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">d</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">e</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">ff</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">),</span> <span class="nb">cmplx</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span> <span class="o">/</span><span class="p">)</span>
<span class="n">tt</span> <span class="o">=</span> <span class="n">zero</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">zero</span>

<span class="c">! matrix elements</span>
<span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span> 
 <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span> 
  <span class="n">tt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">b</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="n">tt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="n">tt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="n">tt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="n">tt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">tt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
 <span class="k">end do</span>
<span class="k">end do</span>

<span class="c">! determinant leading to the sextic equation</span>
<span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span> 
 <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">j</span> 
  <span class="n">s</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="n">tt</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">tt</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">tt</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">tt</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">e</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">tt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">ff</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
 <span class="k">end do</span>
<span class="k">end do</span>

<span class="c">! get the complex root pairs</span>
<span class="k">call </span><span class="n">zroots</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">roots</span><span class="p">)</span>

<span class="c">! then, solve the equation for the vector A_k using the roots with positive imaginary part.</span>
<span class="n">k</span><span class="o">=</span><span class="mi">1</span>
<span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">roots</span><span class="p">(</span><span class="n">j</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="mf">0.0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">roots</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
  <span class="k">end if</span>
<span class="k">end do</span>

<span class="c">! renumber them to avoid the symmetry degeneracy (see page 328 Head et al.)</span>
<span class="n">v</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">zmin</span> <span class="o">=</span> <span class="mi">10</span><span class="mf">0.0</span>
<span class="n">imin</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c">! where is the smallest value ?</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)).</span><span class="n">lt</span><span class="p">.</span><span class="n">zmin</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">imin</span><span class="o">=</span><span class="n">i</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
  <span class="k">end if</span>
<span class="k">end do</span>

<span class="c">! is the 3rd one the smallest ? if not, then swap with the current 3rd one.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">imin</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  </span><span class="n">pas</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">imin</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">imin</span><span class="p">)</span><span class="o">=</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">pas</span>
<span class="k">end if</span>
<span class="k">  </span><span class="n">pas</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">pas</span>

<span class="c">! eliminate really small numbers</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="nb">aimag</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">))).</span><span class="n">lt</span><span class="p">.</span><span class="mf">1.0e-8</span><span class="p">)</span>  <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="mf">0.0</span><span class="p">,</span><span class="n">dbl</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">))).</span><span class="n">lt</span><span class="p">.</span><span class="mf">1.0e-8</span><span class="p">)</span>   <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">=</span><span class="nb">cmplx</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="nb">aimag</span><span class="p">(</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span><span class="n">dbl</span><span class="p">)</span>
<span class="k">end do</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39; sextic roots&#39;</span>
  <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
    <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">end do</span>
<span class="k">  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;---&#39;</span>
<span class="k">end if</span>

<span class="c">!  compute the A_ka vectors (see description on page 328 of Head et al.)</span>
<span class="n">pasq</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="o">**</span><span class="mi">2</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Aka vectors&#39;</span>
<span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
  <span class="n">mat</span> <span class="o">=</span> <span class="n">zero</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">2.D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="mf">2.D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="mf">2.D0</span><span class="o">*</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">+</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span><span class="o">+</span><span class="n">ec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">pasq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">aka</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">end if</span>
<span class="k">  if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">aka</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
  <span class="k">end if</span>
<span class="k">  if</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<span class="k">    </span><span class="n">aka</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">aka</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">mat</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
  <span class="k">end if  </span>
<span class="k">  if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">k</span><span class="p">,(</span><span class="n">aka</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">end do</span>
<span class="n">aka</span> <span class="o">=</span> <span class="nb">transpose</span><span class="p">(</span><span class="n">aka</span><span class="p">)</span>

<span class="c">! next, create the L_ialpha matrix</span>
<span class="n">ind</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">/</span><span class="p">)</span>
<span class="n">jnd</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span><span class="p">)</span>
<span class="n">Lia</span> <span class="o">=</span> <span class="n">zero</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span> 
 <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
  <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
   <span class="n">Lia</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Lia</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ec</span><span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">jnd</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">+</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">pa</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">ec</span><span class="p">(</span><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)))</span><span class="o">*</span><span class="n">aka</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
  <span class="k">end do</span>
<span class="k"> end do</span>
<span class="k">end do</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>  <span class="k">call </span><span class="n">PrintMatrixcd</span><span class="p">(</span><span class="s1">&#39;Lia &#39;</span><span class="p">,</span><span class="n">Lia</span><span class="p">)</span>

<span class="c">! and invert it</span>
<span class="k">call </span><span class="n">cInvert</span><span class="p">(</span><span class="n">Lia</span><span class="p">,</span><span class="n">Mai</span><span class="p">)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>  <span class="k">call </span><span class="n">PrintMatrixcd</span><span class="p">(</span><span class="s1">&#39;Mai &#39;</span><span class="p">,</span><span class="n">Mai</span><span class="p">)</span>

<span class="c">! compute Bij ( real matrix )</span>
<span class="n">Bij</span> <span class="o">=</span> <span class="mf">0.D0</span>
<span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
 <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
  <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
   <span class="n">Bij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Bij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="nb">aimag</span><span class="p">(</span><span class="n">aka</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="kt">real</span><span class="p">(</span><span class="n">Mai</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">))</span> <span class="o">-</span> <span class="kt">real</span><span class="p">(</span><span class="n">aka</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="nb">aimag</span><span class="p">(</span><span class="n">Mai</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
  <span class="k">end do</span>
<span class="k"> end do</span>
<span class="k">end do</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>  <span class="k">call </span><span class="n">PrintMatrixd</span><span class="p">(</span><span class="s1">&#39;Bij &#39;</span><span class="p">,</span><span class="n">Bij</span><span class="p">)</span>

<span class="c">! and invert to get Hij</span>
<span class="k">call </span><span class="n">mInvert</span><span class="p">(</span><span class="n">Bij</span><span class="p">,</span><span class="n">Hij</span><span class="p">,.</span><span class="n">FALSE</span><span class="p">.)</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">PrintMatrixd</span><span class="p">(</span><span class="s1">&#39;Hij &#39;</span><span class="p">,</span><span class="n">Hij</span><span class="p">)</span>

<span class="c">! compute matrix (this is what actually gets to be used for the </span>
<span class="c">! displacement field); needs to know the Burgers vector.</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span> <span class="o">=</span> <span class="n">zero</span>
<span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
 <span class="k">do </span><span class="n">l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
   <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
     <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">burgd</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">Hij</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">Mai</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">aka</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
    <span class="k">end do</span>
<span class="k">   end do</span>
<span class="k"> end do</span>
<span class="k">end do</span>

<span class="c">! scale by 1/4pi</span>
<span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span> <span class="o">=</span> <span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span><span class="o">*</span><span class="mf">0.25D0</span><span class="o">/</span><span class="n">cPi</span>
<span class="k">if</span> <span class="p">(</span><span class="n">dinfo</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span>  <span class="k">call </span><span class="n">PrintMatrixcd</span><span class="p">(</span><span class="s1">&#39;dismat&#39;</span><span class="p">,</span><span class="n">defects</span><span class="p">%</span><span class="n">DL</span><span class="p">(</span><span class="n">inum</span><span class="p">)%</span><span class="n">dismat</span><span class="p">)</span>

<span class="c">! and return to calling routine</span>
<span class="k">end subroutine </span><span class="n">makedislocation</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/adhisteq.html">adhisteq</a>
      
      <a class="list-group-item" href="../proc/aggiorno_ottimo.html">AGGIORNO_OTTIMO</a>
      
      <a class="list-group-item" href="../proc/alogam.html">alogam</a>
      
      <a class="list-group-item" href="../proc/altmov.html">altmov</a>
      
      <a class="list-group-item" href="../proc/altmov%7E2.html">altmov</a>
      
      <a class="list-group-item" href="../proc/backprojection.html">BackProjection</a>
      
      <a class="list-group-item" href="../proc/bakvec.html">bakvec</a>
      
      <a class="list-group-item" href="../proc/balanc.html">balanc</a>
      
      <a class="list-group-item" href="../proc/balbak.html">balbak</a>
      
      <a class="list-group-item" href="../proc/bandr.html">bandr</a>
      
      <a class="list-group-item" href="../proc/bandv.html">bandv</a>
      
      <a class="list-group-item" href="../proc/barreldistortion.html">BarrelDistortion</a>
      
      <a class="list-group-item" href="../proc/bisect.html">bisect</a>
      
      <a class="list-group-item" href="../proc/bobyqa.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqa%7E2.html">bobyqa</a>
      
      <a class="list-group-item" href="../proc/bobyqb.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bobyqb%7E2.html">bobyqb</a>
      
      <a class="list-group-item" href="../proc/bqr.html">bqr</a>
      
      <a class="list-group-item" href="../proc/butterflymask9x9.html">ButterflyMask9x9</a>
      
      <a class="list-group-item" href="../proc/calchoughlut.html">CalcHoughLUT</a>
      
      <a class="list-group-item" href="../proc/calckinpedpatternsingle.html">CalcKINPEDPatternSingle</a>
      
      <a class="list-group-item" href="../proc/calckvectorcone.html">Calckvectorcone</a>
      
      <a class="list-group-item" href="../proc/calckvectortrace.html">Calckvectortrace</a>
      
      <a class="list-group-item" href="../proc/calcr.html">CalcR</a>
      
      <a class="list-group-item" href="../proc/calcrlocal.html">CalcRLocal</a>
      
      <a class="list-group-item" href="../proc/cardintersection.html">CardIntersection</a>
      
      <a class="list-group-item" href="../proc/cbabk2.html">cbabk2</a>
      
      <a class="list-group-item" href="../proc/cbal.html">cbal</a>
      
      <a class="list-group-item" href="../proc/cdiv.html">cdiv</a>
      
      <a class="list-group-item" href="../proc/cg.html">cg</a>
      
      <a class="list-group-item" href="../proc/ch.html">ch</a>
      
      <a class="list-group-item" href="../proc/cinvit.html">cinvit</a>
      
      <a class="list-group-item" href="../proc/clerror_check.html">CLerror_check</a>
      
      <a class="list-group-item" href="../proc/clinit_pdccq.html">CLinit_PDCCQ</a>
      
      <a class="list-group-item" href="../proc/clquery_platform_info.html">CLquery_platform_info</a>
      
      <a class="list-group-item" href="../proc/clread_source_file.html">CLread_source_file</a>
      
      <a class="list-group-item" href="../proc/combak.html">combak</a>
      
      <a class="list-group-item" href="../proc/comhes.html">comhes</a>
      
      <a class="list-group-item" href="../proc/comlr.html">comlr</a>
      
      <a class="list-group-item" href="../proc/comlr2.html">comlr2</a>
      
      <a class="list-group-item" href="../proc/comqr.html">comqr</a>
      
      <a class="list-group-item" href="../proc/comqr2.html">comqr2</a>
      
      <a class="list-group-item" href="../proc/cortb.html">cortb</a>
      
      <a class="list-group-item" href="../proc/corth.html">corth</a>
      
      <a class="list-group-item" href="../proc/csroot.html">csroot</a>
      
      <a class="list-group-item" href="../proc/ctfped_writefile.html">ctfped_writeFile</a>
      
      <a class="list-group-item" href="../proc/cubochoricneighbors.html">CubochoricNeighbors</a>
      
      <a class="list-group-item" href="../proc/cumul_histogram.html">cumul_histogram</a>
      
      <a class="list-group-item" href="../proc/dd_density.html">DD_Density</a>
      
      <a class="list-group-item" href="../proc/dd_estep.html">DD_Estep</a>
      
      <a class="list-group-item" href="../proc/dd_getqandl.html">DD_getQandL</a>
      
      <a class="list-group-item" href="../proc/dd_mstep.html">DD_Mstep</a>
      
      <a class="list-group-item" href="../proc/delete_fzlist.html">delete_FZlist</a>
      
      <a class="list-group-item" href="../proc/denoise_pattern.html">Denoise_Pattern</a>
      
      <a class="list-group-item" href="../proc/denoise_ped.html">Denoise_PED</a>
      
      <a class="list-group-item" href="../proc/di_emfordd.html">DI_EMforDD</a>
      
      <a class="list-group-item" href="../proc/di_init.html">DI_Init</a>
      
      <a class="list-group-item" href="../proc/di_rotatetomu.html">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../proc/di_sampledd.html">DI_SampleDD</a>
      
      <a class="list-group-item" href="../proc/di_similarity_classifier.html">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../proc/ebsd4calfun.html">EBSD4calfun</a>
      
      <a class="list-group-item" href="../proc/ebsdcalfun.html">EBSDcalfun</a>
      
      <a class="list-group-item" href="../proc/eccicalcsgh.html">ECCICalcSgh</a>
      
      <a class="list-group-item" href="../proc/ecpcalfun.html">ECPcalfun</a>
      
      <a class="list-group-item" href="../proc/efitebsdwrapper.html">efitEBSDWrapper</a>
      
      <a class="list-group-item" href="../proc/efitecpwrapper.html">efitECPWrapper</a>
      
      <a class="list-group-item" href="../proc/ei.html">EI</a>
      
      <a class="list-group-item" href="../proc/elmbak.html">elmbak</a>
      
      <a class="list-group-item" href="../proc/elmhes.html">elmhes</a>
      
      <a class="list-group-item" href="../proc/eltran.html">eltran</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdmaster.html">EMsoftCgetEBSDmaster</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetebsdpatterns.html">EMsoftCgetEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetecpatterns.html">EMsoftCgetECPatterns</a>
      
      <a class="list-group-item" href="../proc/emsoftcgetmcopencl.html">EMsoftCgetMCOpenCL</a>
      
      <a class="list-group-item" href="../proc/eshelby_disp.html">Eshelby_disp</a>
      
      <a class="list-group-item" href="../proc/fcore.html">FCORE</a>
      
      <a class="list-group-item" href="../proc/figi.html">figi</a>
      
      <a class="list-group-item" href="../proc/figi2.html">figi2</a>
      
      <a class="list-group-item" href="../proc/forwardprojection.html">ForwardProjection</a>
      
      <a class="list-group-item" href="../proc/fphon.html">FPHON</a>
      
      <a class="list-group-item" href="../proc/fscatt.html">FSCATT</a>
      
      <a class="list-group-item" href="../proc/genera_punto_sa.html">GENERA_PUNTO_SA</a>
      
      <a class="list-group-item" href="../proc/getaverageorientationnamelist.html">GetAverageOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getconvertorientationsnamelist.html">GetConvertOrientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdddensitylbm.html">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../proc/getdictindxopenclnamelist.html">GetDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../interface/getdisorientationangle.html">getDisorientationAngle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxis.html">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangleaxistwophases.html">getDisorientationAngleAxisTwoPhases</a>
      
      <a class="list-group-item" href="../proc/getdisorientationangledouble.html">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../proc/getdisorientationanglesingle.html">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../proc/getdisorientationsnamelist.html">GetDisorientationsNameList</a>
      
      <a class="list-group-item" href="../proc/getdvsdnamelist.html">GetDvsDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdclusternamelist.html">GetEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsddetparmscannamelist.html">GetEBSDdetparmscanNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdfullnamelist.html">GetEBSDFullNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdindexingnamelist.html">GetEBSDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasternamelist.html">GetEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdmasteropenclnamelist.html">GetEBSDMasterOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdnamelist.html">GetEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdoverlapnamelist.html">GetEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns.html">getEBSDPatterns</a>
      
      <a class="list-group-item" href="../proc/getebsdpatterns2.html">getEBSDPatterns2</a>
      
      <a class="list-group-item" href="../proc/getebsdpatternswrapper.html">getEBSDPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/geteccinamelist.html">GetECCINameList</a>
      
      <a class="list-group-item" href="../proc/getecpatterns.html">getECPatterns</a>
      
      <a class="list-group-item" href="../proc/getecpatternswrapper.html">getECPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getecpindexingnamelist.html">GetECPIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/getecpmasternamelist.html">GetECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getecpnamelist.html">GetECPNameList</a>
      
      <a class="list-group-item" href="../proc/getecppatternnamelist.html">GetECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/getecpsinglenamelist.html">GetECPSingleNameList</a>
      
      <a class="list-group-item" href="../proc/getecpzanamelist.html">GetECPZANameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfit4namelist.html">GetEMDPFit4NameList</a>
      
      <a class="list-group-item" href="../proc/getemdpfitnamelist.html">GetEMDPFitNameList</a>
      
      <a class="list-group-item" href="../proc/geteulersfromfile.html">getEulersfromFile</a>
      
      <a class="list-group-item" href="../proc/getfitorientationpsnamelist.html">GetFitOrientationPSNameList</a>
      
      <a class="list-group-item" href="../proc/getfztypeandorder.html">getFZtypeandorder</a>
      
      <a class="list-group-item" href="../proc/getkamnamelist.html">GetKAMNameList</a>
      
      <a class="list-group-item" href="../proc/getkinematicalnamelist.html">GetkinematicalNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselmasternamelist.html">GetKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselnamelist.html">GetKosselNameList</a>
      
      <a class="list-group-item" href="../proc/getkosselpatterns.html">getKosselPatterns</a>
      
      <a class="list-group-item" href="../proc/getkosselpatternswrapper.html">getKosselPatternsWrapper</a>
      
      <a class="list-group-item" href="../proc/getlacbednamelist.html">GetLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclfoilnamelist.html">GetMCCLfoilNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclmultilayernamelist.html">GetMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclnamelist.html">GetMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/getmcclspherenamelist.html">GetMCCLsphereNameList</a>
      
      <a class="list-group-item" href="../proc/getmclipssnamelist.html">GetMCLIPSSNameList</a>
      
      <a class="list-group-item" href="../proc/getmcnamelist.html">GetMCNameList</a>
      
      <a class="list-group-item" href="../proc/getmultiphasenamelist.html">GetMultiPhaseNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationsimilaritynamelist.html">GetOrientationSimilarityNameList</a>
      
      <a class="list-group-item" href="../proc/getorientationviznamelist.html">GetOrientationVizNameList</a>
      
      <a class="list-group-item" href="../proc/getpedindxnamelist.html">GetPEDIndxNameList</a>
      
      <a class="list-group-item" href="../proc/getpedkinnamelist.html">GetPEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/getpedzanamelist.html">GetPEDZANameList</a>
      
      <a class="list-group-item" href="../proc/getpfinversionnamelist.html">GetPFInversionNameList</a>
      
      <a class="list-group-item" href="../proc/getrefineorientationnamelist.html">GetRefineOrientationNameList</a>
      
      <a class="list-group-item" href="../proc/getreflectornamelist.html">GetreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/getrfznamelist.html">GetRFZNameList</a>
      
      <a class="list-group-item" href="../proc/getsrdefectnamelist.html">GetSRdefectNameList</a>
      
      <a class="list-group-item" href="../proc/getstemdcinamelist.html">GetSTEMDCINameList</a>
      
      <a class="list-group-item" href="../proc/gettkdindexingnamelist.html">GetTKDIndexingNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdmasternamelist.html">GetTKDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/gettkdnamelist.html">GetTKDNameList</a>
      
      <a class="list-group-item" href="../proc/getwk.html">GETWK</a>
      
      <a class="list-group-item" href="../proc/getzadefectnamelist.html">GetZAdefectNameList</a>
      
      <a class="list-group-item" href="../proc/hipassfilter.html">HiPassFilter</a>
      
      <a class="list-group-item" href="../proc/houghtransform.html">HoughTransform</a>
      
      <a class="list-group-item" href="../proc/hqr.html">hqr</a>
      
      <a class="list-group-item" href="../proc/hqr2.html">hqr2</a>
      
      <a class="list-group-item" href="../proc/htrib3.html">htrib3</a>
      
      <a class="list-group-item" href="../proc/htribk.html">htribk</a>
      
      <a class="list-group-item" href="../proc/htrid3.html">htrid3</a>
      
      <a class="list-group-item" href="../proc/htridi.html">htridi</a>
      
      <a class="list-group-item" href="../proc/image_entropy.html">image_entropy</a>
      
      <a class="list-group-item" href="../proc/image_histogram.html">image_histogram</a>
      
      <a class="list-group-item" href="../proc/image_jointentropy.html">image_jointentropy</a>
      
      <a class="list-group-item" href="../proc/image_jointhistogram.html">image_jointhistogram</a>
      
      <a class="list-group-item" href="../proc/image_mutualinformation.html">image_mutualinformation</a>
      
      <a class="list-group-item" href="../proc/imtql1.html">imtql1</a>
      
      <a class="list-group-item" href="../proc/imtql2.html">imtql2</a>
      
      <a class="list-group-item" href="../proc/imtqlv.html">imtqlv</a>
      
      <a class="list-group-item" href="../proc/init_dislocation_data.html">init_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/init_einclusion_data.html">init_Einclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_foil_data.html">init_foil_data</a>
      
      <a class="list-group-item" href="../proc/init_inclusion_data.html">init_inclusion_data</a>
      
      <a class="list-group-item" href="../proc/init_stacking_fault_data.html">init_stacking_fault_data</a>
      
      <a class="list-group-item" href="../proc/init_stem.html">init_STEM</a>
      
      <a class="list-group-item" href="../proc/init_stem_za.html">init_STEM_ZA</a>
      
      <a class="list-group-item" href="../proc/init_void_data.html">init_void_data</a>
      
      <a class="list-group-item" href="../proc/init_ysh_dislocation_data.html">init_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/initialize_foil_geometry.html">initialize_foil_geometry</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../interface/initialize_reflectionlist.html">Initialize_ReflectionList</a>
      
      <a class="list-group-item" href="../proc/initialize_reflectionlist_ewaldsweep.html">Initialize_ReflectionList_EwaldSweep</a>
      
      <a class="list-group-item" href="../proc/initializedefects.html">InitializeDefects</a>
      
      <a class="list-group-item" href="../proc/initializeeshelbyinclusion.html">InitializeEshelbyInclusion</a>
      
      <a class="list-group-item" href="../proc/innerprodgpu.html">InnerProdGPU</a>
      
      <a class="list-group-item" href="../proc/insidecubehexfz.html">insideCubeHexFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicfz.html">insideCubicFZ</a>
      
      <a class="list-group-item" href="../proc/insidecubicmfz.html">insideCubicMFZ</a>
      
      <a class="list-group-item" href="../proc/insidecyclicfz.html">insideCyclicFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralfz.html">insideDihedralFZ</a>
      
      <a class="list-group-item" href="../proc/insidedihedralmfz.html">insideDihedralMFZ</a>
      
      <a class="list-group-item" href="../proc/interfaccia.html">INTERFACCIA</a>
      
      <a class="list-group-item" href="../proc/inversiondivision.html">InversionDivision</a>
      
      <a class="list-group-item" href="../proc/invit.html">invit</a>
      
      <a class="list-group-item" href="../proc/isinsidefz.html">IsinsideFZ</a>
      
      <a class="list-group-item" href="../proc/isinsidemfz.html">IsinsideMFZ</a>
      
      <a class="list-group-item" href="../proc/jaccard_distance.html">Jaccard_Distance</a>
      
      <a class="list-group-item" href="../proc/json_cleanuppointers.html">JSON_cleanuppointers</a>
      
      <a class="list-group-item" href="../proc/json_failtest.html">JSON_failtest</a>
      
      <a class="list-group-item" href="../proc/json_initpointers.html">JSON_initpointers</a>
      
      <a class="list-group-item" href="../proc/json_minify.html">JSON_minify</a>
      
      <a class="list-group-item" href="../proc/json_writenmldoubles.html">JSON_writeNMLdoubles</a>
      
      <a class="list-group-item" href="../proc/json_writenmlintegers.html">JSON_writeNMLintegers</a>
      
      <a class="list-group-item" href="../proc/json_writenmlreals.html">JSON_writeNMLreals</a>
      
      <a class="list-group-item" href="../proc/jsongetdouble.html">JSONgetDouble</a>
      
      <a class="list-group-item" href="../proc/jsongetdoublevector.html">JSONgetDoubleVector</a>
      
      <a class="list-group-item" href="../proc/jsonreaddefectfile.html">JSONreadDefectFile</a>
      
      <a class="list-group-item" href="../proc/jsonreaddouble.html">JSONreadDouble</a>
      
      <a class="list-group-item" href="../proc/jsonreaddoublevec.html">JSONreadDoubleVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdclusternamelist.html">JSONreadEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdmasternamelist.html">JSONreadEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdnamelist.html">JSONreadEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadebsdoverlapnamelist.html">JSONreadEBSDoverlapNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadecpmasternamelist.html">JSONreadECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadfoildata.html">JSONreadFoilData</a>
      
      <a class="list-group-item" href="../proc/jsonreadinteger.html">JSONreadInteger</a>
      
      <a class="list-group-item" href="../proc/jsonreadintegervec.html">JSONreadIntegerVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselmasternamelist.html">JSONreadKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadkosselnamelist.html">JSONreadKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadlogical.html">JSONreadLogical</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclmultilayernamelist.html">JSONreadMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcclnamelist.html">JSONreadMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadmcnamelist.html">JSONreadMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadreal.html">JSONreadReal</a>
      
      <a class="list-group-item" href="../proc/jsonreadrealvec.html">JSONreadRealVec</a>
      
      <a class="list-group-item" href="../proc/jsonreadreflectornamelist.html">JSONreadreflectorNameList</a>
      
      <a class="list-group-item" href="../proc/jsonreadstring.html">JSONreadString</a>
      
      <a class="list-group-item" href="../proc/jsonwritedictindxopenclnamelist.html">JSONwriteDictIndxOpenCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdclusternamelist.html">JSONwriteEBSDclusterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdmasternamelist.html">JSONwriteEBSDMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteebsdnamelist.html">JSONwriteEBSDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteeccinamelist.html">JSONwriteECCINameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpmasternamelist.html">JSONwriteECPMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecpnamelist.html">JSONwriteECPNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriteecppatternnamelist.html">JSONwriteECPpatternNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselmasternamelist.html">JSONwriteKosselMasterNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritekosselnamelist.html">JSONwriteKosselNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritelacbednamelist.html">JSONwriteLACBEDNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclmultilayernamelist.html">JSONwriteMCCLMultiLayerNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcclnamelist.html">JSONwriteMCCLNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritemcnamelist.html">JSONwriteMCNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedkinnamelist.html">JSONwritePEDkinNameList</a>
      
      <a class="list-group-item" href="../proc/jsonwritepedzanamelist.html">JSONwritePEDZANameList</a>
      
      <a class="list-group-item" href="../proc/jsonwriterfznamelist.html">JSONwriteRFZNameList</a>
      
      <a class="list-group-item" href="../proc/linesearch_inverti.html">LINESEARCH_INVERTI</a>
      
      <a class="list-group-item" href="../proc/linesearchbox_cont.html">linesearchbox_cont</a>
      
      <a class="list-group-item" href="../proc/logcp.html">logCp</a>
      
      <a class="list-group-item" href="../proc/mainbox1.html">MAINBOX1</a>
      
      <a class="list-group-item" href="../proc/mainbox2.html">MAINBOX2</a>
      
      <a class="list-group-item" href="../proc/makedislocation.html">makedislocation</a>
      
      <a class="list-group-item" href="../proc/makestackingfault.html">makestackingfault</a>
      
      <a class="list-group-item" href="../proc/makestackingfaultecci.html">makestackingfaultECCI</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/makeyshdislocation%7E2.html">makeYSHdislocation</a>
      
      <a class="list-group-item" href="../proc/mc_concatenatemuellermatrices.html">MC_concatenateMuellerMatrices</a>
      
      <a class="list-group-item" href="../proc/mc_get_ad_from_eo.html">MC_get_AD_from_EO</a>
      
      <a class="list-group-item" href="../proc/mc_get_auxiliaryangle.html">MC_get_AuxiliaryAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_basicmuellermatrix.html">MC_get_basicMuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_get_diattenuator.html">MC_get_diattenuator</a>
      
      <a class="list-group-item" href="../proc/mc_get_ellipticityangle.html">MC_get_EllipticityAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_eo_from_ad.html">MC_get_EO_from_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_orientationangle.html">MC_get_OrientationAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_phaseshiftangle.html">MC_get_PhaseShiftAngle</a>
      
      <a class="list-group-item" href="../proc/mc_get_polarization.html">MC_get_Polarization</a>
      
      <a class="list-group-item" href="../proc/mc_get_retarder.html">MC_get_retarder</a>
      
      <a class="list-group-item" href="../proc/mc_get_rotator.html">MC_get_rotator</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_ad.html">MC_get_Stokes_AD</a>
      
      <a class="list-group-item" href="../proc/mc_get_stokes_eo.html">MC_get_Stokes_EO</a>
      
      <a class="list-group-item" href="../proc/mc_print_muellermatrix.html">MC_print_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/mc_propagatestokesvector.html">MC_propagateStokesVector</a>
      
      <a class="list-group-item" href="../proc/mc_rotate_muellermatrix.html">MC_rotate_MuellerMatrix</a>
      
      <a class="list-group-item" href="../proc/minfit.html">minfit</a>
      
      <a class="list-group-item" href="../proc/nanchk.html">NANCHK</a>
      
      <a class="list-group-item" href="../proc/ortbak.html">ortbak</a>
      
      <a class="list-group-item" href="../proc/orthes.html">orthes</a>
      
      <a class="list-group-item" href="../proc/ortran.html">ortran</a>
      
      <a class="list-group-item" href="../proc/pgm_write_file.html">PGM_Write_File</a>
      
      <a class="list-group-item" href="../proc/poidev.html">POIDEV</a>
      
      <a class="list-group-item" href="../proc/povray_addcubochoriccube.html">PoVRay_addCubochoricCube</a>
      
      <a class="list-group-item" href="../proc/povray_addcylinder.html">PoVRay_addCylinder</a>
      
      <a class="list-group-item" href="../proc/povray_addeulerbox.html">PoVRay_addEulerBox</a>
      
      <a class="list-group-item" href="../proc/povray_addreferenceframe.html">PoVRay_addReferenceFrame</a>
      
      <a class="list-group-item" href="../proc/povray_addsphere.html">PoVRay_addSphere</a>
      
      <a class="list-group-item" href="../proc/povray_addwireframesphere.html">PoVRay_addWireFrameSphere</a>
      
      <a class="list-group-item" href="../proc/povray_declare_df3file.html">PoVRay_declare_DF3file</a>
      
      <a class="list-group-item" href="../proc/povray_drawfz.html">PoVRay_drawFZ</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz222.html">PoVRay_getpos_FZ222</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz23.html">PoVRay_getpos_FZ23</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz32.html">PoVRay_getpos_FZ32</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz422.html">PoVRay_getpos_FZ422</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz432.html">PoVRay_getpos_FZ432</a>
      
      <a class="list-group-item" href="../proc/povray_getpos_fz622.html">PoVRay_getpos_FZ622</a>
      
      <a class="list-group-item" href="../proc/povray_initfz2.html">PoVRay_initFZ2</a>
      
      <a class="list-group-item" href="../proc/povray_initfz3.html">PoVRay_initFZ3</a>
      
      <a class="list-group-item" href="../proc/povray_initfz4.html">PoVRay_initFZ4</a>
      
      <a class="list-group-item" href="../proc/povray_initfz6.html">PoVRay_initFZ6</a>
      
      <a class="list-group-item" href="../proc/povray_openfile.html">PoVRay_openFile</a>
      
      <a class="list-group-item" href="../proc/povray_setcamera.html">PoVRay_setCamera</a>
      
      <a class="list-group-item" href="../proc/povray_setlightsource.html">PoVRay_setLightSource</a>
      
      <a class="list-group-item" href="../proc/povray_write_df3file.html">PoVRay_write_DF3file</a>
      
      <a class="list-group-item" href="../proc/prelim.html">prelim</a>
      
      <a class="list-group-item" href="../proc/prelim%7E2.html">prelim</a>
      
      <a class="list-group-item" href="../proc/printtime.html">PrintTime</a>
      
      <a class="list-group-item" href="../proc/pythag.html">pythag</a>
      
      <a class="list-group-item" href="../proc/qsortd.html">qsortd</a>
      
      <a class="list-group-item" href="../proc/qzhes.html">qzhes</a>
      
      <a class="list-group-item" href="../proc/qzit.html">qzit</a>
      
      <a class="list-group-item" href="../proc/qzval.html">qzval</a>
      
      <a class="list-group-item" href="../proc/qzvec.html">qzvec</a>
      
      <a class="list-group-item" href="../proc/r8_swap.html">r8_swap</a>
      
      <a class="list-group-item" href="../proc/r8mat_print.html">r8mat_print</a>
      
      <a class="list-group-item" href="../proc/r8mat_print_some.html">r8mat_print_some</a>
      
      <a class="list-group-item" href="../proc/r8vec2_print.html">r8vec2_print</a>
      
      <a class="list-group-item" href="../proc/r8vec_print.html">r8vec_print</a>
      
      <a class="list-group-item" href="../proc/ran.html">ran</a>
      
      <a class="list-group-item" href="../proc/randddmarginal.html">randDDMarginal</a>
      
      <a class="list-group-item" href="../proc/randuniformsphere.html">randUniformSphere</a>
      
      <a class="list-group-item" href="../proc/ratqr.html">ratqr</a>
      
      <a class="list-group-item" href="../proc/read_apb_data.html">read_apb_data</a>
      
      <a class="list-group-item" href="../proc/read_stem_data.html">read_STEM_data</a>
      
      <a class="list-group-item" href="../proc/read_ysh_dislocation_data.html">read_YSH_dislocation_data</a>
      
      <a class="list-group-item" href="../proc/rebak.html">rebak</a>
      
      <a class="list-group-item" href="../proc/rebakb.html">rebakb</a>
      
      <a class="list-group-item" href="../proc/reduc.html">reduc</a>
      
      <a class="list-group-item" href="../proc/reduc2.html">reduc2</a>
      
      <a class="list-group-item" href="../proc/reducedisorientationtomfz.html">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtocubicefz.html">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../proc/reduceorientationtorfz.html">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../proc/rescue.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rescue%7E2.html">rescue</a>
      
      <a class="list-group-item" href="../proc/rg.html">rg</a>
      
      <a class="list-group-item" href="../proc/rgg.html">rgg</a>
      
      <a class="list-group-item" href="../proc/ri1.html">RI1</a>
      
      <a class="list-group-item" href="../proc/ri2.html">RI2</a>
      
      <a class="list-group-item" href="../proc/ricerca_lungo_assi.html">RICERCA_LUNGO_ASSI</a>
      
      <a class="list-group-item" href="../proc/rih1.html">RIH1</a>
      
      <a class="list-group-item" href="../proc/rih2.html">RIH2</a>
      
      <a class="list-group-item" href="../proc/rih3.html">RIH3</a>
      
      <a class="list-group-item" href="../proc/rng_seed.html">rng_seed</a>
      
      <a class="list-group-item" href="../proc/rng_uniform.html">rng_uniform</a>
      
      <a class="list-group-item" href="../proc/rs.html">rs</a>
      
      <a class="list-group-item" href="../proc/rsb.html">rsb</a>
      
      <a class="list-group-item" href="../proc/rsg.html">rsg</a>
      
      <a class="list-group-item" href="../proc/rsgab.html">rsgab</a>
      
      <a class="list-group-item" href="../proc/rsgba.html">rsgba</a>
      
      <a class="list-group-item" href="../proc/rsm.html">rsm</a>
      
      <a class="list-group-item" href="../proc/rsp.html">rsp</a>
      
      <a class="list-group-item" href="../proc/rspp.html">rspp</a>
      
      <a class="list-group-item" href="../proc/rst.html">rst</a>
      
      <a class="list-group-item" href="../proc/rt.html">rt</a>
      
      <a class="list-group-item" href="../proc/sample_cone.html">sample_Cone</a>
      
      <a class="list-group-item" href="../proc/sample_isocube.html">sample_isoCube</a>
      
      <a class="list-group-item" href="../proc/sample_isocubefilled.html">sample_isoCubeFilled</a>
      
      <a class="list-group-item" href="../proc/samplefcctwinrfz.html">SamplefcctwinRFZ</a>
      
      <a class="list-group-item" href="../proc/sampleisomisorientation.html">SampleIsoMisorientation</a>
      
      <a class="list-group-item" href="../proc/samplerfz.html">SampleRFZ</a>
      
      <a class="list-group-item" href="../proc/samplerfztwin.html">SampleRFZtwin</a>
      
      <a class="list-group-item" href="../proc/senzaderglob.html">SENZADERGLOB</a>
      
      <a class="list-group-item" href="../proc/ssort.html">SSORT</a>
      
      <a class="list-group-item" href="../proc/stop.html">STOP</a>
      
      <a class="list-group-item" href="../proc/svd.html">svd</a>
      
      <a class="list-group-item" href="../proc/time_estimate.html">Time_estimate</a>
      
      <a class="list-group-item" href="../proc/time_remaining.html">Time_remaining</a>
      
      <a class="list-group-item" href="../proc/time_report.html">Time_report</a>
      
      <a class="list-group-item" href="../proc/time_reset.html">Time_reset</a>
      
      <a class="list-group-item" href="../proc/time_start.html">Time_start</a>
      
      <a class="list-group-item" href="../proc/time_stop.html">Time_stop</a>
      
      <a class="list-group-item" href="../proc/time_tick.html">Time_tick</a>
      
      <a class="list-group-item" href="../proc/time_tock.html">Time_tock</a>
      
      <a class="list-group-item" href="../proc/timestamp.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/timestamp%7E2.html">timestamp</a>
      
      <a class="list-group-item" href="../proc/tinvit.html">tinvit</a>
      
      <a class="list-group-item" href="../proc/tql1.html">tql1</a>
      
      <a class="list-group-item" href="../proc/tql2.html">tql2</a>
      
      <a class="list-group-item" href="../proc/tqlrat.html">tqlrat</a>
      
      <a class="list-group-item" href="../proc/trbak1.html">trbak1</a>
      
      <a class="list-group-item" href="../proc/trbak3.html">trbak3</a>
      
      <a class="list-group-item" href="../proc/tred1.html">tred1</a>
      
      <a class="list-group-item" href="../proc/tred2.html">tred2</a>
      
      <a class="list-group-item" href="../proc/tred3.html">tred3</a>
      
      <a class="list-group-item" href="../proc/tridib.html">tridib</a>
      
      <a class="list-group-item" href="../proc/trsbox.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/trsbox%7E2.html">trsbox</a>
      
      <a class="list-group-item" href="../proc/tsturm.html">tsturm</a>
      
      <a class="list-group-item" href="../proc/update.html">update</a>
      
      <a class="list-group-item" href="../proc/update%7E2.html">update</a>
      
      <a class="list-group-item" href="../proc/vmfmeandirdensity.html">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/watsonmeandirdensity.html">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../proc/weko.html">WEKO</a>
      
      <a class="list-group-item" href="../proc/yshdisp%7E2.html">YSHDisp</a>
      
      <a class="list-group-item" href="../proc/yshdisp.html">YSHDisp</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Fortran Program was developed by Marc De Graef Research Group/Carnegie Mellon University</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>