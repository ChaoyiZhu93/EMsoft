<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="EMsoft main library">
    
    <meta name="author" content="Marc De Graef Research Group/Carnegie Mellon University" >
    <link rel="icon" href="../favicon.png">

    <title>others.f90 &ndash; Fortran Program</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>others.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 1.7% of total for source files.">531 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/others.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li class="active">others.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/others.html">others</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/others.f90.html#src">others.f90</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-0">All Source Files</a></h3></div>
  <div id="allfiles-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/apb.f90.html">apb.f90</a>
      
      <a class="list-group-item" href="../sourcefile/bobyqa.f90.html">bobyqa.f90</a>
      
      <a class="list-group-item" href="../sourcefile/bobyqa_refinement.f90.html">bobyqa_refinement.f90</a>
      
      <a class="list-group-item" href="../sourcefile/clsupport.f90.html">CLsupport.f90</a>
      
      <a class="list-group-item" href="../sourcefile/constants.f90.html">constants.f90</a>
      
      <a class="list-group-item" href="../sourcefile/defectmodule.f90.html">defectmodule.f90</a>
      
      <a class="list-group-item" href="../sourcefile/dictmod.f90.html">dictmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/dispfield.f90.html">dispfield.f90</a>
      
      <a class="list-group-item" href="../sourcefile/distortion.f90.html">distortion.f90</a>
      
      <a class="list-group-item" href="../sourcefile/eccimod.f90.html">ECCImod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/eispack.f90.html">eispack.f90</a>
      
      <a class="list-group-item" href="../sourcefile/emdymod.f90.html">EMdymod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/filters.f90.html">filters.f90</a>
      
      <a class="list-group-item" href="../sourcefile/hdftest.f90.html">hdftest.f90</a>
      
      <a class="list-group-item" href="../sourcefile/indexingmod.f90.html">Indexingmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/initializers.f90.html">initializers.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jsonsupport.f90.html">JSONsupport.f90</a>
      
      <a class="list-group-item" href="../sourcefile/muellercalculus.f90.html">MuellerCalculus.f90</a>
      
      <a class="list-group-item" href="../sourcefile/multibeams.f90.html">multibeams.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelisthandlers.f90.html">NameListHandlers.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelistjsonwriters.f90.html">NameListJSONwriters.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelisttypedefs.f90.html">NameListTypedefs.f90</a>
      
      <a class="list-group-item" href="../sourcefile/noise.f90.html">noise.f90</a>
      
      <a class="list-group-item" href="../sourcefile/others.f90.html">others.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pedmod.f90.html">PEDmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pfinversion.f90.html">PFInversion.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pgm.f90.html">pgm.f90</a>
      
      <a class="list-group-item" href="../sourcefile/povray.f90.html">povray.f90</a>
      
      <a class="list-group-item" href="../sourcefile/rng.f90.html">rng.f90</a>
      
      <a class="list-group-item" href="../sourcefile/simulated_annealing.f90.html">simulated_annealing.f90</a>
      
      <a class="list-group-item" href="../sourcefile/so3.f90.html">so3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stemmodule.f90.html">STEMmodule.f90</a>
      
      <a class="list-group-item" href="../sourcefile/timing.f90.html">timing.f90</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    <div class="col-md-9" id='text'>
    
    
      
      <h3>Files Dependent On This One</h3>
      
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: sourcefile~~others.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileothersf90AfferentGraph" width="229pt" height="32pt"
 viewBox="0.00 0.00 229.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~others.f90~~AfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~others.f90~~AfferentGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 225,-28 225,4 -4,4"/>
<!-- sourcefile~others.f90 -->
<g id="sourcefile~~others.f90~~AfferentGraph_node1" class="node"><title>sourcefile~others.f90</title>
<polygon fill="none" stroke="black" points="59,-24 0,-24 0,-0 59,-0 59,-24"/>
<text text-anchor="middle" x="29.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">others.f90</text>
</g>
<!-- sourcefile~simulated_annealing.f90 -->
<g id="sourcefile~~others.f90~~AfferentGraph_node2" class="node"><title>sourcefile~simulated_annealing.f90</title>
<g id="a_sourcefile~~others.f90~~AfferentGraph_node2"><a xlink:href="../sourcefile/simulated_annealing.f90.html" xlink:title="simulated_annealing.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="221,-24 95,-24 95,-0 221,-0 221,-24"/>
<text text-anchor="middle" x="158" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">simulated_annealing.f90</text>
</a>
</g>
</g>
<!-- sourcefile~others.f90&#45;&gt;sourcefile~simulated_annealing.f90 -->
<g id="sourcefile~~others.f90~~AfferentGraph_edge1" class="edge"><title>sourcefile~others.f90&#45;&gt;sourcefile~simulated_annealing.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M59.2048,-12C66.9375,-12 75.6639,-12 84.6403,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="84.8415,-15.5001 94.8415,-12 84.8415,-8.5001 84.8415,-15.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="188pt" height="32pt"
 viewBox="0.00 0.00 188.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 184,-28 184,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node"><title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="66,-24 0,-24 0,-0 66,-0 66,-24"/>
<text text-anchor="middle" x="33" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="180,-24 84,-24 84,-0 180,-0 180,-24"/>
<text text-anchor="middle" x="132" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which depends upon it. A file 
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      






<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/others.html">others</a>
      
    </div>
  </div>
</div>















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/others.f90.html#src">others.f90</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">! ###################################################################</span>
<a name="ln-2"></a><span class="c">! Copyright (c) 2014, Marc De Graef/Carnegie Mellon University</span>
<a name="ln-3"></a><span class="c">! All rights reserved.</span>
<a name="ln-4"></a><span class="c">!</span>
<a name="ln-5"></a><span class="c">! Redistribution and use in source and binary forms, with or without modification, are </span>
<a name="ln-6"></a><span class="c">! permitted provided that the following conditions are met:</span>
<a name="ln-7"></a><span class="c">!</span>
<a name="ln-8"></a><span class="c">!     - Redistributions of source code must retain the above copyright notice, this list </span>
<a name="ln-9"></a><span class="c">!        of conditions and the following disclaimer.</span>
<a name="ln-10"></a><span class="c">!     - Redistributions in binary form must reproduce the above copyright notice, this </span>
<a name="ln-11"></a><span class="c">!        list of conditions and the following disclaimer in the documentation and/or </span>
<a name="ln-12"></a><span class="c">!        other materials provided with the distribution.</span>
<a name="ln-13"></a><span class="c">!     - Neither the names of Marc De Graef, Carnegie Mellon University nor the names </span>
<a name="ln-14"></a><span class="c">!        of its contributors may be used to endorse or promote products derived from </span>
<a name="ln-15"></a><span class="c">!        this software without specific prior written permission.</span>
<a name="ln-16"></a><span class="c">!</span>
<a name="ln-17"></a><span class="c">! THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; </span>
<a name="ln-18"></a><span class="c">! AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE </span>
<a name="ln-19"></a><span class="c">! IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE </span>
<a name="ln-20"></a><span class="c">! ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE </span>
<a name="ln-21"></a><span class="c">! LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL </span>
<a name="ln-22"></a><span class="c">! DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR </span>
<a name="ln-23"></a><span class="c">! SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER </span>
<a name="ln-24"></a><span class="c">! CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, </span>
<a name="ln-25"></a><span class="c">! OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE </span>
<a name="ln-26"></a><span class="c">! USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="ln-27"></a><span class="c">! ###################################################################</span>
<a name="ln-28"></a>
<a name="ln-29"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-30"></a><span class="c">! EMsoft:others.f90</span>
<a name="ln-31"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-32"></a><span class="c">!</span>
<a name="ln-33"></a><span class="c">! MODULE: others</span>
<a name="ln-34"></a><span class="c">!</span>
<a name="ln-35"></a><span class="c">!&gt; @author Marc De Graef, Carnegie Mellon University / and others</span>
<a name="ln-36"></a><span class="c">!</span>
<a name="ln-37"></a><span class="c">!&gt; @brief routines written by other people, included with permission, and adapted by MDG</span>
<a name="ln-38"></a><span class="c">!</span>
<a name="ln-39"></a><span class="c">!&gt; @details  This is the Weickenmeier-Kohl implementation of their scattering factors</span>
<a name="ln-40"></a><span class="c">!&gt;  and absorptive form factors; it is included with permission from H. Kohl.</span>
<a name="ln-41"></a><span class="c">!</span>
<a name="ln-42"></a><span class="c">!&gt; @note This code was originally f77, and was converted to f90 by MDG [5/22/01];</span>
<a name="ln-43"></a><span class="c">!&gt; core functionality is unchanged from the f77 version, but the output statements</span>
<a name="ln-44"></a><span class="c">!&gt; were adapted to the current EMsoft package standard.</span>
<a name="ln-45"></a><span class="c">! </span>
<a name="ln-46"></a><span class="c">!&gt; @date   10/13/98 MDG 1.0 original</span>
<a name="ln-47"></a><span class="c">!&gt; @date    5/22/01 MDG 2.0 f90</span>
<a name="ln-48"></a><span class="c">!&gt; @date   11/27/01 MDG 2.1 added kind support</span>
<a name="ln-49"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-50"></a><span class="k">module </span><span class="n">others</span>
<a name="ln-51"></a>
<a name="ln-52"></a><span class="k">use </span><span class="n">local</span>
<a name="ln-53"></a>
<a name="ln-54"></a><span class="k">contains</span>
<a name="ln-55"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-56"></a><span class="c">!</span>
<a name="ln-57"></a><span class="c">! SUBROUTINE: fscatt</span>
<a name="ln-58"></a><span class="c">!</span>
<a name="ln-59"></a><span class="c">!&gt; @author Marc De Graef, Carnegie Mellon University</span>
<a name="ln-60"></a><span class="c">!&gt; @author A. Weickenmeier, original f77 code</span>
<a name="ln-61"></a><span class="c">!</span>
<a name="ln-62"></a><span class="c">!&gt; @brief computes the complex scattering amplitude</span>
<a name="ln-63"></a><span class="c">!</span>
<a name="ln-64"></a><span class="c">!&gt; @details &#39;use&#39;s error and local modules; Weickenmeier&#39;s original comments</span>
<a name="ln-65"></a><span class="c">!&gt; and notes are left unchanged in the source code.</span>
<a name="ln-66"></a><span class="c">! </span>
<a name="ln-67"></a><span class="c">!&gt; @date 5/21/01 MDG 1.0 original f90 translation</span>
<a name="ln-68"></a><span class="c">!&gt; @date 3/21/13 MDG 2.0 updated IO statements</span>
<a name="ln-69"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-70"></a><span class="kt">complex </span><span class="k">recursive FUNCTION </span><span class="n">FSCATT</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">ACCVLT</span><span class="p">,</span><span class="n">ABSFLG</span><span class="p">,</span><span class="n">ACCFLG</span><span class="p">,</span><span class="n">DWFLG</span><span class="p">)</span>
<a name="ln-71"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: FSCATT</span>
<a name="ln-72"></a>
<a name="ln-73"></a><span class="c">! modified: 08.07.93  ! more precise fit to doyle turner table</span>
<a name="ln-74"></a><span class="c">! modified: 04.03.93  ! expansion in phonon abs. for small g</span>
<a name="ln-75"></a><span class="c">! </span>
<a name="ln-76"></a><span class="c">! Author:</span>
<a name="ln-77"></a><span class="c">! A.Weickenmeier</span>
<a name="ln-78"></a><span class="c">! Technische Hochschule Darmstadt</span>
<a name="ln-79"></a><span class="c">! Hochschulstr. 6</span>
<a name="ln-80"></a><span class="c">! D-6100 Darmstadt</span>
<a name="ln-81"></a><span class="c">! Germany </span>
<a name="ln-82"></a><span class="c">! bitnet: XLTODA6L@DDATHD21.BITNET</span>
<a name="ln-83"></a><span class="c">! Tel.: 06151/16-3381</span>
<a name="ln-84"></a><span class="c">!</span>
<a name="ln-85"></a><span class="c">! CALCULATES THE COMPLEX SCATTERING AMPLITUDE </span>
<a name="ln-86"></a><span class="c">! </span>
<a name="ln-87"></a><span class="c">! </span>
<a name="ln-88"></a><span class="c">! INPUT:</span>
<a name="ln-89"></a><span class="c">! ======</span>
<a name="ln-90"></a><span class="c">!</span>
<a name="ln-91"></a><span class="c">! G     :   SCATTERING VECTOR G/(4*PI) = S = SIN(THETA)/LAMBDA</span>
<a name="ln-92"></a><span class="c">! UL    : THE RMS THERMAL DISPLACEMENT OF THE ATOM </span>
<a name="ln-93"></a><span class="c">! Z     : ATOM</span>
<a name="ln-94"></a><span class="c">! ACCVLT: ACCELERATION VOLTAGE IN KV</span>
<a name="ln-95"></a><span class="c">!   NOT REQUIRED IF ACCFLG = .FALSE.</span>
<a name="ln-96"></a><span class="c">! ABSFLG: =0 NO ABSORPTION</span>
<a name="ln-97"></a><span class="c">!         =1 ONLY PHONON</span>
<a name="ln-98"></a><span class="c">!         =2 ONLY CORE</span>
<a name="ln-99"></a><span class="c">!         =3 PHONON + CORE</span>
<a name="ln-100"></a><span class="c">! ACCFLG: IF TRUE THEN F DEPENDS ON THE ACCELERATION VOLTAGE</span>
<a name="ln-101"></a><span class="c">!         IF FALSE REAL(F) MUST BE MULTIPLIED BY GAMMA,</span>
<a name="ln-102"></a><span class="c">!         IMAG(F) BY GAMMA^2/K0</span>
<a name="ln-103"></a><span class="c">!  NOTICE: CORE-CONTRIBUTION TO ABSORPTION DEPENDS ON </span>
<a name="ln-104"></a><span class="c">!          ACCELERATION VOLTAGE</span>
<a name="ln-105"></a><span class="c">!          THEREFORE IF ABSFLG &gt;=1 </span>
<a name="ln-106"></a><span class="c">!          THEN ACCFLG SHOULD BE .TRUE.</span>
<a name="ln-107"></a><span class="c">! DWFLG : IF TRUE REAL(F) WILL BE MULTIPLIED WITH THE </span>
<a name="ln-108"></a><span class="c">!         DEBYE-WALLER FACTOR</span>
<a name="ln-109"></a><span class="c">!</span>
<a name="ln-110"></a><span class="c">! OUTPUT:</span>
<a name="ln-111"></a><span class="c">! =======</span>
<a name="ln-112"></a><span class="c">!</span>
<a name="ln-113"></a><span class="c">! FSCATT: COMPLEX SCATTERING AMPLITUDE</span>
<a name="ln-114"></a><span class="c">! SYMBOL: SYMBOL OF THE ELEMENT Z</span>
<a name="ln-115"></a><span class="c">!</span>
<a name="ln-116"></a><span class="c">! UNITS:</span>
<a name="ln-117"></a><span class="c">! ======</span>
<a name="ln-118"></a><span class="c">!</span>
<a name="ln-119"></a><span class="c">! UNIT OF LENGTH IS ANGSTROEM</span>
<a name="ln-120"></a><span class="c">! </span>
<a name="ln-121"></a><span class="c">! NOTE:</span>
<a name="ln-122"></a><span class="c">! =====</span>
<a name="ln-123"></a><span class="c">! </span>
<a name="ln-124"></a><span class="c">! THE SCATTERING AMPLITUDES ARE MULTIPLIED BY AN ADDITIONAL </span>
<a name="ln-125"></a><span class="c">! FACTOR 4PI.</span>
<a name="ln-126"></a><span class="c">! </span>
<a name="ln-127"></a><span class="c">!**************************************************************************</span>
<a name="ln-128"></a>
<a name="ln-129"></a><span class="k">use </span><span class="n">error</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span>     	<span class="kd">::</span> <span class="n">FOURPI</span><span class="o">=</span><span class="mi">1</span><span class="mf">2.56637062</span>
<a name="ln-132"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>               	<span class="kd">::</span> <span class="n">K0</span><span class="p">,</span><span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">B</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-133"></a><span class="kt">integer</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">irg</span><span class="p">)</span>            	<span class="kd">::</span> <span class="n">ABSFLG</span><span class="p">,</span><span class="n">Z</span>
<a name="ln-134"></a><span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                 	<span class="kd">::</span> <span class="n">SYMBOL</span>
<a name="ln-135"></a><span class="kt">logical</span>                      	<span class="kd">::</span> <span class="n">ACCFLG</span><span class="p">,</span><span class="n">DWFLG</span>
<a name="ln-136"></a>
<a name="ln-137"></a><span class="c">! CHECK INPUT</span>
<a name="ln-138"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">Z</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span> <span class="p">.</span><span class="nb">OR</span><span class="p">.</span> <span class="n">Z</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">98</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;fscatt&#39;</span><span class="p">,</span><span class="s1">&#39; Z is out of range&#39;</span><span class="p">)</span>
<a name="ln-139"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">UL</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;fscatt&#39;</span><span class="p">,</span><span class="s1">&#39; UL must be positive&#39;</span><span class="p">)</span>
<a name="ln-140"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">G</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;fscatt&#39;</span><span class="p">,</span><span class="s1">&#39; G must be positive&#39;</span><span class="p">)</span>
<a name="ln-141"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ACCVLT</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;fscatt&#39;</span><span class="p">,</span><span class="s1">&#39; ACCVLT must be positive&#39;</span><span class="p">)</span>
<a name="ln-142"></a>
<a name="ln-143"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">DWFLG</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-144"></a><span class="c">!    CALCULATE DEBYE-WALLER FACTOR</span>
<a name="ln-145"></a>  <span class="n">DEWA</span>  <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">UL</span><span class="o">*</span><span class="n">UL</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="p">)</span>
<a name="ln-146"></a> <span class="k">ELSE</span>
<a name="ln-147"></a><span class="k">  </span><span class="n">DEWA</span> <span class="o">=</span> <span class="mf">1.</span>
<a name="ln-148"></a> <span class="k">END IF</span>
<a name="ln-149"></a>
<a name="ln-150"></a><span class="c">! GET FITTING COEFFICIENTS</span>
<a name="ln-151"></a> <span class="k">CALL </span><span class="n">GETWK</span> <span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<a name="ln-152"></a>
<a name="ln-153"></a> <span class="n">S</span>      <span class="o">=</span> <span class="n">G</span> <span class="o">/</span> <span class="n">FOURPI</span>
<a name="ln-154"></a> <span class="n">FREAL</span>  <span class="o">=</span> <span class="n">FOURPI</span> <span class="o">*</span> <span class="n">DEWA</span> <span class="o">*</span> <span class="n">WEKO</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">)</span>
<a name="ln-155"></a>
<a name="ln-156"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ABSFLG</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-157"></a><span class="k">  </span><span class="n">FIMA</span>   <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-158"></a> <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ABSFLG</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-159"></a><span class="k">       </span><span class="n">FIMA</span>   <span class="o">=</span> <span class="n">FPHON</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> 
<a name="ln-160"></a>      <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ABSFLG</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-161"></a><span class="k">            </span><span class="n">FIMA</span>   <span class="o">=</span> <span class="n">FCORE</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ACCVLT</span><span class="p">)</span> <span class="o">*</span> <span class="n">DEWA</span>
<a name="ln-162"></a>            <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ABSFLG</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-163"></a><span class="k">                  </span><span class="n">FIMA</span>   <span class="o">=</span> <span class="n">FCORE</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ACCVLT</span><span class="p">)</span> <span class="o">*</span> <span class="n">DEWA</span> <span class="o">+</span> <span class="n">FPHON</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span> 
<a name="ln-164"></a> <span class="k">END IF</span>
<a name="ln-165"></a>
<a name="ln-166"></a><span class="k"> IF</span> <span class="p">(</span><span class="n">ACCFLG</span><span class="p">.</span><span class="n">EQV</span><span class="p">..</span><span class="n">TRUE</span><span class="p">.)</span> <span class="k">THEN</span>
<a name="ln-167"></a><span class="c">!    CALCULATE WAVENUMBER AND GAMMA</span>
<a name="ln-168"></a>  <span class="n">K0</span>   <span class="o">=</span> <span class="p">.</span><span class="mi">5068</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mi">102</span><span class="mf">2.</span><span class="o">*</span><span class="n">ACCVLT</span> <span class="o">+</span> <span class="n">ACCVLT</span><span class="o">*</span><span class="n">ACCVLT</span><span class="p">)</span>
<a name="ln-169"></a>  <span class="nb">GAMMA</span> <span class="o">=</span> <span class="p">(</span><span class="n">ACCVLT</span><span class="o">+</span><span class="mi">51</span><span class="mf">1.</span><span class="p">)</span> <span class="o">/</span> <span class="mi">51</span><span class="mf">1.</span>
<a name="ln-170"></a>  <span class="n">FREAL</span> <span class="o">=</span> <span class="n">FREAL</span> <span class="o">*</span> <span class="nb">GAMMA</span>
<a name="ln-171"></a><span class="nb">  </span><span class="n">FIMA</span>  <span class="o">=</span> <span class="n">FIMA</span>  <span class="o">*</span> <span class="nb">GAMMA</span> <span class="o">*</span> <span class="nb">GAMMA</span> <span class="o">/</span> <span class="n">K0</span>
<a name="ln-172"></a> <span class="k">END IF</span>
<a name="ln-173"></a>
<a name="ln-174"></a><span class="k"> </span><span class="n">FSCATT</span> <span class="o">=</span> <span class="nb">CMPLX</span><span class="p">(</span> <span class="n">FREAL</span><span class="p">,</span><span class="n">FIMA</span> <span class="p">)</span>
<a name="ln-175"></a>
<a name="ln-176"></a><span class="k">END FUNCTION</span>
<a name="ln-177"></a>
<a name="ln-178"></a><span class="c">!*******************************************************************</span>
<a name="ln-179"></a>
<a name="ln-180"></a><span class="k">FUNCTION </span><span class="n">WEKO</span> <span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">S</span><span class="p">)</span>
<a name="ln-181"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: WEKO</span>
<a name="ln-182"></a>
<a name="ln-183"></a><span class="c">! ELECTRON SCATTERING AMPLITUDE F(S)</span>
<a name="ln-184"></a>
<a name="ln-185"></a><span class="c">! UPDATE 07.07.93</span>
<a name="ln-186"></a><span class="c">! NOW 4 A AND 4 B</span>
<a name="ln-187"></a>
<a name="ln-188"></a>
<a name="ln-189"></a><span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">B</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-190"></a>
<a name="ln-191"></a> <span class="n">WEKO</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-192"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">S</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-193"></a><span class="k">    </span><span class="n">S2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">S</span><span class="o">*</span><span class="n">S</span><span class="p">)</span>
<a name="ln-194"></a> <span class="k">END IF</span>
<a name="ln-195"></a>
<a name="ln-196"></a><span class="k"> DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-197"></a>  <span class="n">ARGU</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">S</span><span class="o">*</span><span class="n">S</span>
<a name="ln-198"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">ARGU</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-199"></a><span class="k">   </span><span class="n">WEKO</span> <span class="o">=</span> <span class="n">WEKO</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">ARGU</span><span class="p">)</span>
<a name="ln-200"></a>  <span class="k">ELSE IF</span> <span class="p">(</span><span class="n">ARGU</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-201"></a><span class="k">        </span><span class="n">WEKO</span> <span class="o">=</span> <span class="n">WEKO</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">S2</span>
<a name="ln-202"></a>       <span class="k">ELSE</span>
<a name="ln-203"></a><span class="k">        </span><span class="n">WEKO</span> <span class="o">=</span> <span class="n">WEKO</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">-</span><span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">ARGU</span><span class="p">))</span><span class="o">*</span><span class="n">S2</span>
<a name="ln-204"></a>  <span class="k">END IF</span>
<a name="ln-205"></a><span class="k"> END DO</span>
<a name="ln-206"></a><span class="k">END FUNCTION</span>
<a name="ln-207"></a>
<a name="ln-208"></a><span class="c">! ***************************************************************</span>
<a name="ln-209"></a>
<a name="ln-210"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">FPHON</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<a name="ln-211"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: FPHON</span>
<a name="ln-212"></a>
<a name="ln-213"></a>
<a name="ln-214"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">FOURPI</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">2.56636</span><span class="p">,</span> <span class="n">FP2</span><span class="o">=</span> <span class="n">FOURPI</span><span class="o">*</span><span class="n">FOURPI</span>
<a name="ln-215"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">B</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">A1</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-216"></a>
<a name="ln-217"></a> <span class="n">U2</span> <span class="o">=</span> <span class="n">UL</span><span class="o">*</span><span class="n">UL</span>
<a name="ln-218"></a>
<a name="ln-219"></a> <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-220"></a>  <span class="n">A1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">*</span> <span class="n">FP2</span> 
<a name="ln-221"></a> <span class="k">END DO</span>
<a name="ln-222"></a><span class="k"> DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-223"></a>  <span class="n">B1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">/</span> <span class="n">FP2</span>
<a name="ln-224"></a> <span class="k">END DO</span>
<a name="ln-225"></a><span class="k"> </span>
<a name="ln-226"></a><span class="k"> </span><span class="n">FPHON</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-227"></a> <span class="n">G2</span>    <span class="o">=</span> <span class="n">G</span><span class="o">*</span><span class="n">G</span>
<a name="ln-228"></a> <span class="n">DEWA</span>  <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span><span class="p">)</span>
<a name="ln-229"></a>
<a name="ln-230"></a> <span class="k">DO </span><span class="n">J</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-231"></a>  <span class="n">FPHON</span> <span class="o">=</span> <span class="n">FPHON</span> <span class="o">+</span> <span class="n">A1</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DEWA</span> <span class="o">*</span> <span class="n">RI1</span><span class="p">(</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">G</span><span class="p">)</span> <span class="o">-</span> <span class="n">RI2</span><span class="p">(</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">))</span>
<a name="ln-232"></a>  <span class="k">DO </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-233"></a>   <span class="n">FPHON</span> <span class="o">=</span> <span class="n">FPHON</span> <span class="o">+</span> <span class="mf">2.</span><span class="o">*</span><span class="n">A1</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">DEWA</span> <span class="o">*</span> <span class="n">RI1</span><span class="p">(</span><span class="n">B1</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">G</span><span class="p">)</span><span class="o">-</span><span class="n">RI2</span><span class="p">(</span><span class="n">B1</span><span class="p">(</span><span class="n">I</span><span class="p">),</span><span class="n">B1</span><span class="p">(</span><span class="n">J</span><span class="p">),</span><span class="n">G</span><span class="p">,</span><span class="n">UL</span><span class="p">))</span>
<a name="ln-234"></a>  <span class="k">END DO</span>
<a name="ln-235"></a><span class="k"> END DO</span>
<a name="ln-236"></a><span class="k">END FUNCTION</span>
<a name="ln-237"></a>
<a name="ln-238"></a><span class="c">!*****************************************************************</span>
<a name="ln-239"></a>
<a name="ln-240"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">RI1</span> <span class="p">(</span><span class="n">BI</span><span class="p">,</span><span class="n">BJ</span><span class="p">,</span><span class="n">G</span><span class="p">)</span>
<a name="ln-241"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: RI1</span>
<a name="ln-242"></a>
<a name="ln-243"></a><span class="c">! ERSTES INTEGRAL FUER DIE ABSORPTIONSPOTENTIALE</span>
<a name="ln-244"></a>
<a name="ln-245"></a>
<a name="ln-246"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">PI</span><span class="o">=</span><span class="mf">3.1415927</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span><span class="mf">0.5772157</span>
<a name="ln-247"></a>
<a name="ln-248"></a>
<a name="ln-249"></a> <span class="n">G2</span>   <span class="o">=</span> <span class="n">G</span><span class="o">*</span><span class="n">G</span>
<a name="ln-250"></a>
<a name="ln-251"></a><span class="c">! IST DIE ASYMPTOTISCHE ENTWICKLUNG ANWENDBAR?</span>
<a name="ln-252"></a>
<a name="ln-253"></a> <span class="n">EPS</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="n">BI</span><span class="p">,</span><span class="n">BJ</span> <span class="p">)</span>
<a name="ln-254"></a> <span class="n">EPS</span> <span class="o">=</span> <span class="n">EPS</span> <span class="o">*</span> <span class="n">G2</span>
<a name="ln-255"></a>
<a name="ln-256"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">EPS</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-257"></a><span class="k">  </span><span class="n">RI1</span> <span class="o">=</span> <span class="n">BI</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span><span class="o">/</span><span class="n">BI</span> <span class="p">)</span> <span class="o">+</span> <span class="n">BJ</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span><span class="o">/</span><span class="n">BJ</span> <span class="p">)</span>
<a name="ln-258"></a>  <span class="n">RI1</span> <span class="o">=</span> <span class="n">RI1</span> <span class="o">*</span> <span class="n">PI</span>
<a name="ln-259"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">G</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-260"></a><span class="k">  </span><span class="n">BI2</span> <span class="o">=</span> <span class="n">BI</span><span class="o">*</span><span class="n">BI</span>
<a name="ln-261"></a>  <span class="n">BJ2</span> <span class="o">=</span> <span class="n">BJ</span><span class="o">*</span><span class="n">BJ</span>
<a name="ln-262"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">BI2</span><span class="o">*</span><span class="nb">LOG</span><span class="p">(</span> <span class="n">BI</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">BJ2</span><span class="o">*</span><span class="nb">LOG</span><span class="p">(</span> <span class="n">BJ</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-263"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">+</span> <span class="p">.</span><span class="mi">75</span> <span class="o">*</span> <span class="p">(</span><span class="n">BI2</span><span class="o">+</span><span class="n">BJ2</span><span class="p">)</span> <span class="o">-</span> <span class="p">.</span><span class="mi">25</span> <span class="o">*</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span>
<a name="ln-264"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">-</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="n">BI</span><span class="o">-</span><span class="n">BJ</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">BI</span><span class="o">-</span><span class="n">BJ</span><span class="p">)</span>
<a name="ln-265"></a>  <span class="n">RI1</span>  <span class="o">=</span> <span class="n">RI1</span> <span class="o">+</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">G2</span> <span class="o">*</span> <span class="n">TEMP</span>
<a name="ln-266"></a>  <span class="k">RETURN</span>
<a name="ln-267"></a><span class="k"> END IF</span>
<a name="ln-268"></a>
<a name="ln-269"></a><span class="k"> </span><span class="n">BIG2</span> <span class="o">=</span> <span class="n">BI</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-270"></a> <span class="n">BJG2</span> <span class="o">=</span> <span class="n">BJ</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-271"></a> <span class="n">RI1</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">BIG2</span><span class="p">)</span> <span class="o">+</span> <span class="nb">LOG</span><span class="p">(</span><span class="n">BJG2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">EI</span><span class="p">(</span><span class="o">-</span><span class="n">BI</span><span class="o">*</span><span class="n">BJ</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">))</span>
<a name="ln-272"></a>
<a name="ln-273"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="n">BIG2</span>
<a name="ln-274"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="n">BIG2</span><span class="o">*</span><span class="n">BI</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span>
<a name="ln-275"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="n">BIG2</span>
<a name="ln-276"></a> <span class="n">RI1</span> <span class="o">=</span> <span class="n">RI1</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-277"></a>
<a name="ln-278"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="n">BJG2</span>
<a name="ln-279"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="n">BJG2</span><span class="o">*</span><span class="n">BJ</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="p">)</span>
<a name="ln-280"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="n">BJG2</span>
<a name="ln-281"></a> <span class="n">RI1</span> <span class="o">=</span> <span class="n">RI1</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-282"></a> <span class="n">RI1</span> <span class="o">=</span> <span class="n">RI1</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">/</span> <span class="n">G2</span>
<a name="ln-283"></a>
<a name="ln-284"></a><span class="k">END FUNCTION</span>
<a name="ln-285"></a>
<a name="ln-286"></a><span class="c">!**************************************************************************</span>
<a name="ln-287"></a>
<a name="ln-288"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">RI2</span> <span class="p">(</span><span class="n">BI</span><span class="p">,</span><span class="n">BJ</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">U</span><span class="p">)</span>
<a name="ln-289"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: RI2</span>
<a name="ln-290"></a>
<a name="ln-291"></a><span class="c">! ZWEITES INTEGRAL FUER DIE ABSORPTIONSPOTENTIALE</span>
<a name="ln-292"></a>
<a name="ln-293"></a>
<a name="ln-294"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">PI</span><span class="o">=</span><span class="mf">3.1415927</span>
<a name="ln-295"></a>
<a name="ln-296"></a> <span class="n">U2</span> <span class="o">=</span> <span class="n">U</span><span class="o">*</span><span class="n">U</span>
<a name="ln-297"></a> <span class="n">U22</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span>
<a name="ln-298"></a> <span class="n">G2</span>   <span class="o">=</span> <span class="n">G</span><span class="o">*</span><span class="n">G</span>
<a name="ln-299"></a> <span class="n">BIUH</span> <span class="o">=</span> <span class="n">BI</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span>
<a name="ln-300"></a> <span class="n">BJUH</span> <span class="o">=</span> <span class="n">BJ</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span>
<a name="ln-301"></a> <span class="n">BIU</span>  <span class="o">=</span> <span class="n">BI</span> <span class="o">+</span> <span class="n">U2</span>
<a name="ln-302"></a> <span class="n">BJU</span>  <span class="o">=</span> <span class="n">BJ</span> <span class="o">+</span> <span class="n">U2</span>
<a name="ln-303"></a>
<a name="ln-304"></a><span class="c">! IST DIE ASYMPTOTISCHE ENTWICKLUNG ANWENDBAR?</span>
<a name="ln-305"></a> <span class="n">EPS</span> <span class="o">=</span> <span class="nb">MAX</span><span class="p">(</span> <span class="n">BI</span><span class="p">,</span><span class="n">BJ</span><span class="p">,</span><span class="n">U2</span> <span class="p">)</span>
<a name="ln-306"></a> <span class="n">EPS</span> <span class="o">=</span> <span class="n">EPS</span> <span class="o">*</span> <span class="n">G2</span>
<a name="ln-307"></a>
<a name="ln-308"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">EPS</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-309"></a><span class="k">  </span><span class="n">RI2</span> <span class="o">=</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-310"></a>  <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">BJ</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="p">(</span><span class="n">BI</span><span class="o">+</span><span class="n">BJ</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BJ</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-311"></a>  <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">U2</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="n">U2</span><span class="o">/</span><span class="p">(</span><span class="n">BJ</span><span class="o">+</span><span class="n">U2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-312"></a>  <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">*</span> <span class="n">PI</span>
<a name="ln-313"></a>  <span class="k">IF</span> <span class="p">(</span><span class="n">G</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mf">0.</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-314"></a><span class="k">  </span><span class="n">TEMP</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">U22</span> <span class="o">*</span> <span class="n">U22</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="n">BIU</span><span class="o">*</span><span class="n">BJU</span><span class="o">/</span><span class="p">(</span><span class="n">U2</span><span class="o">*</span><span class="n">U2</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-315"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">BIUH</span> <span class="o">*</span> <span class="n">BIUH</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="n">BIU</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span> <span class="p">)</span> 
<a name="ln-316"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">BJUH</span> <span class="o">*</span> <span class="n">BJUH</span> <span class="o">*</span> <span class="nb">LOG</span><span class="p">(</span> <span class="n">BJU</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span> <span class="p">)</span> 
<a name="ln-317"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">+</span> <span class="p">.</span><span class="mi">25</span> <span class="o">*</span> <span class="n">BIU</span> <span class="o">*</span> <span class="n">BIU</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">BI</span> <span class="o">*</span> <span class="n">BI</span>
<a name="ln-318"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">+</span> <span class="p">.</span><span class="mi">25</span> <span class="o">*</span> <span class="n">BJU</span> <span class="o">*</span> <span class="n">BJU</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="n">BJ</span> <span class="o">*</span> <span class="n">BJ</span>
<a name="ln-319"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">-</span> <span class="p">.</span><span class="mi">25</span> <span class="o">*</span> <span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span>
<a name="ln-320"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">-</span> <span class="p">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span> <span class="p">(</span><span class="n">BI</span><span class="o">*</span><span class="n">BIU</span><span class="o">-</span><span class="n">BJ</span><span class="o">*</span><span class="n">BJU</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span> <span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<a name="ln-321"></a>  <span class="n">TEMP</span> <span class="o">=</span> <span class="n">TEMP</span> <span class="o">-</span> <span class="n">U22</span><span class="o">*</span><span class="n">U22</span>
<a name="ln-322"></a>  <span class="n">RI2</span>  <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">PI</span> <span class="o">*</span> <span class="n">G2</span> <span class="o">*</span> <span class="n">TEMP</span>
<a name="ln-323"></a>  <span class="k">RETURN</span>
<a name="ln-324"></a><span class="k"> END IF</span>
<a name="ln-325"></a>
<a name="ln-326"></a><span class="k"> </span><span class="n">RI2</span> <span class="o">=</span> <span class="n">EI</span><span class="p">(</span> <span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span><span class="o">*</span><span class="n">BIUH</span><span class="o">/</span><span class="n">BIU</span> <span class="p">)</span> <span class="o">+</span> <span class="n">EI</span><span class="p">(</span> <span class="o">-</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span><span class="o">*</span><span class="n">BJUH</span><span class="o">/</span><span class="n">BJU</span> <span class="p">)</span>
<a name="ln-327"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">-</span> <span class="n">EI</span><span class="p">(</span> <span class="o">-</span><span class="n">BIUH</span><span class="o">*</span><span class="n">BJUH</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="n">EI</span><span class="p">(</span> <span class="o">-</span><span class="p">.</span><span class="mi">25</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span> <span class="p">)</span>
<a name="ln-328"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">RI2</span>
<a name="ln-329"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-330"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">25</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-331"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">25</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="n">BIU</span>
<a name="ln-332"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-333"></a>
<a name="ln-334"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-335"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">25</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-336"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="p">.</span><span class="mi">25</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">U2</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="n">BJU</span>
<a name="ln-337"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-338"></a>
<a name="ln-339"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="n">BIUH</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-340"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="n">BIUH</span><span class="o">*</span><span class="n">BIUH</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span>
<a name="ln-341"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="n">BIUH</span><span class="o">*</span><span class="n">BIUH</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="n">BIU</span>
<a name="ln-342"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-343"></a>
<a name="ln-344"></a> <span class="n">X1</span>  <span class="o">=</span> <span class="n">BJUH</span><span class="o">*</span><span class="n">G2</span>
<a name="ln-345"></a> <span class="n">X2</span>  <span class="o">=</span> <span class="n">BJUH</span><span class="o">*</span><span class="n">BJUH</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="p">(</span><span class="n">BIUH</span><span class="o">+</span><span class="n">BJUH</span><span class="p">)</span>
<a name="ln-346"></a> <span class="n">X3</span>  <span class="o">=</span> <span class="n">BJUH</span><span class="o">*</span><span class="n">BJUH</span><span class="o">*</span><span class="n">G2</span><span class="o">/</span><span class="n">BJU</span>
<a name="ln-347"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">+</span> <span class="n">RIH1</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-348"></a>
<a name="ln-349"></a> <span class="n">RI2</span> <span class="o">=</span> <span class="n">RI2</span> <span class="o">*</span> <span class="n">PI</span> <span class="o">/</span> <span class="n">G2</span>
<a name="ln-350"></a>
<a name="ln-351"></a><span class="k">END FUNCTION</span>
<a name="ln-352"></a>
<a name="ln-353"></a><span class="c">!**************************************************************************</span>
<a name="ln-354"></a>
<a name="ln-355"></a><span class="kt">real  </span><span class="k">FUNCTION </span><span class="n">RIH1</span> <span class="p">(</span><span class="n">X1</span><span class="p">,</span><span class="n">X2</span><span class="p">,</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-356"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: RIH1</span>
<a name="ln-357"></a>
<a name="ln-358"></a><span class="c">! WERTET DEN AUSDRUCK EXP(-X1) * ( EI(X2)-EI(X3) ) AUS</span>
<a name="ln-359"></a>
<a name="ln-360"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">X2</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.</span>  <span class="p">.</span><span class="nb">AND</span><span class="p">.</span>  <span class="n">X3</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-361"></a><span class="k">  </span><span class="n">RIH1</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">EI</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span><span class="o">-</span><span class="n">EI</span><span class="p">(</span><span class="n">X3</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-362"></a>  <span class="k">RETURN</span>
<a name="ln-363"></a><span class="k"> END IF</span>
<a name="ln-364"></a>
<a name="ln-365"></a><span class="k"> IF</span> <span class="p">(</span><span class="n">X2</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">20</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-366"></a><span class="k">  </span><span class="n">RIH1</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">X2</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span><span class="o">*</span><span class="n">RIH2</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span><span class="o">/</span><span class="n">X2</span>
<a name="ln-367"></a> <span class="k">ELSE </span>
<a name="ln-368"></a><span class="k">  </span><span class="n">RIH1</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span><span class="o">*</span><span class="n">EI</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
<a name="ln-369"></a> <span class="k">END IF</span>
<a name="ln-370"></a>
<a name="ln-371"></a><span class="k"> IF</span> <span class="p">(</span><span class="n">X3</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">20</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-372"></a><span class="k">  </span><span class="n">RIH1</span> <span class="o">=</span> <span class="n">RIH1</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="n">X3</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span><span class="o">*</span><span class="n">RIH2</span><span class="p">(</span><span class="n">X3</span><span class="p">)</span><span class="o">/</span><span class="n">X3</span>
<a name="ln-373"></a> <span class="k">ELSE </span>
<a name="ln-374"></a><span class="k">  </span><span class="n">RIH1</span> <span class="o">=</span> <span class="n">RIH1</span> <span class="o">-</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">X1</span><span class="p">)</span><span class="o">*</span><span class="n">EI</span><span class="p">(</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-375"></a> <span class="k">END IF</span>
<a name="ln-376"></a><span class="k">END FUNCTION</span>
<a name="ln-377"></a>
<a name="ln-378"></a><span class="c">!**************************************************************************</span>
<a name="ln-379"></a>
<a name="ln-380"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">RIH2</span> <span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-381"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: RIH2</span>
<a name="ln-382"></a>
<a name="ln-383"></a><span class="c">! WERTET X*EXP(-X)*EI(X) AUS FUER GROSSE X</span>
<a name="ln-384"></a><span class="c">! DURCH INTERPOLATION DER TABELLE ... AUS ABRAMOWITZ</span>
<a name="ln-385"></a>
<a name="ln-386"></a>
<a name="ln-387"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="mi">20</span><span class="p">)</span> <span class="o">=</span><span class="p">(</span><span class="o">/</span><span class="mf">1.000000</span><span class="p">,</span><span class="mf">1.005051</span><span class="p">,</span><span class="mf">1.010206</span><span class="p">,</span><span class="mf">1.015472</span><span class="p">,</span><span class="mf">1.020852</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-388"></a>                                       <span class="mf">1.026355</span><span class="p">,</span><span class="mf">1.031985</span><span class="p">,</span><span class="mf">1.037751</span><span class="p">,</span><span class="mf">1.043662</span><span class="p">,</span><span class="mf">1.049726</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-389"></a>                                       <span class="mf">1.055956</span><span class="p">,</span><span class="mf">1.062364</span><span class="p">,</span><span class="mf">1.068965</span><span class="p">,</span><span class="mf">1.075780</span><span class="p">,</span><span class="mf">1.082830</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-390"></a>                                       <span class="mf">1.090140</span><span class="p">,</span><span class="mf">1.097737</span><span class="p">,</span><span class="mf">1.105647</span><span class="p">,</span><span class="mf">1.113894</span><span class="p">,</span><span class="mf">1.122497</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-391"></a>                                       <span class="mf">1.131470</span><span class="o">/</span><span class="p">)</span>
<a name="ln-392"></a>
<a name="ln-393"></a> <span class="n">X1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">X</span>
<a name="ln-394"></a> <span class="n">I</span>  <span class="o">=</span> <span class="nb">INT</span><span class="p">(</span> <span class="mi">20</span><span class="mf">0.</span><span class="o">*</span><span class="n">X1</span> <span class="p">)</span>
<a name="ln-395"></a> <span class="n">I1</span> <span class="o">=</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-396"></a>
<a name="ln-397"></a> <span class="n">RIH2</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="mi">20</span><span class="mf">0.</span><span class="o">*</span><span class="p">(</span> <span class="n">F</span><span class="p">(</span><span class="n">I1</span><span class="p">)</span><span class="o">-</span><span class="n">F</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">X1</span><span class="o">-</span><span class="p">.</span><span class="err">5</span><span class="n">E</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="kt">REAL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-398"></a><span class="k">END FUNCTION</span>
<a name="ln-399"></a>
<a name="ln-400"></a><span class="c">!**************************************************************************</span>
<a name="ln-401"></a>
<a name="ln-402"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">RIH3</span> <span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-403"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: RIH3</span>
<a name="ln-404"></a>
<a name="ln-405"></a><span class="c">! WERTET DEN AUSDRUCK EXP(-X) * EI(X) AUS</span>
<a name="ln-406"></a>
<a name="ln-407"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">X</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mi">2</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-408"></a><span class="k">  </span><span class="n">RIH3</span> <span class="o">=</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">EI</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-409"></a>  <span class="k">RETURN</span>
<a name="ln-410"></a><span class="k"> ELSE</span>
<a name="ln-411"></a><span class="k">  </span><span class="n">RIH3</span> <span class="o">=</span> <span class="n">RIH2</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">/</span><span class="n">X</span>
<a name="ln-412"></a> <span class="k">END IF</span>
<a name="ln-413"></a><span class="k">END FUNCTION</span>
<a name="ln-414"></a>
<a name="ln-415"></a><span class="c">! ***********************************************************</span>
<a name="ln-416"></a>
<a name="ln-417"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">EI</span> <span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-418"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: EI</span>
<a name="ln-419"></a>
<a name="ln-420"></a><span class="c">! EXPONENTIALINTEGRAL</span>
<a name="ln-421"></a><span class="c">!   GETESTET -60 &lt; X &lt; 60</span>
<a name="ln-422"></a>
<a name="ln-423"></a><span class="k">use </span><span class="n">io</span>
<a name="ln-424"></a><span class="k">use </span><span class="n">error</span>
<a name="ln-425"></a>
<a name="ln-426"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">A1</span><span class="o">=</span><span class="mf">8.57332</span><span class="p">,</span><span class="n">A2</span><span class="o">=</span><span class="mi">1</span><span class="mf">8.05901</span><span class="p">,</span><span class="n">A3</span><span class="o">=</span><span class="mf">8.63476</span><span class="p">,</span><span class="n">A4</span><span class="o">=</span><span class="p">.</span><span class="mi">26777</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-427"></a>                            <span class="n">B1</span><span class="o">=</span><span class="mf">9.57332</span><span class="p">,</span><span class="n">B2</span><span class="o">=</span><span class="mi">2</span><span class="mf">5.63295</span><span class="p">,</span><span class="n">B3</span><span class="o">=</span><span class="mi">2</span><span class="mf">1.09965</span><span class="p">,</span><span class="n">B4</span><span class="o">=</span><span class="mf">3.95849</span>
<a name="ln-428"></a>
<a name="ln-429"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">X</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mi">6</span><span class="mf">0.</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;EI (in others.f90)&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&gt;&gt; EI UNTESTED FOR X&gt;60 &#39;</span><span class="p">)</span>
<a name="ln-430"></a>
<a name="ln-431"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">X</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="mi">6</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-432"></a><span class="k">  </span><span class="n">EI</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-433"></a>  <span class="k">RETURN</span>
<a name="ln-434"></a><span class="k"> END IF</span>
<a name="ln-435"></a>
<a name="ln-436"></a><span class="k"> IF</span> <span class="p">(</span><span class="n">X</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="o">-</span><span class="mf">1.</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-437"></a><span class="c">!    ABRAMOWITZ (5.1.56)</span>
<a name="ln-438"></a>  <span class="n">XP</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<a name="ln-439"></a>  <span class="n">EI</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span> <span class="n">A4</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">A3</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">A2</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">A1</span><span class="o">+</span><span class="n">XP</span><span class="p">)))</span> <span class="p">)</span><span class="o">/</span><span class="p">(</span> <span class="n">B4</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">B3</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">B2</span><span class="o">+</span><span class="n">XP</span><span class="o">*</span><span class="p">(</span><span class="n">B1</span><span class="o">+</span><span class="n">XP</span><span class="p">)))</span> <span class="p">)</span> <span class="o">*</span> <span class="nb">EXP</span><span class="p">(</span><span class="o">-</span><span class="n">XP</span><span class="p">)</span><span class="o">/</span><span class="n">XP</span>
<a name="ln-440"></a>  <span class="k">RETURN</span>
<a name="ln-441"></a><span class="k"> END IF</span>
<a name="ln-442"></a><span class="k">    </span>
<a name="ln-443"></a><span class="k"> </span><span class="n">EI</span>   <span class="o">=</span> <span class="p">.</span><span class="mi">577216</span> <span class="o">+</span> <span class="nb">LOG</span><span class="p">(</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="p">)</span>
<a name="ln-444"></a>
<a name="ln-445"></a> <span class="n">I</span>    <span class="o">=</span> <span class="mi">1</span>
<a name="ln-446"></a> <span class="n">SI</span>   <span class="o">=</span> <span class="n">X</span>
<a name="ln-447"></a> <span class="n">SUMM</span> <span class="o">=</span> <span class="n">SI</span>
<a name="ln-448"></a> <span class="k">do while</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">SI</span><span class="o">/</span><span class="n">X</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="mf">1.E-6</span><span class="p">)</span>
<a name="ln-449"></a>  <span class="n">RI</span>   <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-450"></a>  <span class="n">RII</span>  <span class="o">=</span> <span class="n">RI</span> <span class="o">+</span> <span class="mf">1.</span>
<a name="ln-451"></a>  <span class="n">SI</span>   <span class="o">=</span> <span class="n">SI</span> <span class="o">*</span> <span class="n">X</span> <span class="o">*</span> <span class="n">RI</span><span class="o">/</span><span class="p">(</span><span class="n">RII</span><span class="o">*</span><span class="n">RII</span><span class="p">)</span>
<a name="ln-452"></a>  <span class="n">SUMM</span> <span class="o">=</span> <span class="n">SUMM</span> <span class="o">+</span> <span class="n">SI</span>
<a name="ln-453"></a>  <span class="n">I</span>    <span class="o">=</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span>    
<a name="ln-454"></a> <span class="k">end do</span>
<a name="ln-455"></a><span class="k"> </span><span class="n">EI</span> <span class="o">=</span> <span class="n">EI</span> <span class="o">+</span> <span class="n">SUMM</span>
<a name="ln-456"></a><span class="k">END FUNCTION</span>
<a name="ln-457"></a>
<a name="ln-458"></a><span class="c">!**************************************************************************</span>
<a name="ln-459"></a>
<a name="ln-460"></a><span class="k">SUBROUTINE </span><span class="n">GETWK</span> <span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="n">SYMBOL</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<a name="ln-461"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: GETWK</span>
<a name="ln-462"></a>
<a name="ln-463"></a><span class="c">! UPDATE 07.07.93</span>
<a name="ln-464"></a><span class="c">! NOW 4 A AND 4 B</span>
<a name="ln-465"></a>
<a name="ln-466"></a>
<a name="ln-467"></a><span class="c">! DATEN VON UND FUER DIE AUFRUFENDE ROUTINE</span>
<a name="ln-468"></a><span class="kt">integer</span>       <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-469"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span><span class="kd">::</span> <span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">B</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-470"></a><span class="kt">character</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">SYMBOL</span> 
<a name="ln-471"></a>
<a name="ln-472"></a><span class="c">! DATEN, DIE NUR INTERN BENOETIGT WERDEN</span>
<a name="ln-473"></a><span class="kt">character</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">SY</span><span class="p">(</span><span class="mi">98</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="s1">&#39;H &#39;</span><span class="p">,</span><span class="s1">&#39;He&#39;</span><span class="p">,</span><span class="s1">&#39;Li&#39;</span><span class="p">,</span><span class="s1">&#39;Be&#39;</span><span class="p">,</span><span class="s1">&#39;B &#39;</span><span class="p">,</span><span class="s1">&#39;C &#39;</span><span class="p">,</span><span class="s1">&#39;N &#39;</span><span class="p">,</span><span class="s1">&#39;O &#39;</span><span class="p">,</span><span class="s1">&#39;F &#39;</span><span class="p">,</span><span class="s1">&#39;Ne&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-474"></a>                                     <span class="s1">&#39;Na&#39;</span><span class="p">,</span><span class="s1">&#39;Mg&#39;</span><span class="p">,</span><span class="s1">&#39;Al&#39;</span><span class="p">,</span><span class="s1">&#39;Si&#39;</span><span class="p">,</span><span class="s1">&#39;P &#39;</span><span class="p">,</span><span class="s1">&#39;S &#39;</span><span class="p">,</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;Ar&#39;</span><span class="p">,</span><span class="s1">&#39;K &#39;</span><span class="p">,</span><span class="s1">&#39;Ca&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-475"></a>                                     <span class="s1">&#39;Sc&#39;</span><span class="p">,</span><span class="s1">&#39;Ti&#39;</span><span class="p">,</span><span class="s1">&#39;V &#39;</span><span class="p">,</span><span class="s1">&#39;Cr&#39;</span><span class="p">,</span><span class="s1">&#39;Mn&#39;</span><span class="p">,</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span><span class="s1">&#39;Co&#39;</span><span class="p">,</span><span class="s1">&#39;Ni&#39;</span><span class="p">,</span><span class="s1">&#39;Cu&#39;</span><span class="p">,</span><span class="s1">&#39;Zn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-476"></a>                                     <span class="s1">&#39;Ga&#39;</span><span class="p">,</span><span class="s1">&#39;Ge&#39;</span><span class="p">,</span><span class="s1">&#39;As&#39;</span><span class="p">,</span><span class="s1">&#39;Se&#39;</span><span class="p">,</span><span class="s1">&#39;Br&#39;</span><span class="p">,</span><span class="s1">&#39;Kr&#39;</span><span class="p">,</span><span class="s1">&#39;Rb&#39;</span><span class="p">,</span><span class="s1">&#39;Sr&#39;</span><span class="p">,</span><span class="s1">&#39;Y &#39;</span><span class="p">,</span><span class="s1">&#39;Zr&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-477"></a>                                     <span class="s1">&#39;Nb&#39;</span><span class="p">,</span><span class="s1">&#39;Mo&#39;</span><span class="p">,</span><span class="s1">&#39;Tc&#39;</span><span class="p">,</span><span class="s1">&#39;Ru&#39;</span><span class="p">,</span><span class="s1">&#39;Rh&#39;</span><span class="p">,</span><span class="s1">&#39;Pd&#39;</span><span class="p">,</span><span class="s1">&#39;Ag&#39;</span><span class="p">,</span><span class="s1">&#39;Cd&#39;</span><span class="p">,</span><span class="s1">&#39;In&#39;</span><span class="p">,</span><span class="s1">&#39;Sn&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-478"></a>                                     <span class="s1">&#39;Sb&#39;</span><span class="p">,</span><span class="s1">&#39;Te&#39;</span><span class="p">,</span><span class="s1">&#39;I &#39;</span><span class="p">,</span><span class="s1">&#39;Xe&#39;</span><span class="p">,</span><span class="s1">&#39;Cs&#39;</span><span class="p">,</span><span class="s1">&#39;Ba&#39;</span><span class="p">,</span><span class="s1">&#39;La&#39;</span><span class="p">,</span><span class="s1">&#39;Ce&#39;</span><span class="p">,</span><span class="s1">&#39;Pr&#39;</span><span class="p">,</span><span class="s1">&#39;Nd&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-479"></a>                                     <span class="s1">&#39;Pm&#39;</span><span class="p">,</span><span class="s1">&#39;Sm&#39;</span><span class="p">,</span><span class="s1">&#39;Eu&#39;</span><span class="p">,</span><span class="s1">&#39;Gd&#39;</span><span class="p">,</span><span class="s1">&#39;Tb&#39;</span><span class="p">,</span><span class="s1">&#39;Dy&#39;</span><span class="p">,</span><span class="s1">&#39;Ho&#39;</span><span class="p">,</span><span class="s1">&#39;Er&#39;</span><span class="p">,</span><span class="s1">&#39;Tm&#39;</span><span class="p">,</span><span class="s1">&#39;Yb&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-480"></a>                                     <span class="s1">&#39;Lu&#39;</span><span class="p">,</span><span class="s1">&#39;Hf&#39;</span><span class="p">,</span><span class="s1">&#39;Ta&#39;</span><span class="p">,</span><span class="s1">&#39;W &#39;</span><span class="p">,</span><span class="s1">&#39;Re&#39;</span><span class="p">,</span><span class="s1">&#39;Os&#39;</span><span class="p">,</span><span class="s1">&#39;Ir&#39;</span><span class="p">,</span><span class="s1">&#39;Pt&#39;</span><span class="p">,</span><span class="s1">&#39;Au&#39;</span><span class="p">,</span><span class="s1">&#39;Hg&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-481"></a>                                     <span class="s1">&#39;Tl&#39;</span><span class="p">,</span><span class="s1">&#39;Pb&#39;</span><span class="p">,</span><span class="s1">&#39;Bi&#39;</span><span class="p">,</span><span class="s1">&#39;Po&#39;</span><span class="p">,</span><span class="s1">&#39;At&#39;</span><span class="p">,</span><span class="s1">&#39;Rn&#39;</span><span class="p">,</span><span class="s1">&#39;Fr&#39;</span><span class="p">,</span><span class="s1">&#39;Ra&#39;</span><span class="p">,</span><span class="s1">&#39;Ac&#39;</span><span class="p">,</span><span class="s1">&#39;Th&#39;</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-482"></a>                                     <span class="s1">&#39;Pa&#39;</span><span class="p">,</span><span class="s1">&#39;U &#39;</span><span class="p">,</span><span class="s1">&#39;Np&#39;</span><span class="p">,</span><span class="s1">&#39;Pu&#39;</span><span class="p">,</span><span class="s1">&#39;Am&#39;</span><span class="p">,</span><span class="s1">&#39;Cm&#39;</span><span class="p">,</span><span class="s1">&#39;Bk&#39;</span><span class="p">,</span><span class="s1">&#39;Cf&#39;</span><span class="o">/</span><span class="p">)</span>
<a name="ln-483"></a>
<a name="ln-484"></a><span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">AA</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">98</span><span class="p">)</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">((</span><span class="o">/</span> <span class="mf">0.00427</span><span class="p">,</span> <span class="mf">0.00957</span><span class="p">,</span> <span class="mf">0.00802</span><span class="p">,</span> <span class="mf">0.00209</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-485"></a>                                   <span class="mf">0.01217</span><span class="p">,</span> <span class="mf">0.02616</span><span class="p">,</span><span class="o">-</span><span class="mf">0.00884</span><span class="p">,</span> <span class="mf">0.01841</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-486"></a>                                   <span class="mf">0.00251</span><span class="p">,</span> <span class="mf">0.03576</span><span class="p">,</span> <span class="mf">0.00988</span><span class="p">,</span> <span class="mf">0.02370</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-487"></a>                                   <span class="mf">0.01596</span><span class="p">,</span> <span class="mf">0.02959</span><span class="p">,</span> <span class="mf">0.04024</span><span class="p">,</span> <span class="mf">0.01001</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-488"></a>                                   <span class="mf">0.03652</span><span class="p">,</span> <span class="mf">0.01140</span><span class="p">,</span> <span class="mf">0.05677</span><span class="p">,</span> <span class="mf">0.01506</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-489"></a>                                   <span class="mf">0.04102</span><span class="p">,</span> <span class="mf">0.04911</span><span class="p">,</span> <span class="mf">0.05296</span><span class="p">,</span> <span class="mf">0.00061</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-490"></a>                                   <span class="mf">0.04123</span><span class="p">,</span> <span class="mf">0.05740</span><span class="p">,</span> <span class="mf">0.06529</span><span class="p">,</span> <span class="mf">0.00373</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-491"></a>                                   <span class="mf">0.03547</span><span class="p">,</span> <span class="mf">0.03133</span><span class="p">,</span> <span class="mf">0.10865</span><span class="p">,</span> <span class="mf">0.01615</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-492"></a>                                   <span class="mf">0.03957</span><span class="p">,</span> <span class="mf">0.07225</span><span class="p">,</span> <span class="mf">0.09581</span><span class="p">,</span> <span class="mf">0.00792</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-493"></a>                                   <span class="mf">0.02597</span><span class="p">,</span> <span class="mf">0.02197</span><span class="p">,</span> <span class="mf">0.13762</span><span class="p">,</span> <span class="mf">0.05394</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-494"></a>                                   <span class="mf">0.03283</span><span class="p">,</span> <span class="mf">0.08858</span><span class="p">,</span> <span class="mf">0.11688</span><span class="p">,</span> <span class="mf">0.02516</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-495"></a>                                   <span class="mf">0.03833</span><span class="p">,</span> <span class="mf">0.17124</span><span class="p">,</span> <span class="mf">0.03649</span><span class="p">,</span> <span class="mf">0.04134</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-496"></a>                                   <span class="mf">0.04388</span><span class="p">,</span> <span class="mf">0.17743</span><span class="p">,</span> <span class="mf">0.05047</span><span class="p">,</span> <span class="mf">0.03957</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-497"></a>                                   <span class="mf">0.03812</span><span class="p">,</span> <span class="mf">0.17833</span><span class="p">,</span> <span class="mf">0.06280</span><span class="p">,</span> <span class="mf">0.05605</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-498"></a>                                   <span class="mf">0.04166</span><span class="p">,</span> <span class="mf">0.17817</span><span class="p">,</span> <span class="mf">0.09479</span><span class="p">,</span> <span class="mf">0.04463</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-499"></a>                                   <span class="mf">0.04003</span><span class="p">,</span> <span class="mf">0.18346</span><span class="p">,</span> <span class="mf">0.12218</span><span class="p">,</span> <span class="mf">0.03753</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-500"></a>                                   <span class="mf">0.04245</span><span class="p">,</span> <span class="mf">0.17645</span><span class="p">,</span> <span class="mf">0.15814</span><span class="p">,</span> <span class="mf">0.03011</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-501"></a>                                   <span class="mf">0.05011</span><span class="p">,</span> <span class="mf">0.16667</span><span class="p">,</span> <span class="mf">0.17074</span><span class="p">,</span> <span class="mf">0.04358</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-502"></a>                                   <span class="mf">0.04058</span><span class="p">,</span> <span class="mf">0.17582</span><span class="p">,</span> <span class="mf">0.20943</span><span class="p">,</span> <span class="mf">0.02922</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-503"></a>                                   <span class="mf">0.04001</span><span class="p">,</span> <span class="mf">0.17416</span><span class="p">,</span> <span class="mf">0.20986</span><span class="p">,</span> <span class="mf">0.05497</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-504"></a>                                   <span class="mf">0.09685</span><span class="p">,</span> <span class="mf">0.14777</span><span class="p">,</span> <span class="mf">0.20981</span><span class="p">,</span> <span class="mf">0.04852</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-505"></a>                                   <span class="mf">0.06667</span><span class="p">,</span> <span class="mf">0.17356</span><span class="p">,</span> <span class="mf">0.22710</span><span class="p">,</span> <span class="mf">0.05957</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-506"></a>                                   <span class="mf">0.05118</span><span class="p">,</span> <span class="mf">0.16791</span><span class="p">,</span> <span class="mf">0.26700</span><span class="p">,</span> <span class="mf">0.06476</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-507"></a>                                   <span class="mf">0.03204</span><span class="p">,</span> <span class="mf">0.18460</span><span class="p">,</span> <span class="mf">0.30764</span><span class="p">,</span> <span class="mf">0.05052</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-508"></a>                                   <span class="mf">0.03866</span><span class="p">,</span> <span class="mf">0.17782</span><span class="p">,</span> <span class="mf">0.31329</span><span class="p">,</span> <span class="mf">0.06898</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-509"></a>                                   <span class="mf">0.05455</span><span class="p">,</span> <span class="mf">0.16660</span><span class="p">,</span> <span class="mf">0.33208</span><span class="p">,</span> <span class="mf">0.06947</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-510"></a>                                   <span class="mf">0.05942</span><span class="p">,</span> <span class="mf">0.17472</span><span class="p">,</span> <span class="mf">0.34423</span><span class="p">,</span> <span class="mf">0.06828</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-511"></a>                                   <span class="mf">0.06049</span><span class="p">,</span> <span class="mf">0.16600</span><span class="p">,</span> <span class="mf">0.37302</span><span class="p">,</span> <span class="mf">0.07109</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-512"></a>                                   <span class="mf">0.08034</span><span class="p">,</span> <span class="mf">0.15838</span><span class="p">,</span> <span class="mf">0.40116</span><span class="p">,</span> <span class="mf">0.05467</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-513"></a>                                   <span class="mf">0.02948</span><span class="p">,</span> <span class="mf">0.19200</span><span class="p">,</span> <span class="mf">0.42222</span><span class="p">,</span> <span class="mf">0.07480</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-514"></a>                                   <span class="mf">0.16157</span><span class="p">,</span> <span class="mf">0.32976</span><span class="p">,</span> <span class="mf">0.18964</span><span class="p">,</span> <span class="mf">0.06148</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-515"></a>                                   <span class="mf">0.16184</span><span class="p">,</span> <span class="mf">0.35705</span><span class="p">,</span> <span class="mf">0.17618</span><span class="p">,</span> <span class="mf">0.07133</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-516"></a>                                   <span class="mf">0.06190</span><span class="p">,</span> <span class="mf">0.18452</span><span class="p">,</span> <span class="mf">0.41600</span><span class="p">,</span> <span class="mf">0.12793</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-517"></a>                                   <span class="mf">0.15913</span><span class="p">,</span> <span class="mf">0.41583</span><span class="p">,</span> <span class="mf">0.13385</span><span class="p">,</span> <span class="mf">0.10549</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-518"></a>                                   <span class="mf">0.16514</span><span class="p">,</span> <span class="mf">0.41202</span><span class="p">,</span> <span class="mf">0.12900</span><span class="p">,</span> <span class="mf">0.13209</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-519"></a>                                   <span class="mf">0.15798</span><span class="p">,</span> <span class="mf">0.41181</span><span class="p">,</span> <span class="mf">0.14254</span><span class="p">,</span> <span class="mf">0.14987</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-520"></a>                                   <span class="mf">0.16535</span><span class="p">,</span> <span class="mf">0.44674</span><span class="p">,</span> <span class="mf">0.24245</span><span class="p">,</span> <span class="mf">0.03161</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-521"></a>                                   <span class="mf">0.16039</span><span class="p">,</span> <span class="mf">0.44470</span><span class="p">,</span> <span class="mf">0.24661</span><span class="p">,</span> <span class="mf">0.05840</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-522"></a>                                   <span class="mf">0.16619</span><span class="p">,</span> <span class="mf">0.44376</span><span class="p">,</span> <span class="mf">0.25613</span><span class="p">,</span> <span class="mf">0.06797</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-523"></a>                                   <span class="mf">0.16794</span><span class="p">,</span> <span class="mf">0.44505</span><span class="p">,</span> <span class="mf">0.27188</span><span class="p">,</span> <span class="mf">0.07313</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-524"></a>                                   <span class="mf">0.16552</span><span class="p">,</span> <span class="mf">0.45008</span><span class="p">,</span> <span class="mf">0.30474</span><span class="p">,</span> <span class="mf">0.06161</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-525"></a>                                   <span class="mf">0.17327</span><span class="p">,</span> <span class="mf">0.44679</span><span class="p">,</span> <span class="mf">0.32441</span><span class="p">,</span> <span class="mf">0.06143</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-526"></a>                                   <span class="mf">0.16424</span><span class="p">,</span> <span class="mf">0.45046</span><span class="p">,</span> <span class="mf">0.33749</span><span class="p">,</span> <span class="mf">0.07766</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-527"></a>                                   <span class="mf">0.18750</span><span class="p">,</span> <span class="mf">0.44919</span><span class="p">,</span> <span class="mf">0.36323</span><span class="p">,</span> <span class="mf">0.05388</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-528"></a>                                   <span class="mf">0.16081</span><span class="p">,</span> <span class="mf">0.45211</span><span class="p">,</span> <span class="mf">0.40343</span><span class="p">,</span> <span class="mf">0.06140</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-529"></a>                                   <span class="mf">0.16599</span><span class="p">,</span> <span class="mf">0.43951</span><span class="p">,</span> <span class="mf">0.41478</span><span class="p">,</span> <span class="mf">0.08142</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-530"></a>                                   <span class="mf">0.16547</span><span class="p">,</span> <span class="mf">0.44658</span><span class="p">,</span> <span class="mf">0.45401</span><span class="p">,</span> <span class="mf">0.05959</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-531"></a>                                   <span class="mf">0.17154</span><span class="p">,</span> <span class="mf">0.43689</span><span class="p">,</span> <span class="mf">0.46392</span><span class="p">,</span> <span class="mf">0.07725</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-532"></a>                                   <span class="mf">0.15752</span><span class="p">,</span> <span class="mf">0.44821</span><span class="p">,</span> <span class="mf">0.48186</span><span class="p">,</span> <span class="mf">0.08596</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-533"></a>                                   <span class="mf">0.15732</span><span class="p">,</span> <span class="mf">0.44563</span><span class="p">,</span> <span class="mf">0.48507</span><span class="p">,</span> <span class="mf">0.10948</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-534"></a>                                   <span class="mf">0.16971</span><span class="p">,</span> <span class="mf">0.42742</span><span class="p">,</span> <span class="mf">0.48779</span><span class="p">,</span> <span class="mf">0.13653</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-535"></a>                                   <span class="mf">0.14927</span><span class="p">,</span> <span class="mf">0.43729</span><span class="p">,</span> <span class="mf">0.49444</span><span class="p">,</span> <span class="mf">0.16440</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-536"></a>                                   <span class="mf">0.18053</span><span class="p">,</span> <span class="mf">0.44724</span><span class="p">,</span> <span class="mf">0.48163</span><span class="p">,</span> <span class="mf">0.15995</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-537"></a>                                   <span class="mf">0.13141</span><span class="p">,</span> <span class="mf">0.43855</span><span class="p">,</span> <span class="mf">0.50035</span><span class="p">,</span> <span class="mf">0.22299</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-538"></a>                                   <span class="mf">0.31397</span><span class="p">,</span> <span class="mf">0.55648</span><span class="p">,</span> <span class="mf">0.39828</span><span class="p">,</span> <span class="mf">0.04852</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-539"></a>                                   <span class="mf">0.32756</span><span class="p">,</span> <span class="mf">0.53927</span><span class="p">,</span> <span class="mf">0.39830</span><span class="p">,</span> <span class="mf">0.07607</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-540"></a>                                   <span class="mf">0.30887</span><span class="p">,</span> <span class="mf">0.53804</span><span class="p">,</span> <span class="mf">0.42265</span><span class="p">,</span> <span class="mf">0.09559</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-541"></a>                                   <span class="mf">0.28398</span><span class="p">,</span> <span class="mf">0.53568</span><span class="p">,</span> <span class="mf">0.46662</span><span class="p">,</span> <span class="mf">0.10282</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-542"></a>                                   <span class="mf">0.35160</span><span class="p">,</span> <span class="mf">0.56889</span><span class="p">,</span> <span class="mf">0.42010</span><span class="p">,</span> <span class="mf">0.07246</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-543"></a>                                   <span class="mf">0.33810</span><span class="p">,</span> <span class="mf">0.58035</span><span class="p">,</span> <span class="mf">0.44442</span><span class="p">,</span> <span class="mf">0.07413</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-544"></a>                                   <span class="mf">0.35449</span><span class="p">,</span> <span class="mf">0.59626</span><span class="p">,</span> <span class="mf">0.43868</span><span class="p">,</span> <span class="mf">0.07152</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-545"></a>                                   <span class="mf">0.35559</span><span class="p">,</span> <span class="mf">0.60598</span><span class="p">,</span> <span class="mf">0.45165</span><span class="p">,</span> <span class="mf">0.07168</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-546"></a>                                   <span class="mf">0.38379</span><span class="p">,</span> <span class="mf">0.64088</span><span class="p">,</span> <span class="mf">0.41710</span><span class="p">,</span> <span class="mf">0.06708</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-547"></a>                                   <span class="mf">0.40352</span><span class="p">,</span> <span class="mf">0.64303</span><span class="p">,</span> <span class="mf">0.40488</span><span class="p">,</span> <span class="mf">0.08137</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-548"></a>                                   <span class="mf">0.36838</span><span class="p">,</span> <span class="mf">0.64761</span><span class="p">,</span> <span class="mf">0.47222</span><span class="p">,</span> <span class="mf">0.06854</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-549"></a>                                   <span class="mf">0.38514</span><span class="p">,</span> <span class="mf">0.68422</span><span class="p">,</span> <span class="mf">0.44359</span><span class="p">,</span> <span class="mf">0.06775</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-550"></a>                                   <span class="mf">0.37280</span><span class="p">,</span> <span class="mf">0.67528</span><span class="p">,</span> <span class="mf">0.47337</span><span class="p">,</span> <span class="mf">0.08320</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-551"></a>                                   <span class="mf">0.39335</span><span class="p">,</span> <span class="mf">0.70093</span><span class="p">,</span> <span class="mf">0.46774</span><span class="p">,</span> <span class="mf">0.06658</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-552"></a>                                   <span class="mf">0.40587</span><span class="p">,</span> <span class="mf">0.71223</span><span class="p">,</span> <span class="mf">0.46598</span><span class="p">,</span> <span class="mf">0.06847</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-553"></a>                                   <span class="mf">0.39728</span><span class="p">,</span> <span class="mf">0.73368</span><span class="p">,</span> <span class="mf">0.47795</span><span class="p">,</span> <span class="mf">0.06759</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-554"></a>                                   <span class="mf">0.40697</span><span class="p">,</span> <span class="mf">0.73576</span><span class="p">,</span> <span class="mf">0.47481</span><span class="p">,</span> <span class="mf">0.08291</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-555"></a>                                   <span class="mf">0.40122</span><span class="p">,</span> <span class="mf">0.78861</span><span class="p">,</span> <span class="mf">0.44658</span><span class="p">,</span> <span class="mf">0.08799</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-556"></a>                                   <span class="mf">0.41127</span><span class="p">,</span> <span class="mf">0.76965</span><span class="p">,</span> <span class="mf">0.46563</span><span class="p">,</span> <span class="mf">0.10180</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-557"></a>                                   <span class="mf">0.39978</span><span class="p">,</span> <span class="mf">0.77171</span><span class="p">,</span> <span class="mf">0.48541</span><span class="p">,</span> <span class="mf">0.11540</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-558"></a>                                   <span class="mf">0.39130</span><span class="p">,</span> <span class="mf">0.80752</span><span class="p">,</span> <span class="mf">0.48702</span><span class="p">,</span> <span class="mf">0.11041</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-559"></a>                                   <span class="mf">0.40436</span><span class="p">,</span> <span class="mf">0.80701</span><span class="p">,</span> <span class="mf">0.48445</span><span class="p">,</span> <span class="mf">0.12438</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-560"></a>                                   <span class="mf">0.38816</span><span class="p">,</span> <span class="mf">0.80163</span><span class="p">,</span> <span class="mf">0.51922</span><span class="p">,</span> <span class="mf">0.13514</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-561"></a>                                   <span class="mf">0.39551</span><span class="p">,</span> <span class="mf">0.80409</span><span class="p">,</span> <span class="mf">0.53365</span><span class="p">,</span> <span class="mf">0.13485</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-562"></a>                                   <span class="mf">0.40850</span><span class="p">,</span> <span class="mf">0.83052</span><span class="p">,</span> <span class="mf">0.53325</span><span class="p">,</span> <span class="mf">0.11978</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-563"></a>                                   <span class="mf">0.40092</span><span class="p">,</span> <span class="mf">0.85415</span><span class="p">,</span> <span class="mf">0.53346</span><span class="p">,</span> <span class="mf">0.12747</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-564"></a>                                   <span class="mf">0.41872</span><span class="p">,</span> <span class="mf">0.88168</span><span class="p">,</span> <span class="mf">0.54551</span><span class="p">,</span> <span class="mf">0.09404</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-565"></a>                                   <span class="mf">0.43358</span><span class="p">,</span> <span class="mf">0.88007</span><span class="p">,</span> <span class="mf">0.52966</span><span class="p">,</span> <span class="mf">0.12059</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-566"></a>                                   <span class="mf">0.40858</span><span class="p">,</span> <span class="mf">0.87837</span><span class="p">,</span> <span class="mf">0.56392</span><span class="p">,</span> <span class="mf">0.13698</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-567"></a>                                   <span class="mf">0.41637</span><span class="p">,</span> <span class="mf">0.85094</span><span class="p">,</span> <span class="mf">0.57749</span><span class="p">,</span> <span class="mf">0.16700</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-568"></a>                                   <span class="mf">0.38951</span><span class="p">,</span> <span class="mf">0.83297</span><span class="p">,</span> <span class="mf">0.60557</span><span class="p">,</span> <span class="mf">0.20770</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-569"></a>                                   <span class="mf">0.41677</span><span class="p">,</span> <span class="mf">0.88094</span><span class="p">,</span> <span class="mf">0.55170</span><span class="p">,</span> <span class="mf">0.21029</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-570"></a>                                   <span class="mf">0.50089</span><span class="p">,</span> <span class="mf">1.00860</span><span class="p">,</span> <span class="mf">0.51420</span><span class="p">,</span> <span class="mf">0.05996</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-571"></a>                                   <span class="mf">0.47470</span><span class="p">,</span> <span class="mf">0.99363</span><span class="p">,</span> <span class="mf">0.54721</span><span class="p">,</span> <span class="mf">0.09206</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-572"></a>                                   <span class="mf">0.47810</span><span class="p">,</span> <span class="mf">0.98385</span><span class="p">,</span> <span class="mf">0.54905</span><span class="p">,</span> <span class="mf">0.12055</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-573"></a>                                   <span class="mf">0.47903</span><span class="p">,</span> <span class="mf">0.97455</span><span class="p">,</span> <span class="mf">0.55883</span><span class="p">,</span> <span class="mf">0.14309</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-574"></a>                                   <span class="mf">0.48351</span><span class="p">,</span> <span class="mf">0.98292</span><span class="p">,</span> <span class="mf">0.58877</span><span class="p">,</span> <span class="mf">0.12425</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-575"></a>                                   <span class="mf">0.48664</span><span class="p">,</span> <span class="mf">0.98057</span><span class="p">,</span> <span class="mf">0.61483</span><span class="p">,</span> <span class="mf">0.12136</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-576"></a>                                   <span class="mf">0.46078</span><span class="p">,</span> <span class="mf">0.97139</span><span class="p">,</span> <span class="mf">0.66506</span><span class="p">,</span> <span class="mf">0.13012</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-577"></a>                                   <span class="mf">0.49148</span><span class="p">,</span> <span class="mf">0.98583</span><span class="p">,</span> <span class="mf">0.67674</span><span class="p">,</span> <span class="mf">0.09725</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-578"></a>                                   <span class="mf">0.50865</span><span class="p">,</span> <span class="mf">0.98574</span><span class="p">,</span> <span class="mf">0.68109</span><span class="p">,</span> <span class="mf">0.09977</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-579"></a>                                   <span class="mf">0.46259</span><span class="p">,</span> <span class="mf">0.97882</span><span class="p">,</span> <span class="mf">0.73056</span><span class="p">,</span> <span class="mf">0.12723</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-580"></a>                                   <span class="mf">0.46221</span><span class="p">,</span> <span class="mf">0.95749</span><span class="p">,</span> <span class="mf">0.76259</span><span class="p">,</span> <span class="mf">0.14086</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-581"></a>                                   <span class="mf">0.48500</span><span class="p">,</span> <span class="mf">0.95602</span><span class="p">,</span> <span class="mf">0.77234</span><span class="p">,</span> <span class="mf">0.13374</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">98</span><span class="o">/</span><span class="p">))</span>
<a name="ln-582"></a>                         
<a name="ln-583"></a>
<a name="ln-584"></a><span class="kt">REAL</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span> <span class="kd">::</span> <span class="n">BB</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">98</span><span class="p">)</span> <span class="o">=</span> <span class="nb">reshape</span><span class="p">((</span><span class="o">/</span> <span class="mf">4.17218</span><span class="p">,</span> <span class="mi">1</span><span class="mf">6.05892</span><span class="p">,</span> <span class="mi">2</span><span class="mf">6.78365</span><span class="p">,</span> <span class="mi">6</span><span class="mf">9.45643</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-585"></a>                                   <span class="mf">1.83008</span><span class="p">,</span>  <span class="mf">7.20225</span><span class="p">,</span> <span class="mi">1</span><span class="mf">6.13585</span><span class="p">,</span> <span class="mi">1</span><span class="mf">8.75551</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-586"></a>                                   <span class="mf">0.02620</span><span class="p">,</span>  <span class="mf">2.00907</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.80597</span><span class="p">,</span><span class="mi">13</span><span class="mf">0.49226</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-587"></a>                                   <span class="mf">0.38968</span><span class="p">,</span>  <span class="mf">1.99268</span><span class="p">,</span> <span class="mi">4</span><span class="mf">6.86913</span><span class="p">,</span><span class="mi">10</span><span class="mf">8.84167</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-588"></a>                                   <span class="mf">0.50627</span><span class="p">,</span>  <span class="mf">3.68297</span><span class="p">,</span> <span class="mi">2</span><span class="mf">7.90586</span><span class="p">,</span> <span class="mi">7</span><span class="mf">4.98296</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-589"></a>                                   <span class="mf">0.41335</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.98289</span><span class="p">,</span> <span class="mi">3</span><span class="mf">4.80286</span><span class="p">,</span><span class="mi">17</span><span class="mf">7.19113</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-590"></a>                                   <span class="mf">0.29792</span><span class="p">,</span>  <span class="mf">7.84094</span><span class="p">,</span> <span class="mi">2</span><span class="mf">2.58809</span><span class="p">,</span> <span class="mi">7</span><span class="mf">2.59254</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-591"></a>                                   <span class="mf">0.17964</span><span class="p">,</span>  <span class="mf">2.60856</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.79972</span><span class="p">,</span> <span class="mi">3</span><span class="mf">8.02912</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-592"></a>                                   <span class="mf">0.16403</span><span class="p">,</span>  <span class="mf">3.96612</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.43903</span><span class="p">,</span> <span class="mi">4</span><span class="mf">0.05053</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-593"></a>                                   <span class="mf">0.09101</span><span class="p">,</span>  <span class="mf">0.41253</span><span class="p">,</span>  <span class="mf">5.02463</span><span class="p">,</span> <span class="mi">1</span><span class="mf">7.52954</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-594"></a>                                   <span class="mf">0.06008</span><span class="p">,</span>  <span class="mf">2.07182</span><span class="p">,</span>  <span class="mf">7.64444</span><span class="p">,</span><span class="mi">14</span><span class="mf">6.00952</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-595"></a>                                   <span class="mf">0.07424</span><span class="p">,</span>  <span class="mf">2.87177</span><span class="p">,</span> <span class="mi">1</span><span class="mf">8.06729</span><span class="p">,</span> <span class="mi">9</span><span class="mf">7.00854</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-596"></a>                                   <span class="mf">0.09086</span><span class="p">,</span>  <span class="mf">2.53252</span><span class="p">,</span> <span class="mi">3</span><span class="mf">0.43883</span><span class="p">,</span> <span class="mi">9</span><span class="mf">8.26737</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-597"></a>                                   <span class="mf">0.05396</span><span class="p">,</span>  <span class="mf">1.86461</span><span class="p">,</span> <span class="mi">2</span><span class="mf">2.54263</span><span class="p">,</span> <span class="mi">7</span><span class="mf">2.43144</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-598"></a>                                   <span class="mf">0.05564</span><span class="p">,</span>  <span class="mf">1.62500</span><span class="p">,</span> <span class="mi">2</span><span class="mf">4.45354</span><span class="p">,</span> <span class="mi">6</span><span class="mf">4.38264</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-599"></a>                                   <span class="mf">0.05214</span><span class="p">,</span>  <span class="mf">1.40793</span><span class="p">,</span> <span class="mi">2</span><span class="mf">3.35691</span><span class="p">,</span> <span class="mi">5</span><span class="mf">3.59676</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-600"></a>                                   <span class="mf">0.04643</span><span class="p">,</span>  <span class="mf">1.15677</span><span class="p">,</span> <span class="mi">1</span><span class="mf">9.34091</span><span class="p">,</span> <span class="mi">5</span><span class="mf">2.88785</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-601"></a>                                   <span class="mf">0.07991</span><span class="p">,</span>  <span class="mf">1.01436</span><span class="p">,</span> <span class="mi">1</span><span class="mf">5.67109</span><span class="p">,</span> <span class="mi">3</span><span class="mf">9.60819</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-602"></a>                                   <span class="mf">0.03352</span><span class="p">,</span>  <span class="mf">0.82984</span><span class="p">,</span> <span class="mi">1</span><span class="mf">4.13679</span><span class="p">,</span><span class="mi">20</span><span class="mf">0.97722</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-603"></a>                                   <span class="mf">0.02289</span><span class="p">,</span>  <span class="mf">0.71288</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.18914</span><span class="p">,</span><span class="mi">13</span><span class="mf">5.02390</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-604"></a>                                   <span class="mf">0.12527</span><span class="p">,</span>  <span class="mf">1.34248</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.43524</span><span class="p">,</span><span class="mi">13</span><span class="mf">1.71112</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-605"></a>                                   <span class="mf">0.05198</span><span class="p">,</span>  <span class="mf">0.86467</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.59984</span><span class="p">,</span><span class="mi">10</span><span class="mf">3.56776</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-606"></a>                                   <span class="mf">0.03786</span><span class="p">,</span>  <span class="mf">0.57160</span><span class="p">,</span>  <span class="mf">8.30305</span><span class="p">,</span> <span class="mi">9</span><span class="mf">1.78068</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-607"></a>                                   <span class="mf">0.00240</span><span class="p">,</span>  <span class="mf">0.44931</span><span class="p">,</span>  <span class="mf">7.92251</span><span class="p">,</span> <span class="mi">8</span><span class="mf">6.64058</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-608"></a>                                   <span class="mf">0.01836</span><span class="p">,</span>  <span class="mf">0.41203</span><span class="p">,</span>  <span class="mf">6.73736</span><span class="p">,</span> <span class="mi">7</span><span class="mf">6.30466</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-609"></a>                                   <span class="mf">0.03947</span><span class="p">,</span>  <span class="mf">0.43294</span><span class="p">,</span>  <span class="mf">6.26864</span><span class="p">,</span> <span class="mi">7</span><span class="mf">1.29470</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-610"></a>                                   <span class="mf">0.03962</span><span class="p">,</span>  <span class="mf">0.43253</span><span class="p">,</span>  <span class="mf">6.05175</span><span class="p">,</span> <span class="mi">6</span><span class="mf">8.72437</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-611"></a>                                   <span class="mf">0.03558</span><span class="p">,</span>  <span class="mf">0.39976</span><span class="p">,</span>  <span class="mf">5.36660</span><span class="p">,</span> <span class="mi">6</span><span class="mf">2.46894</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-612"></a>                                   <span class="mf">0.05475</span><span class="p">,</span>  <span class="mf">0.45736</span><span class="p">,</span>  <span class="mf">5.38252</span><span class="p">,</span> <span class="mi">6</span><span class="mf">0.43276</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-613"></a>                                   <span class="mf">0.00137</span><span class="p">,</span>  <span class="mf">0.26535</span><span class="p">,</span>  <span class="mf">4.48040</span><span class="p">,</span> <span class="mi">5</span><span class="mf">4.26088</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-614"></a>                                   <span class="mf">0.10455</span><span class="p">,</span>  <span class="mf">2.18391</span><span class="p">,</span>  <span class="mf">9.04125</span><span class="p">,</span> <span class="mi">7</span><span class="mf">5.16958</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-615"></a>                                   <span class="mf">0.09890</span><span class="p">,</span>  <span class="mf">2.06856</span><span class="p">,</span>  <span class="mf">9.89926</span><span class="p">,</span> <span class="mi">6</span><span class="mf">8.13783</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-616"></a>                                   <span class="mf">0.01642</span><span class="p">,</span>  <span class="mf">0.32542</span><span class="p">,</span>  <span class="mf">3.51888</span><span class="p">,</span> <span class="mi">4</span><span class="mf">4.50604</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-617"></a>                                   <span class="mf">0.07669</span><span class="p">,</span>  <span class="mf">1.89297</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.31554</span><span class="p">,</span> <span class="mi">4</span><span class="mf">6.32082</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-618"></a>                                   <span class="mf">0.08199</span><span class="p">,</span>  <span class="mf">1.76568</span><span class="p">,</span>  <span class="mf">9.87254</span><span class="p">,</span> <span class="mi">3</span><span class="mf">8.10640</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-619"></a>                                   <span class="mf">0.06939</span><span class="p">,</span>  <span class="mf">1.53446</span><span class="p">,</span>  <span class="mf">8.98025</span><span class="p">,</span> <span class="mi">3</span><span class="mf">3.04365</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-620"></a>                                   <span class="mf">0.07044</span><span class="p">,</span>  <span class="mf">1.59236</span><span class="p">,</span> <span class="mi">1</span><span class="mf">7.53592</span><span class="p">,</span><span class="mi">21</span><span class="mf">5.26198</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-621"></a>                                   <span class="mf">0.06199</span><span class="p">,</span>  <span class="mf">1.41265</span><span class="p">,</span> <span class="mi">1</span><span class="mf">4.33812</span><span class="p">,</span><span class="mi">15</span><span class="mf">2.80257</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-622"></a>                                   <span class="mf">0.06364</span><span class="p">,</span>  <span class="mf">1.34205</span><span class="p">,</span> <span class="mi">1</span><span class="mf">3.66551</span><span class="p">,</span><span class="mi">12</span><span class="mf">5.72522</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-623"></a>                                   <span class="mf">0.06565</span><span class="p">,</span>  <span class="mf">1.25292</span><span class="p">,</span> <span class="mi">1</span><span class="mf">3.09355</span><span class="p">,</span><span class="mi">10</span><span class="mf">9.50252</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-624"></a>                                   <span class="mf">0.05921</span><span class="p">,</span>  <span class="mf">1.15624</span><span class="p">,</span> <span class="mi">1</span><span class="mf">3.24924</span><span class="p">,</span> <span class="mi">9</span><span class="mf">8.69958</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-625"></a>                                   <span class="mf">0.06162</span><span class="p">,</span>  <span class="mf">1.11236</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.76149</span><span class="p">,</span> <span class="mi">9</span><span class="mf">0.92026</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-626"></a>                                   <span class="mf">0.05081</span><span class="p">,</span>  <span class="mf">0.99771</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.28925</span><span class="p">,</span> <span class="mi">8</span><span class="mf">4.28943</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-627"></a>                                   <span class="mf">0.05120</span><span class="p">,</span>  <span class="mf">1.08672</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.23172</span><span class="p">,</span> <span class="mi">8</span><span class="mf">5.27316</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-628"></a>                                   <span class="mf">0.04662</span><span class="p">,</span>  <span class="mf">0.85252</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.51121</span><span class="p">,</span> <span class="mi">7</span><span class="mf">4.53949</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-629"></a>                                   <span class="mf">0.04933</span><span class="p">,</span>  <span class="mf">0.79381</span><span class="p">,</span>  <span class="mf">9.30944</span><span class="p">,</span> <span class="mi">4</span><span class="mf">1.17414</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-630"></a>                                   <span class="mf">0.04481</span><span class="p">,</span>  <span class="mf">0.75608</span><span class="p">,</span>  <span class="mf">9.34354</span><span class="p">,</span> <span class="mi">6</span><span class="mf">7.91975</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-631"></a>                                   <span class="mf">0.04867</span><span class="p">,</span>  <span class="mf">0.71518</span><span class="p">,</span>  <span class="mf">8.40595</span><span class="p">,</span> <span class="mi">6</span><span class="mf">4.24400</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-632"></a>                                   <span class="mf">0.03672</span><span class="p">,</span>  <span class="mf">0.64379</span><span class="p">,</span>  <span class="mf">7.83687</span><span class="p">,</span> <span class="mi">7</span><span class="mf">3.37281</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-633"></a>                                   <span class="mf">0.03308</span><span class="p">,</span>  <span class="mf">0.60931</span><span class="p">,</span>  <span class="mf">7.04977</span><span class="p">,</span> <span class="mi">6</span><span class="mf">4.83582</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-634"></a>                                   <span class="mf">0.04023</span><span class="p">,</span>  <span class="mf">0.58192</span><span class="p">,</span>  <span class="mf">6.29247</span><span class="p">,</span> <span class="mi">5</span><span class="mf">5.57061</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-635"></a>                                   <span class="mf">0.02842</span><span class="p">,</span>  <span class="mf">0.50687</span><span class="p">,</span>  <span class="mf">5.60835</span><span class="p">,</span> <span class="mi">4</span><span class="mf">8.28004</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-636"></a>                                   <span class="mf">0.03830</span><span class="p">,</span>  <span class="mf">0.58340</span><span class="p">,</span>  <span class="mf">6.47550</span><span class="p">,</span> <span class="mi">4</span><span class="mf">7.08820</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-637"></a>                                   <span class="mf">0.02097</span><span class="p">,</span>  <span class="mf">0.41007</span><span class="p">,</span>  <span class="mf">4.52105</span><span class="p">,</span> <span class="mi">3</span><span class="mf">7.18178</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-638"></a>                                   <span class="mf">0.07813</span><span class="p">,</span>  <span class="mf">1.45053</span><span class="p">,</span> <span class="mi">1</span><span class="mf">5.05933</span><span class="p">,</span><span class="mi">19</span><span class="mf">9.48830</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-639"></a>                                   <span class="mf">0.08444</span><span class="p">,</span>  <span class="mf">1.40227</span><span class="p">,</span> <span class="mi">1</span><span class="mf">3.12939</span><span class="p">,</span><span class="mi">16</span><span class="mf">0.56676</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-640"></a>                                   <span class="mf">0.07206</span><span class="p">,</span>  <span class="mf">1.19585</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.55866</span><span class="p">,</span><span class="mi">12</span><span class="mf">7.31371</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-641"></a>                                   <span class="mf">0.05717</span><span class="p">,</span>  <span class="mf">0.98756</span><span class="p">,</span>  <span class="mf">9.95556</span><span class="p">,</span><span class="mi">11</span><span class="mf">7.31874</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-642"></a>                                   <span class="mf">0.08249</span><span class="p">,</span>  <span class="mf">1.43427</span><span class="p">,</span> <span class="mi">1</span><span class="mf">2.37363</span><span class="p">,</span><span class="mi">15</span><span class="mf">0.55968</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-643"></a>                                   <span class="mf">0.07081</span><span class="p">,</span>  <span class="mf">1.31033</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.44403</span><span class="p">,</span><span class="mi">14</span><span class="mf">4.17706</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-644"></a>                                   <span class="mf">0.07442</span><span class="p">,</span>  <span class="mf">1.38680</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.54391</span><span class="p">,</span><span class="mi">14</span><span class="mf">3.72185</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-645"></a>                                   <span class="mf">0.07155</span><span class="p">,</span>  <span class="mf">1.34703</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.00432</span><span class="p">,</span><span class="mi">14</span><span class="mf">0.09138</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-646"></a>                                   <span class="mf">0.07794</span><span class="p">,</span>  <span class="mf">1.55042</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.89283</span><span class="p">,</span><span class="mi">14</span><span class="mf">2.79585</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-647"></a>                                   <span class="mf">0.08508</span><span class="p">,</span>  <span class="mf">1.60712</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.45367</span><span class="p">,</span><span class="mi">11</span><span class="mf">6.64063</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-648"></a>                                   <span class="mf">0.06520</span><span class="p">,</span>  <span class="mf">1.32571</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.16884</span><span class="p">,</span><span class="mi">13</span><span class="mf">4.69034</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-649"></a>                                   <span class="mf">0.06850</span><span class="p">,</span>  <span class="mf">1.43566</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.57719</span><span class="p">,</span><span class="mi">13</span><span class="mf">1.88972</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-650"></a>                                   <span class="mf">0.06264</span><span class="p">,</span>  <span class="mf">1.26756</span><span class="p">,</span>  <span class="mf">9.46411</span><span class="p">,</span><span class="mi">10</span><span class="mf">7.50194</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-651"></a>                                   <span class="mf">0.06750</span><span class="p">,</span>  <span class="mf">1.35829</span><span class="p">,</span>  <span class="mf">9.76480</span><span class="p">,</span><span class="mi">12</span><span class="mf">7.40374</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-652"></a>                                   <span class="mf">0.06958</span><span class="p">,</span>  <span class="mf">1.38750</span><span class="p">,</span>  <span class="mf">9.41888</span><span class="p">,</span><span class="mi">12</span><span class="mf">2.10940</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-653"></a>                                   <span class="mf">0.06574</span><span class="p">,</span>  <span class="mf">1.31578</span><span class="p">,</span>  <span class="mf">9.13448</span><span class="p">,</span><span class="mi">12</span><span class="mf">0.98209</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-654"></a>                                   <span class="mf">0.06517</span><span class="p">,</span>  <span class="mf">1.29452</span><span class="p">,</span>  <span class="mf">8.67569</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.34878</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-655"></a>                                   <span class="mf">0.06213</span><span class="p">,</span>  <span class="mf">1.30860</span><span class="p">,</span>  <span class="mf">9.18871</span><span class="p">,</span> <span class="mi">9</span><span class="mf">1.20213</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-656"></a>                                   <span class="mf">0.06292</span><span class="p">,</span>  <span class="mf">1.23499</span><span class="p">,</span>  <span class="mf">8.42904</span><span class="p">,</span> <span class="mi">7</span><span class="mf">7.59815</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-657"></a>                                   <span class="mf">0.05693</span><span class="p">,</span>  <span class="mf">1.15762</span><span class="p">,</span>  <span class="mf">7.83077</span><span class="p">,</span> <span class="mi">6</span><span class="mf">7.14066</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-658"></a>                                   <span class="mf">0.05145</span><span class="p">,</span>  <span class="mf">1.11240</span><span class="p">,</span>  <span class="mf">8.33441</span><span class="p">,</span> <span class="mi">6</span><span class="mf">5.71782</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-659"></a>                                   <span class="mf">0.05573</span><span class="p">,</span>  <span class="mf">1.11159</span><span class="p">,</span>  <span class="mf">8.00221</span><span class="p">,</span> <span class="mi">5</span><span class="mf">7.35021</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-660"></a>                                   <span class="mf">0.04855</span><span class="p">,</span>  <span class="mf">0.99356</span><span class="p">,</span>  <span class="mf">7.38693</span><span class="p">,</span> <span class="mi">5</span><span class="mf">1.75829</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-661"></a>                                   <span class="mf">0.04981</span><span class="p">,</span>  <span class="mf">0.97669</span><span class="p">,</span>  <span class="mf">7.38024</span><span class="p">,</span> <span class="mi">4</span><span class="mf">4.52068</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-662"></a>                                   <span class="mf">0.05151</span><span class="p">,</span>  <span class="mf">1.00803</span><span class="p">,</span>  <span class="mf">8.03707</span><span class="p">,</span> <span class="mi">4</span><span class="mf">5.01758</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-663"></a>                                   <span class="mf">0.04693</span><span class="p">,</span>  <span class="mf">0.98398</span><span class="p">,</span>  <span class="mf">7.83562</span><span class="p">,</span> <span class="mi">4</span><span class="mf">6.51474</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-664"></a>                                   <span class="mf">0.05161</span><span class="p">,</span>  <span class="mf">1.02127</span><span class="p">,</span>  <span class="mf">9.18455</span><span class="p">,</span> <span class="mi">6</span><span class="mf">4.88177</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-665"></a>                                   <span class="mf">0.05154</span><span class="p">,</span>  <span class="mf">1.03252</span><span class="p">,</span>  <span class="mf">8.49678</span><span class="p">,</span> <span class="mi">5</span><span class="mf">8.79463</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-666"></a>                                   <span class="mf">0.04200</span><span class="p">,</span>  <span class="mf">0.90939</span><span class="p">,</span>  <span class="mf">7.71158</span><span class="p">,</span> <span class="mi">5</span><span class="mf">7.79178</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-667"></a>                                   <span class="mf">0.04661</span><span class="p">,</span>  <span class="mf">0.87289</span><span class="p">,</span>  <span class="mf">6.84038</span><span class="p">,</span> <span class="mi">5</span><span class="mf">1.36000</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-668"></a>                                   <span class="mf">0.04168</span><span class="p">,</span>  <span class="mf">0.73697</span><span class="p">,</span>  <span class="mf">5.86112</span><span class="p">,</span> <span class="mi">4</span><span class="mf">3.78613</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-669"></a>                                   <span class="mf">0.04488</span><span class="p">,</span>  <span class="mf">0.83871</span><span class="p">,</span>  <span class="mf">6.44020</span><span class="p">,</span> <span class="mi">4</span><span class="mf">3.51940</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-670"></a>                                   <span class="mf">0.05786</span><span class="p">,</span>  <span class="mf">1.20028</span><span class="p">,</span> <span class="mi">1</span><span class="mf">3.85073</span><span class="p">,</span><span class="mi">17</span><span class="mf">2.15909</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-671"></a>                                   <span class="mf">0.05239</span><span class="p">,</span>  <span class="mf">1.03225</span><span class="p">,</span> <span class="mi">1</span><span class="mf">1.49796</span><span class="p">,</span><span class="mi">14</span><span class="mf">3.12303</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-672"></a>                                   <span class="mf">0.05167</span><span class="p">,</span>  <span class="mf">0.98867</span><span class="p">,</span> <span class="mi">1</span><span class="mf">0.52682</span><span class="p">,</span><span class="mi">11</span><span class="mf">2.18267</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-673"></a>                                   <span class="mf">0.04931</span><span class="p">,</span>  <span class="mf">0.95698</span><span class="p">,</span>  <span class="mf">9.61135</span><span class="p">,</span> <span class="mi">9</span><span class="mf">5.44649</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-674"></a>                                   <span class="mf">0.04748</span><span class="p">,</span>  <span class="mf">0.93369</span><span class="p">,</span>  <span class="mf">9.89867</span><span class="p">,</span><span class="mi">10</span><span class="mf">2.06961</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-675"></a>                                   <span class="mf">0.04660</span><span class="p">,</span>  <span class="mf">0.89912</span><span class="p">,</span>  <span class="mf">9.69785</span><span class="p">,</span><span class="mi">10</span><span class="mf">0.23434</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-676"></a>                                   <span class="mf">0.04323</span><span class="p">,</span>  <span class="mf">0.78798</span><span class="p">,</span>  <span class="mf">8.71624</span><span class="p">,</span> <span class="mi">9</span><span class="mf">2.30811</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-677"></a>                                   <span class="mf">0.04641</span><span class="p">,</span>  <span class="mf">0.85867</span><span class="p">,</span>  <span class="mf">9.51157</span><span class="p">,</span><span class="mi">11</span><span class="mf">1.02754</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-678"></a>                                   <span class="mf">0.04918</span><span class="p">,</span>  <span class="mf">0.87026</span><span class="p">,</span>  <span class="mf">9.41105</span><span class="p">,</span><span class="mi">10</span><span class="mf">4.98576</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-679"></a>                                   <span class="mf">0.03904</span><span class="p">,</span>  <span class="mf">0.72797</span><span class="p">,</span>  <span class="mf">8.00506</span><span class="p">,</span> <span class="mi">8</span><span class="mf">6.41747</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-680"></a>                                   <span class="mf">0.03969</span><span class="p">,</span>  <span class="mf">0.68167</span><span class="p">,</span>  <span class="mf">7.29607</span><span class="p">,</span> <span class="mi">7</span><span class="mf">5.72682</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-681"></a>                                   <span class="mf">0.04291</span><span class="p">,</span>  <span class="mf">0.69956</span><span class="p">,</span>  <span class="mf">7.38554</span><span class="p">,</span> <span class="mi">7</span><span class="mf">7.18528</span><span class="o">/</span><span class="p">),(</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">98</span><span class="o">/</span><span class="p">))</span>
<a name="ln-682"></a>
<a name="ln-683"></a> <span class="n">SYMBOL</span> <span class="o">=</span> <span class="n">SY</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-684"></a> <span class="k">DO </span><span class="n">K</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span>
<a name="ln-685"></a>    <span class="n">A</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">AA</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-686"></a>    <span class="n">B</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">BB</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="n">Z</span><span class="p">)</span>
<a name="ln-687"></a> <span class="k">END DO</span>
<a name="ln-688"></a><span class="k">END SUBROUTINE</span>
<a name="ln-689"></a> 
<a name="ln-690"></a><span class="c">!*******************************************************************</span>
<a name="ln-691"></a>
<a name="ln-692"></a><span class="kt">real </span><span class="k">FUNCTION </span><span class="n">FCORE</span> <span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span><span class="n">ACCVLT</span><span class="p">)</span>
<a name="ln-693"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: FCORE</span>
<a name="ln-694"></a>
<a name="ln-695"></a><span class="c">! modified: 13.01.1992</span>
<a name="ln-696"></a><span class="c">! </span>
<a name="ln-697"></a><span class="c">! Author:</span>
<a name="ln-698"></a><span class="c">! A.Weickenmeier</span>
<a name="ln-699"></a><span class="c">! Technische Hochschule Darmstadt</span>
<a name="ln-700"></a><span class="c">! Hochschulstr. 6</span>
<a name="ln-701"></a><span class="c">! D-6100 Darmstadt</span>
<a name="ln-702"></a><span class="c">! Germany </span>
<a name="ln-703"></a><span class="c">! bitnet: XLTODA6L@DDATHD21.BITNET</span>
<a name="ln-704"></a><span class="c">! Tel.: 06151/16-3381</span>
<a name="ln-705"></a><span class="c">!</span>
<a name="ln-706"></a><span class="c">! CALCULATES APPROXIMATELY THE CORE PART OF THE APSORTION</span>
<a name="ln-707"></a><span class="c">! USING THE APROXIMATION FOR THE MIXED DYNAMIC FORM FACTOR</span>
<a name="ln-708"></a><span class="c">! AND THE X-RAY SCATTERING AMPLITUDE DUE TO</span>
<a name="ln-709"></a><span class="c">! H. ROSE, OPTIK 45  NO.2  (1976) P. 139-158.</span>
<a name="ln-710"></a><span class="c">! </span>
<a name="ln-711"></a><span class="c">! </span>
<a name="ln-712"></a><span class="c">! INPUT:</span>
<a name="ln-713"></a><span class="c">! ======</span>
<a name="ln-714"></a><span class="c">!</span>
<a name="ln-715"></a><span class="c">! G:   SCATTERING VECTOR 4*PI*G = S = SIN(THETA)/LAMBDA</span>
<a name="ln-716"></a><span class="c">! ACCVLT: ACCELERATION VOLTAGE IN KV</span>
<a name="ln-717"></a><span class="c">! Z: ATOM</span>
<a name="ln-718"></a><span class="c">!</span>
<a name="ln-719"></a><span class="c">! OUTPUT:</span>
<a name="ln-720"></a><span class="c">! =======</span>
<a name="ln-721"></a><span class="c">!</span>
<a name="ln-722"></a><span class="c">! FCORE : CORE PART OF ABSORPTION POTENTIAL</span>
<a name="ln-723"></a><span class="c">!</span>
<a name="ln-724"></a><span class="c">! UNITS:</span>
<a name="ln-725"></a><span class="c">! ======</span>
<a name="ln-726"></a><span class="c">!</span>
<a name="ln-727"></a><span class="c">! UNIT OF LENGTH IS ANGSTROEM</span>
<a name="ln-728"></a><span class="c">! </span>
<a name="ln-729"></a><span class="c">!**************************************************************************</span>
<a name="ln-730"></a>
<a name="ln-731"></a><span class="k">use </span><span class="n">io</span>
<a name="ln-732"></a><span class="k">use </span><span class="n">error</span>
<a name="ln-733"></a>
<a name="ln-734"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">),</span><span class="k">parameter</span>  <span class="kd">::</span> <span class="n">PI</span><span class="o">=</span><span class="mf">3.1415927</span><span class="p">,</span><span class="n">A0</span><span class="o">=</span><span class="p">.</span><span class="mi">5289</span>
<a name="ln-735"></a><span class="kt">integer</span>                   <span class="kd">::</span> <span class="n">Z</span>
<a name="ln-736"></a><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">sgl</span><span class="p">)</span>            <span class="kd">::</span> <span class="n">K0</span><span class="p">,</span><span class="n">K2</span><span class="p">,</span><span class="n">KAPPA</span>
<a name="ln-737"></a>
<a name="ln-738"></a><span class="c">! CHECK INPUT</span>
<a name="ln-739"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">Z</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;FCORE&#39;</span><span class="p">,</span><span class="s1">&#39; Z must be positive&#39;</span><span class="p">)</span>
<a name="ln-740"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">G</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;FCORE&#39;</span><span class="p">,</span><span class="s1">&#39; G must be positive&#39;</span><span class="p">)</span>
<a name="ln-741"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">ACCVLT</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">call </span><span class="n">FatalError</span><span class="p">(</span><span class="s1">&#39;FCORE&#39;</span><span class="p">,</span><span class="s1">&#39; ACCVLT must be positive&#39;</span><span class="p">)</span>
<a name="ln-742"></a>
<a name="ln-743"></a><span class="c">! CALCULATE WAVENUMBER </span>
<a name="ln-744"></a> <span class="n">K0</span>   <span class="o">=</span> <span class="p">.</span><span class="mi">5068</span> <span class="o">*</span> <span class="nb">SQRT</span><span class="p">(</span><span class="mi">102</span><span class="mf">2.</span><span class="o">*</span><span class="n">ACCVLT</span> <span class="o">+</span> <span class="n">ACCVLT</span><span class="o">*</span><span class="n">ACCVLT</span><span class="p">)</span>
<a name="ln-745"></a>
<a name="ln-746"></a><span class="c">! CALCULATE CHARACTERISTIC ENERGY LOSS AND ANGLE</span>
<a name="ln-747"></a> <span class="n">DE</span> <span class="o">=</span> <span class="kt">REAL</span> <span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.E-3</span>
<a name="ln-748"></a> <span class="n">THETAE</span> <span class="o">=</span> <span class="n">DE</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">ACCVLT</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">ACCVLT</span><span class="o">+</span><span class="mi">102</span><span class="mf">2.</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ACCVLT</span><span class="o">+</span><span class="mi">102</span><span class="mf">2.</span><span class="p">)</span>
<a name="ln-749"></a>
<a name="ln-750"></a><span class="c">! SCREENING PARAMETER OF YUKAWA-POTENTIAL</span>
<a name="ln-751"></a> <span class="n">R</span> <span class="o">=</span> <span class="mf">0.885</span> <span class="o">*</span> <span class="n">A0</span> <span class="o">/</span> <span class="kt">REAL</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">333333</span>
<a name="ln-752"></a>
<a name="ln-753"></a><span class="c">! CALCULATE NORMALISING ANGLE</span>
<a name="ln-754"></a> <span class="n">TA</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">K0</span> <span class="o">*</span> <span class="n">R</span><span class="p">)</span>
<a name="ln-755"></a>
<a name="ln-756"></a><span class="c">! CALCULATE BRAGG ANGLE</span>
<a name="ln-757"></a> <span class="n">TB</span> <span class="o">=</span> <span class="n">G</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">K0</span><span class="p">)</span>
<a name="ln-758"></a>
<a name="ln-759"></a><span class="c">! NORMALIZE</span>
<a name="ln-760"></a> <span class="n">OMEGA</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">TB</span><span class="o">/</span><span class="n">TA</span>
<a name="ln-761"></a> <span class="n">KAPPA</span> <span class="o">=</span> <span class="n">THETAE</span><span class="o">/</span><span class="n">TA</span>
<a name="ln-762"></a>
<a name="ln-763"></a> <span class="n">K2</span> <span class="o">=</span> <span class="n">KAPPA</span><span class="o">*</span><span class="n">KAPPA</span>
<a name="ln-764"></a> <span class="n">O2</span> <span class="o">=</span> <span class="n">OMEGA</span><span class="o">*</span><span class="n">OMEGA</span>
<a name="ln-765"></a>
<a name="ln-766"></a> <span class="n">X1</span> <span class="o">=</span> <span class="n">OMEGA</span><span class="o">/</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">O2</span><span class="p">)</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="n">O2</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">K2</span><span class="p">))</span><span class="o">*</span><span class="nb">LOG</span><span class="p">((</span><span class="n">OMEGA</span> <span class="o">+</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">O2</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">K2</span> <span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">KAPPA</span><span class="p">))</span>
<a name="ln-767"></a> <span class="n">X2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="nb">SQRT</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">O2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">O2</span><span class="p">)</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">K2</span><span class="o">*</span><span class="n">O2</span><span class="p">)</span><span class="o">*</span><span class="nb">LOG</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">K2</span><span class="o">+</span><span class="n">O2</span><span class="o">+</span><span class="nb">SQRT</span><span class="p">((</span><span class="mf">1.</span><span class="o">+</span><span class="n">O2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">O2</span><span class="p">)</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="n">K2</span><span class="o">*</span><span class="n">O2</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">KAPPA</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">K2</span><span class="p">)))</span> 
<a name="ln-768"></a> <span class="k">IF</span> <span class="p">(</span><span class="n">OMEGA</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="err">1</span><span class="n">E</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-769"></a><span class="k">  </span><span class="n">X3</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">OMEGA</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span> <span class="n">O2</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">K2</span><span class="p">)))</span><span class="o">*</span> <span class="nb">LOG</span><span class="p">((</span><span class="n">OMEGA</span> <span class="o">+</span> <span class="nb">SQRT</span><span class="p">(</span> <span class="n">O2</span><span class="o">+</span><span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">K2</span><span class="p">)))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="nb">SQRT</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">K2</span><span class="p">)))</span> 
<a name="ln-770"></a> <span class="k">ELSE</span>
<a name="ln-771"></a><span class="k">  </span><span class="n">X3</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">K2</span><span class="p">))</span>
<a name="ln-772"></a> <span class="k">END IF</span>
<a name="ln-773"></a>
<a name="ln-774"></a><span class="k"> </span><span class="n">HI</span> <span class="o">=</span> <span class="kt">REAL</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Z</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">TA</span><span class="o">*</span><span class="n">TA</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">X1</span><span class="o">+</span><span class="n">X2</span><span class="o">-</span><span class="n">X3</span><span class="p">)</span>
<a name="ln-775"></a>
<a name="ln-776"></a> <span class="n">FCORE</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">/</span><span class="p">(</span><span class="n">A0</span><span class="o">*</span><span class="n">A0</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.</span><span class="o">*</span><span class="n">PI</span><span class="o">/</span><span class="p">(</span><span class="n">K0</span><span class="o">*</span><span class="n">K0</span><span class="p">)</span> <span class="o">*</span> <span class="n">HI</span>
<a name="ln-777"></a><span class="k">END FUNCTION</span>
<a name="ln-778"></a><span class="c">!</span>
<a name="ln-779"></a><span class="c">! END OF WEICKENMEIER-KOHL SOURCE CODE</span>
<a name="ln-780"></a><span class="c">!</span>
<a name="ln-781"></a>
<a name="ln-782"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-783"></a><span class="c">!</span>
<a name="ln-784"></a><span class="c">! SUBROUTINE:Sort</span>
<a name="ln-785"></a><span class="c">!</span>
<a name="ln-786"></a><span class="c">!&gt; @author Taken from http://www.personal.psu.edu/jhm/f90/examples/sort/sorthalf.f</span>
<a name="ln-787"></a><span class="c">!&gt; @brief sort the array</span>
<a name="ln-788"></a><span class="c">!</span>
<a name="ln-789"></a><span class="c">!&gt; Parameters described in the program</span>
<a name="ln-790"></a><span class="c">!</span>
<a name="ln-791"></a><span class="c">!--------------------------------------------------------------------------</span>
<a name="ln-792"></a><span class="k">RECURSIVE SUBROUTINE </span><span class="n">SSORT</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">KFLAG</span><span class="p">)</span>
<a name="ln-793"></a><span class="c">!DEC$ ATTRIBUTES DLLEXPORT :: SSORT</span>
<a name="ln-794"></a>
<a name="ln-795"></a><span class="c">!***BEGIN PROLOGUE  SSORT</span>
<a name="ln-796"></a><span class="c">!***PURPOSE  Sort an array and optionally make the same interchanges in</span>
<a name="ln-797"></a><span class="c">!            an auxiliary array.  The array may be sorted in increasing</span>
<a name="ln-798"></a><span class="c">!            or decreasing order.  A slightly modified QUICKSORT</span>
<a name="ln-799"></a><span class="c">!            algorithm is used.</span>
<a name="ln-800"></a><span class="c">!***LIBRARY   SLATEC</span>
<a name="ln-801"></a><span class="c">!***CATEGORY  N6A2B</span>
<a name="ln-802"></a><span class="c">!***TYPE      SINGLE PRECISION (SSORT-S, DSORT-D, ISORT-I)</span>
<a name="ln-803"></a><span class="c">!***KEYWORDS  SINGLETON QUICKSORT, SORT, SORTING</span>
<a name="ln-804"></a><span class="c">!***AUTHOR  Jones, R. E., (SNLA)</span>
<a name="ln-805"></a><span class="c">!           Wisniewski, J. A., (SNLA)</span>
<a name="ln-806"></a><span class="c">!***DESCRIPTION</span>
<a name="ln-807"></a><span class="c">!</span>
<a name="ln-808"></a><span class="c">!   SSORT sorts array X and optionally makes the same interchanges in</span>
<a name="ln-809"></a><span class="c">!   array Y.  The array X may be sorted in increasing order or</span>
<a name="ln-810"></a><span class="c">!   decreasing order.  A slightly modified quicksort algorithm is used.</span>
<a name="ln-811"></a><span class="c">!</span>
<a name="ln-812"></a><span class="c">!   Description of Parameters</span>
<a name="ln-813"></a><span class="c">!      X - array of values to be sorted   (usually abscissas)</span>
<a name="ln-814"></a><span class="c">!      Y - array to be (optionally) carried along</span>
<a name="ln-815"></a><span class="c">!      N - number of values in array X to be sorted</span>
<a name="ln-816"></a><span class="c">!      KFLAG - control parameter</span>
<a name="ln-817"></a><span class="c">!            =  2  means sort X in increasing order and carry Y along.</span>
<a name="ln-818"></a><span class="c">!            =  1  means sort X in increasing order (ignoring Y)</span>
<a name="ln-819"></a><span class="c">!            = -1  means sort X in decreasing order (ignoring Y)</span>
<a name="ln-820"></a><span class="c">!            = -2  means sort X in decreasing order and carry Y along.</span>
<a name="ln-821"></a><span class="c">!</span>
<a name="ln-822"></a><span class="c">!***REFERENCES  R. C. Singleton, Algorithm 347, An efficient algorithm</span>
<a name="ln-823"></a><span class="c">!                 for sorting with minimal storage, Communications of</span>
<a name="ln-824"></a><span class="c">!                 the ACM, 12, 3 (1969), pp. 185-187.</span>
<a name="ln-825"></a><span class="c">!***REVISION HISTORY  (YYMMDD)</span>
<a name="ln-826"></a><span class="c">!   761101  DATE WRITTEN</span>
<a name="ln-827"></a><span class="c">!   761118  Modified to use the Singleton quicksort algorithm.  (JAW)</span>
<a name="ln-828"></a><span class="c">!   890531  Changed all specific intrinsics to generic.  (WRB)</span>
<a name="ln-829"></a><span class="c">!   890831  Modified array declarations.  (WRB)</span>
<a name="ln-830"></a><span class="c">!   891009  Removed unreferenced statement labels.  (WRB)</span>
<a name="ln-831"></a><span class="c">!   891024  Changed category.  (WRB)</span>
<a name="ln-832"></a><span class="c">!   891024  REVISION DATE from Version 3.2</span>
<a name="ln-833"></a><span class="c">!   891214  Prologue converted to Version 4.0 format.  (BAB)</span>
<a name="ln-834"></a><span class="c">!   900315  CALLs to XERROR changed to CALLs to XERMSG.  (THJ)</span>
<a name="ln-835"></a><span class="c">!   901012  Declared all variables; changed X,Y to SX,SY. (M. McClain)</span>
<a name="ln-836"></a><span class="c">!   920501  Reformatted the REFERENCES section.  (DWL, WRB)</span>
<a name="ln-837"></a><span class="c">!   920519  Clarified error messages.  (DWL)</span>
<a name="ln-838"></a><span class="c">!   920801  Declarations section rebuilt and code restructured to use</span>
<a name="ln-839"></a><span class="c">!           IF-THEN-ELSE-ENDIF.  (RWC, WRB)</span>
<a name="ln-840"></a><span class="c">!***END PROLOGUE  SSORT</span>
<a name="ln-841"></a><span class="c">!     .. Scalar Arguments ..</span>
<a name="ln-842"></a><span class="kt">INTEGER </span><span class="n">KFLAG</span><span class="p">,</span> <span class="n">N</span>
<a name="ln-843"></a><span class="c">!     .. Array Arguments ..</span>
<a name="ln-844"></a><span class="kt">REAL </span><span class="n">X</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-845"></a><span class="kt">INTEGER </span><span class="n">Y</span><span class="p">(</span><span class="o">*</span><span class="p">)</span>
<a name="ln-846"></a><span class="c">!     .. Local Scalars ..</span>
<a name="ln-847"></a><span class="kt">REAL </span><span class="n">R</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">TT</span><span class="p">,</span> <span class="n">TTY</span><span class="p">,</span> <span class="n">TY</span>
<a name="ln-848"></a><span class="kt">INTEGER </span><span class="n">I</span><span class="p">,</span> <span class="n">IJ</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">KK</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">NN</span>
<a name="ln-849"></a><span class="c">!     .. Local Arrays ..</span>
<a name="ln-850"></a><span class="kt">INTEGER </span><span class="n">IL</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span> <span class="n">IU</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-851"></a><span class="c">!     .. External Subroutines ..</span>
<a name="ln-852"></a><span class="c">!     None</span>
<a name="ln-853"></a><span class="c">!     .. Intrinsic Functions ..</span>
<a name="ln-854"></a><span class="k">INTRINSIC </span><span class="nb">ABS</span><span class="p">,</span> <span class="nb">INT</span>
<a name="ln-855"></a><span class="c">!***FIRST EXECUTABLE STATEMENT  SSORT</span>
<a name="ln-856"></a><span class="n">NN</span> <span class="o">=</span> <span class="n">N</span>
<a name="ln-857"></a><span class="k">IF</span> <span class="p">(</span><span class="n">NN</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-858"></a><span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span>      <span class="s1">&#39;The number of values to be sorted is not positive.&#39;</span>
<a name="ln-859"></a><span class="k">RETURN</span>
<a name="ln-860"></a><span class="n">ENDIF</span>
<a name="ln-861"></a><span class="c">!</span>
<a name="ln-862"></a><span class="n">KK</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">KFLAG</span><span class="p">)</span>
<a name="ln-863"></a><span class="k">IF</span> <span class="p">(</span><span class="n">KK</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">1</span> <span class="p">.</span><span class="nb">AND</span><span class="p">.</span> <span class="n">KK</span><span class="p">.</span><span class="n">NE</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-864"></a><span class="k">PRINT</span> <span class="o">*</span><span class="p">,</span>      <span class="s1">&#39;The sort control parameter, K, is not 2, 1, -1, or -2.&#39;</span>
<a name="ln-865"></a><span class="k">RETURN</span>
<a name="ln-866"></a><span class="n">ENDIF</span>
<a name="ln-867"></a><span class="c">!</span>
<a name="ln-868"></a><span class="c">!     Alter array X to get decreasing order if needed</span>
<a name="ln-869"></a><span class="c">!</span>
<a name="ln-870"></a><span class="k">IF</span> <span class="p">(</span><span class="n">KFLAG</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-871"></a><span class="k">DO </span><span class="mi">10</span> <span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span>
<a name="ln-872"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-873"></a><span class="mi">10</span>    <span class="k">CONTINUE</span>
<a name="ln-874"></a><span class="n">ENDIF</span>
<a name="ln-875"></a><span class="c">!</span>
<a name="ln-876"></a><span class="k">IF</span> <span class="p">(</span><span class="n">KK</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">100</span>
<a name="ln-877"></a><span class="c">!</span>
<a name="ln-878"></a><span class="c">!     Sort X only</span>
<a name="ln-879"></a><span class="c">!</span>
<a name="ln-880"></a><span class="n">M</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-881"></a><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-882"></a><span class="n">J</span> <span class="o">=</span> <span class="n">NN</span>
<a name="ln-883"></a><span class="n">R</span> <span class="o">=</span> <span class="mf">0.375E0</span>
<a name="ln-884"></a><span class="c">!</span>
<a name="ln-885"></a><span class="mi">20</span> <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">J</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">60</span>
<a name="ln-886"></a><span class="k">IF</span> <span class="p">(</span><span class="n">R</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.5898437E0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-887"></a><span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="o">+</span><span class="mf">3.90625E-2</span>
<a name="ln-888"></a><span class="k">ELSE</span>
<a name="ln-889"></a><span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="o">-</span><span class="mf">0.21875E0</span>
<a name="ln-890"></a><span class="n">ENDIF</span>
<a name="ln-891"></a><span class="c">!</span>
<a name="ln-892"></a><span class="mi">30</span> <span class="n">K</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-893"></a><span class="c">!</span>
<a name="ln-894"></a><span class="c">!     Select a central element of the array and save it in location T</span>
<a name="ln-895"></a><span class="c">!</span>
<a name="ln-896"></a><span class="n">IJ</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">((</span><span class="n">J</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="p">)</span>
<a name="ln-897"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-898"></a><span class="c">!</span>
<a name="ln-899"></a><span class="c">!     If first element of array is greater than T, interchange with T</span>
<a name="ln-900"></a><span class="c">!</span>
<a name="ln-901"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-902"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-903"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-904"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-905"></a><span class="n">ENDIF</span>
<a name="ln-906"></a><span class="n">L</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-907"></a><span class="c">!</span>
<a name="ln-908"></a><span class="c">!     If last element of array is less than than T, interchange with T</span>
<a name="ln-909"></a><span class="c">!</span>
<a name="ln-910"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-911"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-912"></a><span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-913"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-914"></a><span class="c">!</span>
<a name="ln-915"></a><span class="c">!        If first element of array is greater than T, interchange with T</span>
<a name="ln-916"></a><span class="c">!</span>
<a name="ln-917"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-918"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-919"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-920"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-921"></a><span class="n">ENDIF</span>
<a name="ln-922"></a><span class="n">ENDIF</span>
<a name="ln-923"></a><span class="c">!</span>
<a name="ln-924"></a><span class="c">!     Find an element in the second half of the array which is smaller</span>
<a name="ln-925"></a><span class="c">!     than T</span>
<a name="ln-926"></a><span class="c">!</span>
<a name="ln-927"></a><span class="mi">40</span> <span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-928"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">40</span>
<a name="ln-929"></a><span class="c">!</span>
<a name="ln-930"></a><span class="c">!     Find an element in the first half of the array which is greater</span>
<a name="ln-931"></a><span class="c">!     than T</span>
<a name="ln-932"></a><span class="c">!</span>
<a name="ln-933"></a><span class="mi">50</span> <span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-934"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">50</span>
<a name="ln-935"></a><span class="c">!</span>
<a name="ln-936"></a><span class="c">!     Interchange these elements</span>
<a name="ln-937"></a><span class="c">!</span>
<a name="ln-938"></a><span class="k">IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-939"></a><span class="n">TT</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<a name="ln-940"></a><span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-941"></a><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">TT</span>
<a name="ln-942"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">40</span>
<a name="ln-943"></a><span class="n">ENDIF</span>
<a name="ln-944"></a><span class="c">!</span>
<a name="ln-945"></a><span class="c">!     Save upper and lower subscripts of the array yet to be sorted</span>
<a name="ln-946"></a><span class="c">!</span>
<a name="ln-947"></a><span class="k">IF</span> <span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">I</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">J</span><span class="o">-</span><span class="n">K</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-948"></a><span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-949"></a><span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">L</span>
<a name="ln-950"></a><span class="n">I</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-951"></a><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-952"></a><span class="k">ELSE</span>
<a name="ln-953"></a><span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-954"></a><span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-955"></a><span class="n">J</span> <span class="o">=</span> <span class="n">L</span>
<a name="ln-956"></a><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-957"></a><span class="n">ENDIF</span>
<a name="ln-958"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">70</span>
<a name="ln-959"></a><span class="c">!</span>
<a name="ln-960"></a><span class="c">!     Begin again on another portion of the unsorted array</span>
<a name="ln-961"></a><span class="c">!</span>
<a name="ln-962"></a><span class="mi">60</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-963"></a><span class="k">IF</span> <span class="p">(</span><span class="n">M</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">190</span>
<a name="ln-964"></a><span class="n">I</span> <span class="o">=</span> <span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-965"></a><span class="n">J</span> <span class="o">=</span> <span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-966"></a><span class="c">!</span>
<a name="ln-967"></a><span class="mi">70</span> <span class="k">IF</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="n">I</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">30</span>
<a name="ln-968"></a><span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">20</span>
<a name="ln-969"></a><span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-970"></a><span class="c">!</span>
<a name="ln-971"></a><span class="mi">80</span> <span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-972"></a><span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">J</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">60</span>
<a name="ln-973"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-974"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">80</span>
<a name="ln-975"></a><span class="n">K</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-976"></a><span class="c">!</span>
<a name="ln-977"></a><span class="mi">90</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-978"></a><span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-979"></a><span class="k">IF</span> <span class="p">(</span><span class="n">T</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">90</span>
<a name="ln-980"></a><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-981"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">80</span>
<a name="ln-982"></a><span class="c">!</span>
<a name="ln-983"></a><span class="c">!     Sort X and carry Y along</span>
<a name="ln-984"></a><span class="c">!</span>
<a name="ln-985"></a><span class="mi">100</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-986"></a><span class="n">I</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-987"></a><span class="n">J</span> <span class="o">=</span> <span class="n">NN</span>
<a name="ln-988"></a><span class="n">R</span> <span class="o">=</span> <span class="mf">0.375E0</span>
<a name="ln-989"></a><span class="c">!</span>
<a name="ln-990"></a><span class="mi">110</span> <span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">J</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">150</span>
<a name="ln-991"></a><span class="k">IF</span> <span class="p">(</span><span class="n">R</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="mf">0.5898437E0</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-992"></a><span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="o">+</span><span class="mf">3.90625E-2</span>
<a name="ln-993"></a><span class="k">ELSE</span>
<a name="ln-994"></a><span class="n">R</span> <span class="o">=</span> <span class="n">R</span><span class="o">-</span><span class="mf">0.21875E0</span>
<a name="ln-995"></a><span class="n">ENDIF</span>
<a name="ln-996"></a><span class="c">!</span>
<a name="ln-997"></a><span class="mi">120</span> <span class="n">K</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-998"></a><span class="c">!</span>
<a name="ln-999"></a><span class="c">!     Select a central element of the array and save it in location T</span>
<a name="ln-1000"></a><span class="c">!</span>
<a name="ln-1001"></a><span class="n">IJ</span> <span class="o">=</span> <span class="n">I</span> <span class="o">+</span> <span class="nb">INT</span><span class="p">((</span><span class="n">J</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">*</span><span class="n">R</span><span class="p">)</span>
<a name="ln-1002"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1003"></a><span class="n">TY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1004"></a><span class="c">!</span>
<a name="ln-1005"></a><span class="c">!     If first element of array is greater than T, interchange with T</span>
<a name="ln-1006"></a><span class="c">!</span>
<a name="ln-1007"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1008"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1009"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-1010"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1011"></a><span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1012"></a><span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">TY</span>
<a name="ln-1013"></a><span class="n">TY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1014"></a><span class="n">ENDIF</span>
<a name="ln-1015"></a><span class="n">L</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-1016"></a><span class="c">!</span>
<a name="ln-1017"></a><span class="c">!     If last element of array is less than T, interchange with T</span>
<a name="ln-1018"></a><span class="c">!</span>
<a name="ln-1019"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1020"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-1021"></a><span class="n">X</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-1022"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1023"></a><span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<a name="ln-1024"></a><span class="n">Y</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">=</span> <span class="n">TY</span>
<a name="ln-1025"></a><span class="n">TY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1026"></a><span class="c">!</span>
<a name="ln-1027"></a><span class="c">!        If first element of array is greater than T, interchange with T</span>
<a name="ln-1028"></a><span class="c">!</span>
<a name="ln-1029"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1030"></a><span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1031"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-1032"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1033"></a><span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1034"></a><span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="n">TY</span>
<a name="ln-1035"></a><span class="n">TY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">IJ</span><span class="p">)</span>
<a name="ln-1036"></a><span class="n">ENDIF</span>
<a name="ln-1037"></a><span class="n">ENDIF</span>
<a name="ln-1038"></a><span class="c">!</span>
<a name="ln-1039"></a><span class="c">!     Find an element in the second half of the array which is smaller</span>
<a name="ln-1040"></a><span class="c">!     than T</span>
<a name="ln-1041"></a><span class="c">!</span>
<a name="ln-1042"></a><span class="mi">130</span> <span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1043"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">130</span>
<a name="ln-1044"></a><span class="c">!</span>
<a name="ln-1045"></a><span class="c">!     Find an element in the first half of the array which is greater</span>
<a name="ln-1046"></a><span class="c">!     than T</span>
<a name="ln-1047"></a><span class="c">!</span>
<a name="ln-1048"></a><span class="mi">140</span> <span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1049"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">140</span>
<a name="ln-1050"></a><span class="c">!</span>
<a name="ln-1051"></a><span class="c">!     Interchange these elements</span>
<a name="ln-1052"></a><span class="c">!</span>
<a name="ln-1053"></a><span class="k">IF</span> <span class="p">(</span><span class="n">K</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">L</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1054"></a><span class="n">TT</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<a name="ln-1055"></a><span class="n">X</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-1056"></a><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">TT</span>
<a name="ln-1057"></a><span class="n">TTY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<a name="ln-1058"></a><span class="n">Y</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-1059"></a><span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="o">=</span> <span class="n">TTY</span>
<a name="ln-1060"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">130</span>
<a name="ln-1061"></a><span class="n">ENDIF</span>
<a name="ln-1062"></a><span class="c">!</span>
<a name="ln-1063"></a><span class="c">!     Save upper and lower subscripts of the array yet to be sorted</span>
<a name="ln-1064"></a><span class="c">!</span>
<a name="ln-1065"></a><span class="k">IF</span> <span class="p">(</span><span class="n">L</span><span class="o">-</span><span class="n">I</span> <span class="p">.</span><span class="n">GT</span><span class="p">.</span> <span class="n">J</span><span class="o">-</span><span class="n">K</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1066"></a><span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-1067"></a><span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">L</span>
<a name="ln-1068"></a><span class="n">I</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-1069"></a><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1070"></a><span class="k">ELSE</span>
<a name="ln-1071"></a><span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">K</span>
<a name="ln-1072"></a><span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">=</span> <span class="n">J</span>
<a name="ln-1073"></a><span class="n">J</span> <span class="o">=</span> <span class="n">L</span>
<a name="ln-1074"></a><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1075"></a><span class="n">ENDIF</span>
<a name="ln-1076"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">160</span>
<a name="ln-1077"></a><span class="c">!</span>
<a name="ln-1078"></a><span class="c">!     Begin again on another portion of the unsorted array</span>
<a name="ln-1079"></a><span class="c">!</span>
<a name="ln-1080"></a><span class="mi">150</span> <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1081"></a><span class="k">IF</span> <span class="p">(</span><span class="n">M</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">190</span>
<a name="ln-1082"></a><span class="n">I</span> <span class="o">=</span> <span class="n">IL</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-1083"></a><span class="n">J</span> <span class="o">=</span> <span class="n">IU</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<a name="ln-1084"></a><span class="c">!</span>
<a name="ln-1085"></a><span class="mi">160</span> <span class="k">IF</span> <span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="n">I</span> <span class="p">.</span><span class="n">GE</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">120</span>
<a name="ln-1086"></a><span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">110</span>
<a name="ln-1087"></a><span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1088"></a><span class="c">!</span>
<a name="ln-1089"></a><span class="mi">170</span> <span class="n">I</span> <span class="o">=</span> <span class="n">I</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-1090"></a><span class="k">IF</span> <span class="p">(</span><span class="n">I</span> <span class="p">.</span><span class="n">EQ</span><span class="p">.</span> <span class="n">J</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">150</span>
<a name="ln-1091"></a><span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1092"></a><span class="n">TY</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">I</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1093"></a><span class="k">IF</span> <span class="p">(</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="n">T</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">170</span>
<a name="ln-1094"></a><span class="n">K</span> <span class="o">=</span> <span class="n">I</span>
<a name="ln-1095"></a><span class="c">!</span>
<a name="ln-1096"></a><span class="mi">180</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-1097"></a><span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<a name="ln-1098"></a><span class="n">K</span> <span class="o">=</span> <span class="n">K</span><span class="o">-</span><span class="mi">1</span>
<a name="ln-1099"></a><span class="k">IF</span> <span class="p">(</span><span class="n">T</span> <span class="p">.</span><span class="n">LT</span><span class="p">.</span> <span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">180</span>
<a name="ln-1100"></a><span class="n">X</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">T</span>
<a name="ln-1101"></a><span class="n">Y</span><span class="p">(</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">TY</span>
<a name="ln-1102"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">170</span>
<a name="ln-1103"></a><span class="c">!</span>
<a name="ln-1104"></a><span class="c">!     Clean up</span>
<a name="ln-1105"></a><span class="c">!</span>
<a name="ln-1106"></a><span class="mi">190</span> <span class="k">IF</span> <span class="p">(</span><span class="n">KFLAG</span> <span class="p">.</span><span class="n">LE</span><span class="p">.</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1107"></a><span class="k">DO </span><span class="mi">200</span> <span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span>
<a name="ln-1108"></a><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<a name="ln-1109"></a><span class="mi">200</span>    <span class="k">CONTINUE</span>
<a name="ln-1110"></a><span class="n">ENDIF</span>
<a name="ln-1111"></a><span class="k">RETURN</span>
<a name="ln-1112"></a><span class="k">END</span>
<a name="ln-1113"></a>
<a name="ln-1114"></a><span class="k">SUBROUTINE </span><span class="n">qsortd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">ind</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1115"></a> 
<a name="ln-1116"></a><span class="c">! Code converted using TO_F90 by Alan Miller</span>
<a name="ln-1117"></a><span class="c">! Date: 2002-12-18  Time: 11:55:47</span>
<a name="ln-1118"></a>
<a name="ln-1119"></a><span class="k">IMPLICIT NONE</span>
<a name="ln-1120"></a>
<a name="ln-1121"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">n</span>
<a name="ln-1122"></a><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span><span class="p">,</span>  <span class="k">INTENT</span><span class="p">(</span><span class="n">IN</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">x</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1123"></a><span class="kt">INTEGER</span><span class="p">,</span> <span class="k">INTENT</span><span class="p">(</span><span class="n">OUT</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">ind</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-1124"></a>
<a name="ln-1125"></a><span class="c">!***************************************************************************</span>
<a name="ln-1126"></a>
<a name="ln-1127"></a><span class="c">!                                                         ROBERT RENKA</span>
<a name="ln-1128"></a><span class="c">!                                                 OAK RIDGE NATL. LAB.</span>
<a name="ln-1129"></a>
<a name="ln-1130"></a><span class="c">!   THIS SUBROUTINE USES AN ORDER N*LOG(N) QUICK SORT TO SORT A REAL (dp)</span>
<a name="ln-1131"></a><span class="c">! ARRAY X INTO INCREASING ORDER.  THE ALGORITHM IS AS FOLLOWS.  IND IS</span>
<a name="ln-1132"></a><span class="c">! INITIALIZED TO THE ORDERED SEQUENCE OF INDICES 1,...,N, AND ALL INTERCHANGES</span>
<a name="ln-1133"></a><span class="c">! ARE APPLIED TO IND.  X IS DIVIDED INTO TWO PORTIONS BY PICKING A CENTRAL</span>
<a name="ln-1134"></a><span class="c">! ELEMENT T.  THE FIRST AND LAST ELEMENTS ARE COMPARED WITH T, AND</span>
<a name="ln-1135"></a><span class="c">! INTERCHANGES ARE APPLIED AS NECESSARY SO THAT THE THREE VALUES ARE IN</span>
<a name="ln-1136"></a><span class="c">! ASCENDING ORDER.  INTERCHANGES ARE THEN APPLIED SO THAT ALL ELEMENTS</span>
<a name="ln-1137"></a><span class="c">! GREATER THAN T ARE IN THE UPPER PORTION OF THE ARRAY AND ALL ELEMENTS</span>
<a name="ln-1138"></a><span class="c">! LESS THAN T ARE IN THE LOWER PORTION.  THE UPPER AND LOWER INDICES OF ONE</span>
<a name="ln-1139"></a><span class="c">! OF THE PORTIONS ARE SAVED IN LOCAL ARRAYS, AND THE PROCESS IS REPEATED</span>
<a name="ln-1140"></a><span class="c">! ITERATIVELY ON THE OTHER PORTION.  WHEN A PORTION IS COMPLETELY SORTED,</span>
<a name="ln-1141"></a><span class="c">! THE PROCESS BEGINS AGAIN BY RETRIEVING THE INDICES BOUNDING ANOTHER</span>
<a name="ln-1142"></a><span class="c">! UNSORTED PORTION.</span>
<a name="ln-1143"></a>
<a name="ln-1144"></a><span class="c">! INPUT PARAMETERS -   N - LENGTH OF THE ARRAY X.</span>
<a name="ln-1145"></a>
<a name="ln-1146"></a><span class="c">!                      X - VECTOR OF LENGTH N TO BE SORTED.</span>
<a name="ln-1147"></a>
<a name="ln-1148"></a><span class="c">!                    IND - VECTOR OF LENGTH &gt;= N.</span>
<a name="ln-1149"></a>
<a name="ln-1150"></a><span class="c">! N AND X ARE NOT ALTERED BY THIS ROUTINE.</span>
<a name="ln-1151"></a>
<a name="ln-1152"></a><span class="c">! OUTPUT PARAMETER - IND - SEQUENCE OF INDICES 1,...,N PERMUTED IN THE SAME</span>
<a name="ln-1153"></a><span class="c">!                          FASHION AS X WOULD BE.  THUS, THE ORDERING ON</span>
<a name="ln-1154"></a><span class="c">!                          X IS DEFINED BY Y(I) = X(IND(I)).</span>
<a name="ln-1155"></a>
<a name="ln-1156"></a><span class="c">!*********************************************************************</span>
<a name="ln-1157"></a>
<a name="ln-1158"></a><span class="c">! NOTE -- IU AND IL MUST BE DIMENSIONED &gt;= LOG(N) WHERE LOG HAS BASE 2.</span>
<a name="ln-1159"></a>
<a name="ln-1160"></a><span class="c">!*********************************************************************</span>
<a name="ln-1161"></a>
<a name="ln-1162"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">iu</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span> <span class="n">il</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<a name="ln-1163"></a><span class="kt">INTEGER</span>   <span class="kd">::</span> <span class="n">m</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">ij</span><span class="p">,</span> <span class="n">it</span><span class="p">,</span> <span class="n">itt</span><span class="p">,</span> <span class="n">indx</span>
<a name="ln-1164"></a><span class="kt">REAL</span>      <span class="kd">::</span> <span class="n">r</span>
<a name="ln-1165"></a><span class="kt">REAL</span><span class="o">*</span><span class="mi">8</span>    <span class="kd">::</span> <span class="n">t</span>
<a name="ln-1166"></a>
<a name="ln-1167"></a><span class="c">! LOCAL PARAMETERS -</span>
<a name="ln-1168"></a>
<a name="ln-1169"></a><span class="c">! IU,IL =  TEMPORARY STORAGE FOR THE UPPER AND LOWER</span>
<a name="ln-1170"></a><span class="c">!            INDICES OF PORTIONS OF THE ARRAY X</span>
<a name="ln-1171"></a><span class="c">! M =      INDEX FOR IU AND IL</span>
<a name="ln-1172"></a><span class="c">! I,J =    LOWER AND UPPER INDICES OF A PORTION OF X</span>
<a name="ln-1173"></a><span class="c">! K,L =    INDICES IN THE RANGE I,...,J</span>
<a name="ln-1174"></a><span class="c">! IJ =     RANDOMLY CHOSEN INDEX BETWEEN I AND J</span>
<a name="ln-1175"></a><span class="c">! IT,ITT = TEMPORARY STORAGE FOR INTERCHANGES IN IND</span>
<a name="ln-1176"></a><span class="c">! INDX =   TEMPORARY INDEX FOR X</span>
<a name="ln-1177"></a><span class="c">! R =      PSEUDO RANDOM NUMBER FOR GENERATING IJ</span>
<a name="ln-1178"></a><span class="c">! T =      CENTRAL ELEMENT OF X</span>
<a name="ln-1179"></a>
<a name="ln-1180"></a><span class="k">IF</span> <span class="p">(</span><span class="n">n</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1181"></a>
<a name="ln-1182"></a><span class="c">! INITIALIZE IND, M, I, J, AND R</span>
<a name="ln-1183"></a>
<a name="ln-1184"></a><span class="k">DO  </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-1185"></a>  <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-1186"></a><span class="k">END DO</span>
<a name="ln-1187"></a><span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1188"></a><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-1189"></a><span class="n">j</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-1190"></a><span class="n">r</span> <span class="o">=</span> <span class="p">.</span><span class="mi">375</span>
<a name="ln-1191"></a>
<a name="ln-1192"></a><span class="c">! TOP OF LOOP</span>
<a name="ln-1193"></a>
<a name="ln-1194"></a><span class="mi">20</span> <span class="k">IF</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="n">j</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">70</span>
<a name="ln-1195"></a><span class="k">IF</span> <span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="p">.</span><span class="mi">5898437</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1196"></a><span class="k">  </span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="p">.</span><span class="mi">0390625</span>
<a name="ln-1197"></a><span class="k">ELSE</span>
<a name="ln-1198"></a><span class="k">  </span><span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">-</span> <span class="p">.</span><span class="mi">21875</span>
<a name="ln-1199"></a><span class="k">END IF</span>
<a name="ln-1200"></a>
<a name="ln-1201"></a><span class="c">! INITIALIZE K</span>
<a name="ln-1202"></a>
<a name="ln-1203"></a><span class="mi">30</span> <span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-1204"></a>
<a name="ln-1205"></a><span class="c">! SELECT A CENTRAL ELEMENT OF X AND SAVE IT IN T</span>
<a name="ln-1206"></a>
<a name="ln-1207"></a><span class="n">ij</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">r</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1208"></a><span class="n">it</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">ij</span><span class="p">)</span>
<a name="ln-1209"></a><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-1210"></a>
<a name="ln-1211"></a><span class="c">! IF THE FIRST ELEMENT OF THE ARRAY IS GREATER THAN T,</span>
<a name="ln-1212"></a><span class="c">!   INTERCHANGE IT WITH T</span>
<a name="ln-1213"></a>
<a name="ln-1214"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1215"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1216"></a><span class="k">  </span><span class="n">ind</span><span class="p">(</span><span class="n">ij</span><span class="p">)</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1217"></a>  <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">it</span>
<a name="ln-1218"></a>  <span class="n">it</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1219"></a>  <span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-1220"></a><span class="k">END IF</span>
<a name="ln-1221"></a>
<a name="ln-1222"></a><span class="c">! INITIALIZE L</span>
<a name="ln-1223"></a>
<a name="ln-1224"></a><span class="n">l</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-1225"></a>
<a name="ln-1226"></a><span class="c">! IF THE LAST ELEMENT OF THE ARRAY IS LESS THAN T,</span>
<a name="ln-1227"></a><span class="c">!   INTERCHANGE IT WITH T</span>
<a name="ln-1228"></a>
<a name="ln-1229"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<a name="ln-1230"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">50</span>
<a name="ln-1231"></a><span class="n">ind</span><span class="p">(</span><span class="n">ij</span><span class="p">)</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1232"></a><span class="n">ind</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">it</span>
<a name="ln-1233"></a><span class="n">it</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1234"></a><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-1235"></a>
<a name="ln-1236"></a><span class="c">! IF THE FIRST ELEMENT OF THE ARRAY IS GREATER THAN T,</span>
<a name="ln-1237"></a><span class="c">!   INTERCHANGE IT WITH T</span>
<a name="ln-1238"></a>
<a name="ln-1239"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1240"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">50</span>
<a name="ln-1241"></a><span class="n">ind</span><span class="p">(</span><span class="n">ij</span><span class="p">)</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1242"></a><span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">it</span>
<a name="ln-1243"></a><span class="n">it</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1244"></a><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<a name="ln-1245"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">50</span>
<a name="ln-1246"></a>
<a name="ln-1247"></a><span class="c">! INTERCHANGE ELEMENTS K AND L</span>
<a name="ln-1248"></a>
<a name="ln-1249"></a><span class="mi">40</span> <span class="n">itt</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-1250"></a><span class="n">ind</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-1251"></a><span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">itt</span>
<a name="ln-1252"></a>
<a name="ln-1253"></a><span class="c">! FIND AN ELEMENT IN THE UPPER PART OF THE ARRAY WHICH IS</span>
<a name="ln-1254"></a><span class="c">!   NOT LARGER THAN T</span>
<a name="ln-1255"></a>
<a name="ln-1256"></a><span class="mi">50</span> <span class="n">l</span> <span class="o">=</span> <span class="n">l</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1257"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<a name="ln-1258"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">50</span>
<a name="ln-1259"></a>
<a name="ln-1260"></a><span class="c">! FIND AN ELEMENT IN THE LOWER PART OF THE ARRAY WHCIH IS NOT SMALLER THAN T</span>
<a name="ln-1261"></a>
<a name="ln-1262"></a><span class="mi">60</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1263"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-1264"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">60</span>
<a name="ln-1265"></a>
<a name="ln-1266"></a><span class="c">! IF K &lt;= L, INTERCHANGE ELEMENTS K AND L</span>
<a name="ln-1267"></a>
<a name="ln-1268"></a><span class="k">IF</span> <span class="p">(</span><span class="n">k</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">40</span>
<a name="ln-1269"></a>
<a name="ln-1270"></a><span class="c">! SAVE THE UPPER AND LOWER SUBSCRIPTS OF THE PORTION OF THE</span>
<a name="ln-1271"></a><span class="c">!   ARRAY YET TO BE SORTED</span>
<a name="ln-1272"></a>
<a name="ln-1273"></a><span class="k">IF</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="n">i</span> <span class="o">&gt;</span> <span class="n">j</span><span class="o">-</span><span class="n">k</span><span class="p">)</span> <span class="k">THEN</span>
<a name="ln-1274"></a><span class="k">  </span><span class="n">il</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-1275"></a>  <span class="n">iu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-1276"></a>  <span class="n">i</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-1277"></a>  <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1278"></a>  <span class="n">GO</span> <span class="n">TO</span> <span class="mi">80</span>
<a name="ln-1279"></a><span class="k">END IF</span>
<a name="ln-1280"></a>
<a name="ln-1281"></a><span class="n">il</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">k</span>
<a name="ln-1282"></a><span class="n">iu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">=</span> <span class="n">j</span>
<a name="ln-1283"></a><span class="n">j</span> <span class="o">=</span> <span class="n">l</span>
<a name="ln-1284"></a><span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1285"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">80</span>
<a name="ln-1286"></a>
<a name="ln-1287"></a><span class="c">! BEGIN AGAIN ON ANOTHER UNSORTED PORTION OF THE ARRAY</span>
<a name="ln-1288"></a>
<a name="ln-1289"></a><span class="mi">70</span> <span class="n">m</span> <span class="o">=</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1290"></a><span class="k">IF</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>
<a name="ln-1291"></a><span class="n">i</span> <span class="o">=</span> <span class="n">il</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a name="ln-1292"></a><span class="n">j</span> <span class="o">=</span> <span class="n">iu</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<a name="ln-1293"></a>
<a name="ln-1294"></a><span class="mi">80</span> <span class="k">IF</span> <span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">11</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">30</span>
<a name="ln-1295"></a><span class="k">IF</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">20</span>
<a name="ln-1296"></a><span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1297"></a>
<a name="ln-1298"></a><span class="c">! SORT ELEMENTS I+1,...,J.  NOTE THAT 1 &lt;= I &lt; J AND J-I &lt; 11.</span>
<a name="ln-1299"></a>
<a name="ln-1300"></a><span class="mi">90</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-1301"></a><span class="k">IF</span> <span class="p">(</span><span class="n">i</span> <span class="o">==</span> <span class="n">j</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">70</span>
<a name="ln-1302"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-1303"></a><span class="n">t</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span>
<a name="ln-1304"></a><span class="n">it</span> <span class="o">=</span> <span class="n">indx</span>
<a name="ln-1305"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-1306"></a><span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">t</span><span class="p">)</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">90</span>
<a name="ln-1307"></a><span class="n">k</span> <span class="o">=</span> <span class="n">i</span>
<a name="ln-1308"></a>
<a name="ln-1309"></a><span class="mi">100</span> <span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-1310"></a><span class="n">k</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-1311"></a><span class="n">indx</span> <span class="o">=</span> <span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-1312"></a><span class="k">IF</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">(</span><span class="n">indx</span><span class="p">))</span> <span class="n">GO</span> <span class="n">TO</span> <span class="mi">100</span>
<a name="ln-1313"></a>
<a name="ln-1314"></a><span class="n">ind</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">it</span>
<a name="ln-1315"></a><span class="n">GO</span> <span class="n">TO</span> <span class="mi">90</span>
<a name="ln-1316"></a><span class="k">END SUBROUTINE </span><span class="n">qsortd</span>
<a name="ln-1317"></a>
<a name="ln-1318"></a>
<a name="ln-1319"></a><span class="k">end module </span><span class="n">others</span>
</pre></div>

    </section>
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allfiles-1">All Source Files</a></h3></div>
  <div id="allfiles-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../sourcefile/apb.f90.html">apb.f90</a>
      
      <a class="list-group-item" href="../sourcefile/bobyqa.f90.html">bobyqa.f90</a>
      
      <a class="list-group-item" href="../sourcefile/bobyqa_refinement.f90.html">bobyqa_refinement.f90</a>
      
      <a class="list-group-item" href="../sourcefile/clsupport.f90.html">CLsupport.f90</a>
      
      <a class="list-group-item" href="../sourcefile/constants.f90.html">constants.f90</a>
      
      <a class="list-group-item" href="../sourcefile/defectmodule.f90.html">defectmodule.f90</a>
      
      <a class="list-group-item" href="../sourcefile/dictmod.f90.html">dictmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/dispfield.f90.html">dispfield.f90</a>
      
      <a class="list-group-item" href="../sourcefile/distortion.f90.html">distortion.f90</a>
      
      <a class="list-group-item" href="../sourcefile/eccimod.f90.html">ECCImod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/eispack.f90.html">eispack.f90</a>
      
      <a class="list-group-item" href="../sourcefile/emdymod.f90.html">EMdymod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/filters.f90.html">filters.f90</a>
      
      <a class="list-group-item" href="../sourcefile/hdftest.f90.html">hdftest.f90</a>
      
      <a class="list-group-item" href="../sourcefile/indexingmod.f90.html">Indexingmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/initializers.f90.html">initializers.f90</a>
      
      <a class="list-group-item" href="../sourcefile/jsonsupport.f90.html">JSONsupport.f90</a>
      
      <a class="list-group-item" href="../sourcefile/muellercalculus.f90.html">MuellerCalculus.f90</a>
      
      <a class="list-group-item" href="../sourcefile/multibeams.f90.html">multibeams.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelisthandlers.f90.html">NameListHandlers.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelistjsonwriters.f90.html">NameListJSONwriters.f90</a>
      
      <a class="list-group-item" href="../sourcefile/namelisttypedefs.f90.html">NameListTypedefs.f90</a>
      
      <a class="list-group-item" href="../sourcefile/noise.f90.html">noise.f90</a>
      
      <a class="list-group-item" href="../sourcefile/others.f90.html">others.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pedmod.f90.html">PEDmod.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pfinversion.f90.html">PFInversion.f90</a>
      
      <a class="list-group-item" href="../sourcefile/pgm.f90.html">pgm.f90</a>
      
      <a class="list-group-item" href="../sourcefile/povray.f90.html">povray.f90</a>
      
      <a class="list-group-item" href="../sourcefile/rng.f90.html">rng.f90</a>
      
      <a class="list-group-item" href="../sourcefile/simulated_annealing.f90.html">simulated_annealing.f90</a>
      
      <a class="list-group-item" href="../sourcefile/so3.f90.html">so3.f90</a>
      
      <a class="list-group-item" href="../sourcefile/stemmodule.f90.html">STEMmodule.f90</a>
      
      <a class="list-group-item" href="../sourcefile/timing.f90.html">timing.f90</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Fortran Program was developed by Marc De Graef Research Group/Carnegie Mellon University</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>