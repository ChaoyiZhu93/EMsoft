<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="EMsoft main library">
    
    <meta name="author" content="Marc De Graef Research Group/Carnegie Mellon University" >
    <link rel="icon" href="../favicon.png">

    <title>dictmod &ndash; Fortran Program</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">Fortran Program </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            <li><a href="../lists/programs.html">Programs</a></li>
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/programs.html">Programs</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>dictmod 
    <small>Module</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 3.8% of total for modules and submodules.">832 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/dictmod.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/dictmod.f90.html'>dictmod.f90</a></li>
  
     <li class="active">dictmod</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-0">Interfaces</a></h3></div>
  <div id="inters-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/dictmod.html#interface-getdisorientationangle">getDisorientationAngle</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#funcs-0">Functions</a></h3></div>
  <div id="funcs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_rotatetomu">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-randuniformsphere">randUniformSphere</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_sampledd">DI_SampleDD</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-randddmarginal">randDDMarginal</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdddensitylbm">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-vmfmeandirdensity">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-watsonmeandirdensity">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_estep">DD_Estep</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_mstep">DD_Mstep</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_density">DD_Density</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-logcp">logCp</a>
      
    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_init">DI_Init</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_emfordd">DI_EMforDD</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_getqandl">DD_getQandL</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_similarity_classifier">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-cardintersection">CardIntersection</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reducedisorientationtomfz">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reduceorientationtocubicefz">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reduceorientationtorfz">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangledouble">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationanglesingle">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangleaxis">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangleaxistwophases">getDisorientationAngleAxisTwoPhases</a>
      
    </div>
  </div>
</div>









  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allmods-0">All Modules</a></h3></div>
  <div id="allmods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/apb.html">apb</a>
      
      <a class="list-group-item" href="../module/bobyqa_module.html">bobyqa_module</a>
      
      <a class="list-group-item" href="../module/bobyqa_refinement.html">bobyqa_refinement</a>
      
      <a class="list-group-item" href="../module/clsupport.html">CLsupport</a>
      
      <a class="list-group-item" href="../module/constants.html">constants</a>
      
      <a class="list-group-item" href="../module/defectmodule.html">defectmodule</a>
      
      <a class="list-group-item" href="../module/dictmod.html">dictmod</a>
      
      <a class="list-group-item" href="../module/distortion.html">distortion</a>
      
      <a class="list-group-item" href="../module/eccimod.html">ECCImod</a>
      
      <a class="list-group-item" href="../module/emdymod.html">EMdymod</a>
      
      <a class="list-group-item" href="../module/filters.html">filters</a>
      
      <a class="list-group-item" href="../module/indexingmod.html">Indexingmod</a>
      
      <a class="list-group-item" href="../module/initializers.html">initializers</a>
      
      <a class="list-group-item" href="../module/jsonsupport.html">JSONsupport</a>
      
      <a class="list-group-item" href="../module/muellercalculus.html">MuellerCalculus</a>
      
      <a class="list-group-item" href="../module/multibeams.html">multibeams</a>
      
      <a class="list-group-item" href="../module/namelisthandlers.html">NameListHandlers</a>
      
      <a class="list-group-item" href="../module/namelisttypedefs.html">NameListTypedefs</a>
      
      <a class="list-group-item" href="../module/noise.html">noise</a>
      
      <a class="list-group-item" href="../module/others.html">others</a>
      
      <a class="list-group-item" href="../module/pedmod.html">PEDmod</a>
      
      <a class="list-group-item" href="../module/pfinversion.html">PFInversion</a>
      
      <a class="list-group-item" href="../module/pgm.html">pgm</a>
      
      <a class="list-group-item" href="../module/povray.html">povray</a>
      
      <a class="list-group-item" href="../module/rng.html">rng</a>
      
      <a class="list-group-item" href="../module/simann.html">SimAnn</a>
      
      <a class="list-group-item" href="../module/so3.html">so3</a>
      
      <a class="list-group-item" href="../module/stemmodule.html">STEMmodule</a>
      
      <a class="list-group-item" href="../module/timing.html">timing</a>
      
      <a class="list-group-item" href="../module/yshmodule.html">YSHModule</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
      
    
  

    
    <p>@author Marc De Graef, Carnegie Mellon University
 @brief Dictionary indexing routines
 @details This module contains all the routines that deal with the dictionary
 indexing approach, both in terms of computing all the dot products (which uses
 OpenCL kernels) and in terms of the subsequent indexing on the symmetrized 
 quaternion unit sphere using the modified von Mises-Fisher distribution, or the
 modified mixture of axial Watson distributinos.  All
 the details for this approach can be found in two papers:</p>
<p>"A dictionary based approach for EBSD indexing", Yu Hui Chen, Se Un Park, Dennis Wei, 
 Greg Newstadt, Michael Jackson, Jeff Simmons, Alfred Hero, and Marc De Graef, 
 Microscopy &amp; Microanalysis, under review (2015).</p>
<p>"Parameter estimation in spherical symmetry groups", Yu Hui Chen, Dennis Wei,
 Gregory Newstadt, Marc De Graef, Jeff Simmons, and Al Hero, IEEE Signal Processing 
 Letters, in print (2015)</p>
<p>Here is an example program showing how the routines can be called:</p>
<p>program t</p>
<p>use local
 use typedefs
 use dictmod
 use quaternions
 use constants</p>
<p>integer(kind=irg)               :: nums, seed
 real(kind=dbl),allocatable      :: samples(:,:)
 type(dicttype)                  :: dict
 real(kind=dbl)                  :: muhat(4), kappahat</p>
<p>! this is a test of the dictionary indexing portion that deals with the 
 ! modified von Mises-Fisher distribution; the results must be the same 
 ! as those produced by the original Matlab code...</p>
<p>seed = 432514
 nums = 1000
 allocate(samples(4,nums))</p>
<p>allocate(dict)
 dict%Num_of_init = 3
 dict%Num_of_iterations = 30
 dict%pgnum = 32</p>
<p>! read a bunch of quaternions from a file... and store them in samples</p>
<p>call DI_Init(dict,'VMF') ! replace 'VMF' by 'WAT' to use the axial Watson distribution</p>
<p>do i=1,10
   call DI_EMforDD(samples, dict, nums, seed, muhat, kappahat,'VMF')  ! replace 'VMF' by 'WAT' to use the Watson distribution</p>
<p>write (<em>,</em>) '  '
   write (<em>,</em>) 'mu    = ',muhat
   write (<em>,</em>) 'kappa = ',kappahat
   write (<em>,</em>) 'equivalent angular precision : ',180.D0*dacos(1.D0-1.D0/kappahat)/cPi
 end do</p>
<p>end program</p>
<p>@date 12/31/14 MDG 1.0 original (based on UMich Matlab code and IDL intermediate version)
 @date 01/02/15 MDG 1.1 debug of code; produces same result as Matlab code
 @date 01/04/15 MDG 1.2 trial implementation of model using hyperbolic functions instead of exponential
 @date 01/06/15 MDG 1.3 changed public routine names with DI_ in front
 @date 01/07/15 MDG 1.4 added VMF sampling routines 
 @date 01/09/15 MDG 1.5 replaced several computations by numerically more stable versions
 @date 02/05/15 MDG 1.6 added sampling for axial Watson distribution
 @date 02/06/15 MDG 1.7 streamlined sampling code by removing duplications; VMF vs. Watson is now an argument 
 @date 02/06/15 MDG 1.8 general rewrite and removal of duplications in indexing routines; some name changes</p>
    
    
    <h3>Used By</h3>
    
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: module~~dictmod~~UsedByGraph Pages: 1 -->
<svg id="moduledictmodUsedByGraph" width="196pt" height="74pt"
 viewBox="0.00 0.00 196.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="module~~dictmod~~UsedByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>module~~dictmod~~UsedByGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-70 192,-70 192,4 -4,4"/>
<!-- module~dictmod -->
<g id="module~~dictmod~~UsedByGraph_node1" class="node"><title>module~dictmod</title>
<polygon fill="none" stroke="black" points="54,-45 0,-45 0,-21 54,-21 54,-45"/>
<text text-anchor="middle" x="27" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">dictmod</text>
</g>
<!-- proc~forwardprojection -->
<g id="module~~dictmod~~UsedByGraph_node2" class="node"><title>proc~forwardprojection</title>
<g id="a_module~~dictmod~~UsedByGraph_node2"><a xlink:href="../proc/forwardprojection.html" xlink:title="ForwardProjection">
<polygon fill="#d9534f" stroke="#d9534f" points="188,-66 90,-66 90,-42 188,-42 188,-66"/>
<text text-anchor="middle" x="139" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">ForwardProjection</text>
</a>
</g>
</g>
<!-- module~dictmod&#45;&gt;proc~forwardprojection -->
<g id="module~~dictmod~~UsedByGraph_edge1" class="edge"><title>module~dictmod&#45;&gt;proc~forwardprojection</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M54.0685,-37.9767C61.8234,-39.4572 70.651,-41.1425 79.5992,-42.8508"/>
<polygon fill="#ff0000" stroke="#ff0000" points="79.2234,-46.3422 89.7024,-44.7795 80.5361,-39.4663 79.2234,-46.3422"/>
</g>
<!-- proc~backprojection -->
<g id="module~~dictmod~~UsedByGraph_node3" class="node"><title>proc~backprojection</title>
<g id="a_module~~dictmod~~UsedByGraph_node3"><a xlink:href="../proc/backprojection.html" xlink:title="BackProjection">
<polygon fill="#d9534f" stroke="#d9534f" points="180.5,-24 97.5,-24 97.5,-0 180.5,-0 180.5,-24"/>
<text text-anchor="middle" x="139" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">BackProjection</text>
</a>
</g>
</g>
<!-- module~dictmod&#45;&gt;proc~backprojection -->
<g id="module~~dictmod~~UsedByGraph_edge2" class="edge"><title>module~dictmod&#45;&gt;proc~backprojection</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M54.0685,-28.0233C64.0927,-26.1096 75.9093,-23.8537 87.4617,-21.6482"/>
<polygon fill="#ff0000" stroke="#ff0000" points="88.3278,-25.0462 97.4941,-19.733 87.0151,-18.1703 88.3278,-25.0462"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.38.0 (20140413.2041)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="486pt" height="32pt"
 viewBox="0.00 0.00 486.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 482,-28 482,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node"><title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node"><title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="138,-24 72,-24 72,-0 138,-0 138,-24"/>
<text text-anchor="middle" x="105" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="219.5,-24 156.5,-24 156.5,-0 219.5,-0 219.5,-24"/>
<text text-anchor="middle" x="188" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="292,-24 238,-24 238,-0 292,-0 292,-24"/>
<text text-anchor="middle" x="265" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="364,-24 310,-24 310,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="337" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="478,-24 382,-24 382,-0 478,-0 478,-24"/>
<text text-anchor="middle" x="430" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a parent (sub)module to the submodule which is
    descended from it. Dashed arrows point from a module being used to the
    module or program unit using it. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
    <br>
    

    <section class="visible-xs visible-sm hidden-md">
      









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#inters-1">Interfaces</a></h3></div>
  <div id="inters-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/dictmod.html#interface-getdisorientationangle">getDisorientationAngle</a>
      
    </div>
  </div>
</div>




<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#funcs-1">Functions</a></h3></div>
  <div id="funcs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_rotatetomu">DI_RotateToMu</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-randuniformsphere">randUniformSphere</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_sampledd">DI_SampleDD</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-randddmarginal">randDDMarginal</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdddensitylbm">getDDDensityLBM</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-vmfmeandirdensity">VMFMeanDirDensity</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-watsonmeandirdensity">WatsonMeanDirDensity</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_estep">DD_Estep</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_mstep">DD_Mstep</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_density">DD_Density</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-logcp">logCp</a>
      
    </div>
  </div>
</div>


<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_init">DI_Init</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_emfordd">DI_EMforDD</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-dd_getqandl">DD_getQandL</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-di_similarity_classifier">DI_Similarity_Classifier</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-cardintersection">CardIntersection</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reducedisorientationtomfz">ReduceDisorientationtoMFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reduceorientationtocubicefz">ReduceOrientationtoCubicEFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-reduceorientationtorfz">ReduceOrientationtoRFZ</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangledouble">getDisorientationAngleDouble</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationanglesingle">getDisorientationAngleSingle</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangleaxis">getDisorientationAngleAxis</a>
      
      <a class="list-group-item" href="../module/dictmod.html#proc-getdisorientationangleaxistwophases">getDisorientationAngleAxisTwoPhases</a>
      
    </div>
  </div>
</div>









    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    
    <section>
	 <h2>Interfaces</h2>
	 
	   
<div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="interface-getdisorientationangle"></span><h3>public interface <a href='../interface/getdisorientationangle.html'>getDisorientationAngle</a>
    
  </h3></div>
  
  <ul class="list-group">
  
  
  
    <li class="list-group-item">
    
    
    <h3>
public recursive subroutine <a href='../proc/getdisorientationanglesingle.html'>getDisorientationAngleSingle</a>(eu1, eu2, dict, disang, ax)
    
    
	 
</h3>
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Determine the disorientation angle between two orientations (in radians, single precision)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict dict structure
 @param Pmdims number of symmetry operators to consider
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disang</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>ax</strong>(3)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
    <li class="list-group-item">
    
    
    <h3>
public recursive subroutine <a href='../proc/getdisorientationangledouble.html'>getDisorientationAngleDouble</a>(eu1, eu2, dict, disang, ax)
    
    
	 
</h3>
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Determine the disorientation angle between two orientations (in radians)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict dict structure
 @param Pmdims number of symmetry operators to consider
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disang</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>ax</strong>(3)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

    </li>
  
  
  </ul>
</div>

    
    </section>
	<br>
    

    
    
    
    
     
    <section>
    <h2>Functions</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-di_rotatetomu"></span><h3>
private recursive function <a href='../proc/di_rotatetomu.html'>DI_RotateToMu</a>(N, lmu, y) result(ymu)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University 
 @brief Rotate an array of quaternions to an average direction lmu using the null space approach
 @param N number of samples to return
 @param seed random number generator seed value
 @param mu mean direction (unit quaternion)
 @param kappa concentration
 @date 02/05/15 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>lmu</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>y</strong>(4,N)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (4,N)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-randuniformsphere"></span><h3>
private recursive function <a href='../proc/randuniformsphere.html'>randUniformSphere</a>(N, seed) result(ranSphere)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief Return a set of random vectors on the sphere S^2 using normal random sampling
 @param N number of samples to return
 @param seed random number generator seed value
 @date 01/07/15 MDG 1.0 original, based on Yu-Hui's Matlab code, output transposed</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>seed</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (3,N)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-di_sampledd"></span><h3>
public recursive function <a href='../proc/di_sampledd.html'>DI_SampleDD</a>(N, seed, mu, kappa, Dtype) result(sDD)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief Sample a directional distribution (VMF or WAT) on the quaternion unit sphere
 @param N number of samples to return
 @param seed random number generator seed value
 @param mu mean direction (unit quaternion)
 @param kappa concentration
 @param Dtype 'VMF' for von-Mises-Fisher  or 'WAT' for axial Watson
 @date 01/07/15 MDG 1.0 original, based on Yu-Hui's Matlab code</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>seed</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mu</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kappa</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (4,N)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-randddmarginal"></span><h3>
private recursive function <a href='../proc/randddmarginal.html'>randDDMarginal</a>(N, k, seed, Dtype) result(t)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief rejection sampling for the t parameter for the marginal directional distribution
 @details This algorithm samples the parameter t from a marginal distribution f(t), which
 by itself is the VMF or Watson distribution integrated around the mean direction.  These
 expressions were derived by Yu-Hui and verified by MDG [02/05/15] and then implemented;
 there are some typographical errors in the literature, and the versions documented here
 are correct [numerical verification].
 @param N number of samples to return
 @param k concentration
 @param seed random number generator seed value
 @param Dtype 'VMF' or 'WAT'
 @date 01/07/15 MDG 1.0 original, based on Yu-Hui's Matlab code
 @date 02/05/15 MDG 1.1 consolidated routines for VMF and WAT distributions</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>N</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>seed</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (N)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-getdddensitylbm"></span><h3>
private recursive function <a href='../proc/getdddensitylbm.html'>getDDDensityLBM</a>(k, C, Dtype) result(LBM)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief determines the left bound and maximum for rejection sampling
 @param k concentration
 @param C constant prefactor of distribution function
 @param Dtype 'VMF' or 'WAT'
 @date 01/07/15 MDG 1.0 original, based on Yu-Hui's Matlab code
 @date 02/05/15 MDG 1.1 consolidated routines for VMF and WAT distributions</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (2)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-vmfmeandirdensity"></span><h3>
private recursive function <a href='../proc/vmfmeandirdensity.html'>VMFMeanDirDensity</a>(x, k, C) result(y)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief function to be sampled for VMF random sampling; we're using a close approximation
 @param x argument value
 @param k concentration
 @param C constant prefactor
 @date 01/07/15 MDG 1.0 original, based on Yu-Hui's Matlab code</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  </small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-watsonmeandirdensity"></span><h3>
private recursive function <a href='../proc/watsonmeandirdensity.html'>WatsonMeanDirDensity</a>(x, k, C) result(y)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief function to be sampled for Watson random sampling; we're using a close approximation
 @param x argument value
 @param k concentration
 @param C constant prefactor
 @date 02/05/15 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>x</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  </small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dd_estep"></span><h3>
private recursive function <a href='../proc/dd_estep.html'>DD_Estep</a>(X, dict, Pmdims, nums, Mu, Kappa, Dtype) result(R)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief computes the E step of the EM process, verified against Matlab code on 01/02/15
 @param X list of input quaternions
 @param dict dictionary type
 @param Pmdims number of quaternion symmetry operators
 @param nums number of samples
 @param Mu current guess for mean quaternion
 @param Kappa input parameter
 @date 01/01/15 MDG 1.0 original
 @date 01/06/15 MDG 1.1 added optional argument full
 @date 01/09/15 MDG 1.2 removed optional argument full (incorporated in dicttype)
 @date 02/06/15 MDG 1.3 removed full handling after extensive checking
 @date 02/06/15 MDG 1.4 merged VMF and Watson Esteps into a single routine and renamed</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(4,nums)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Pmdims</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nums</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Mu</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Kappa</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (nums,Pmdims)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dd_mstep"></span><h3>
private recursive function <a href='../proc/dd_mstep.html'>DD_Mstep</a>(X, dict, Pmdims, nums, R, Dtype) result(MuKa)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief computes the M step of the EM process
 @param X list of input quaternions
 @param dict dictionary type
 @param Pmdims number of quaternion symmetry operators
 @param nums number of samples
 @param R weight factors form the E step
 @param Dtype 'VMF' or 'WAT'
 @date 01/01/15 MDG 1.0 original
 @date 01/06/15 MDG 1.1 added optional full parameter
 @date 01/09/15 MDG 1.2 removed optional argument full (incorporated in dicttype)
 @date 01/09/15 MDG 1.3 introduced accurate numerical approximation for kappa determination
 @date 02/06/15 MDG 1.4 removed full handling after extensive checking
 @date 02/06/15 MDG 1.5 merged Msteps for VMF and WAT and renamed</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(4,nums)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Pmdims</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nums</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>R</strong>(nums,Pmdims)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (5)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dd_density"></span><h3>
public recursive function <a href='../proc/dd_density.html'>DD_Density</a>(X, nums, mu, kappa, C, Dtype) result(y)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief computes the VMF or Watson density function
 @details 
 original in Matlab by Yu-Hui Chen, U. Michigan
 converted to IDL by MDG, 12/18/14, simplified arguments
 converted to f90 by MDG, 12/31/14, further simplifications
 output validated against Matlab output on 12/31/14
 @param X input quaternion samples
 @param nums number of samples
 @param mu mean direction
 @param kappa concentration
 @param C logCp(kappa) or exp(logCp(kappa) (precomputed in calling routine)
 @param Dtype 'VMF' or 'WAT'
 @date 01/01/15 MDG 1.0 original
 @date 01/06/15 MDG 1.1 added C and full parameters
 @date 02/06/15 MDG 1.2 removed full handling
 @date 02/06/15 MDG 1.3 merged 'VMF' and 'WAT' routines and renamed</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(4,nums)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nums</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>mu</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kappa</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>C</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  (nums)</small></h4>
  
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-logcp"></span><h3>
private recursive function <a href='../proc/logcp.html'>logCp</a>(kappa, Dtype) result(lCp)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief computes the logarithm of Cp for VMF and Watson distributions
 @details 
 original in Matlab by Yu-Hui Chen, U. Michigan
 converted to IDL by MDG, 12/18/14, simplified arguments
 converted to f90 by MDG, 12/31/14, further simplifications
 output validated against Matlab output on 12/31/14
 @param kappa input parameter
 @param Dtype 'VMF' or 'WAT'
 @date 12/31/14 MDG 1.0 original
 @date 01/09/14 MDG 1.1 introduced more accurate numerical approximation for Cp
 @date 01/09/14 MDG 1.2 moved some of the constants in front of the logarithm
 @date 02/06/15 MDG 1.3 merged VMF and WAT routines</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kappa</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  
  
  
  
     <h4>Return Value <small>real(kind=dbl)
  </small></h4>
  
    

  </div>
  </div>

    
    </section>
    <br>
    

    
    <section>
    <h2>Subroutines</h2>
    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-di_init"></span><h3>
public recursive subroutine <a href='../proc/di_init.html'>DI_Init</a>(dict, Dtype)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief initialize the dictionary indexing parameters (symmetry operators and precomputed Ap lookup table)
 @details For all details, see following paper:
 @param dict dictionary parameter (must be declared in calling routine)
 @param Dtype  'VMF' or 'WAT' for von Mises-Fisher and Watson distributions, respectively.
 @date 12/31/14 MDG 1.0 original
 @date 01/06/15 MDG 1.1 added optional argument full
 @date 02/06/15 MDG 1.2 removed full again after extensive testing; no need to use 2M operators</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-di_emfordd"></span><h3>
public recursive subroutine <a href='../proc/di_emfordd.html'>DI_EMforDD</a>(X, dict, nums, seed, muhat, kappahat, Dtype)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Yu-Hui Chen, U. Michigan / Marc De Graef, Carnegie Mellon University
 @brief Expectation maximization approach to maximum likelihood problem for mu and kappa
 @details For all details, see following paper:
 @param X list of input quaternions
 @param dict dictionary parameter (must be declared in calling routine)
 @param nums number of input quaternions
 @param seed for normal random number generator 
 @param muhat output mean orientation
 @param kappahat output concentration parameter
 @param Dtype 'VMF' or 'WAT'
 @date 01/01/15 MDG 1.0 original, based on Chen's Matlab version + simplifications
 @date 01/06/15 MDG 1.1 added optional argument full
 @date 02/06/15 MDG 1.2 removed full again, added Dtype and streamlined code; removed duplications</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(4,nums)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nums</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>seed</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>muhat</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>kappahat</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-dd_getqandl"></span><h3>
private recursive subroutine <a href='../proc/dd_getqandl.html'>DD_getQandL</a>(X, dict, Pmdims, nums, MuKa, R, Q, L, Dtype)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Yu-Hui Chen, U. Michigan / Marc De Graef, Carnegie Mellon University
 @brief Computes the Q array and the log-likelihood array
 @details For all details, see following paper:
 @param X list of input quaternions
 @param dict dictionary parameter (must be declared in calling routine)
 @param Pmdims number of quaternion symmetry operators to consider
 @param number of input quaternions
 @param MuKa  vector with Mu and Kappa
 @param R output from the E step
 @param Q output Q 
 @param L output L 
 @param Dtype 'VMF' or 'WAT'
 @date 01/01/15 MDG 1.0 original, based on Chen's Matlab version + simplifications
 @date 01.06/15 MDG 1.1 added optional full parameter
 @date 01/09/15 MDG 1.2 removed optional argument full (incorporated in dicttype)
 @date 02/06/15 MDG 1.3 removed full handling after extensive checking
 @date 02/06/15 MDG 1.4 merged VMF and WAT routines and renamed
 @date 12/05/16 MDG 1.5 intercepted case when Phi becomes zero for a VERY sharp texture...</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>X</strong>(4,nums)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Pmdims</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>nums</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>MuKa</strong>(5)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>R</strong>(nums,Pmdims)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Q</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>L</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>character(len=3),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>Dtype</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-di_similarity_classifier"></span><h3>
public recursive subroutine <a href='../proc/di_similarity_classifier.html'>DI_Similarity_Classifier</a>(array, k, npx, npy, returnarr)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Saransh Singh, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief classify the point as grain interior or anomalous point
 @details takes the kNN neighbor information as input and returns the 
 @param array input array
 @param k number of top matches for each pixel
 @param npx number of pixels in the x direction
 @param npy number of pixels in the y direction
 @date 01/05/15 SS 1.0 original
 @date 01/06/15 MDG 1.1 simplified summation loop and renamed routine</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>array</strong>(npx,npy,k)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npx</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>npy</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>returnarr</strong>(npx,npy)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-cardintersection"></span><h3>
private recursive subroutine <a href='../proc/cardintersection.html'>CardIntersection</a>(set1, set2, k, res)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Saransh Singh, Carnegie Mellon University / Yu-Hui Chen, U. Michigan
 @brief calculate the cardinality of the intersection of two sets
 @param set1
 @param set2
 @param k number of elements in each set
 @date 01/05/15 SS 1.0 original
 @date MDG 1.1 changed types to integer </p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>set1</strong>(k)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>set2</strong>(k)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>k</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>res</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-reducedisorientationtomfz"></span><h3>
public recursive subroutine <a href='../proc/reducedisorientationtomfz.html'>ReduceDisorientationtoMFZ</a>(ro, cell, FZtype, FZorder, roMFZ)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Reduce a disorientation (Rodrigues) to the Mackenzie Fundamental Zone
 @details This requires the symmetry operations of the Rodrigues FZ, which 
 includes mirrors and inversion symmetry, i.e., the regular (full) point group
 symmetry of the shape of the RFZ.  We already have those implemented in the 
 regular symmetry module, and we assume that those symmetry matrices have been
 initialized and are present in the cell structure.  Then we just call the regular
 CalcStar routine to generate the equivalents and pick the one that is inside
 the MFZ.
 @param ro Rodrigues vector
 @param cell cell pointer
 @param FZtype Fundamental Zone type
 @param FZorder Fundamental Zone order
 @param euFZ Euler triplet in fundamental zone (in radians)
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>ro</strong>(4)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(unitcell),</td>
  <td>intent(in),</td>
  <td></td>
  
  <td>pointer</td><td>::</td>
  <td><strong>cell</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>FZtype</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>FZorder</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>roMFZ</strong>(4)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-reduceorientationtocubicefz"></span><h3>
public recursive subroutine <a href='../proc/reduceorientationtocubicefz.html'>ReduceOrientationtoCubicEFZ</a>(eu, dict, euFZ)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Reduce an orientation (Euler angles) to the cubic FZ in Euler space
 @param eu Euler triplet (in radians)
 @param dict dict structure
 @param euFZ Euler triplet in Euler fundamental zone (in radians)
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>euFZ</strong>(3)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-reduceorientationtorfz"></span><h3>
public recursive subroutine <a href='../proc/reduceorientationtorfz.html'>ReduceOrientationtoRFZ</a>(eu, dict, FZtype, FZorder, euFZ, MFZ)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Reduce an orientation (Euler angles) to the Rodrigues Fundamental Zone
 @param eu Euler triplet (in radians)
 @param dict dict structure
 @param FZtype Fundamental Zone type
 @param FZorder Fundamental Zone order
 @param euFZ Euler triplet in fundamental zone (in radians)
 @param MFZ (optonal) apply MacKenzie cell
 @date 07/29/16 MDG 1.0 original
 @date 03/27/17 MDG 1.1 added checking of MacKenzie cell</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>FZtype</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>integer(kind=irg),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>FZorder</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>euFZ</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>logical,</td>
  <td>intent(in),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>MFZ</strong></td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-getdisorientationangledouble"></span><h3>
public recursive subroutine <a href='../proc/getdisorientationangledouble.html'>getDisorientationAngleDouble</a>(eu1, eu2, dict, disang, ax)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Determine the disorientation angle between two orientations (in radians)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict dict structure
 @param Pmdims number of symmetry operators to consider
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disang</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>ax</strong>(3)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-getdisorientationanglesingle"></span><h3>
public recursive subroutine <a href='../proc/getdisorientationanglesingle.html'>getDisorientationAngleSingle</a>(eu1, eu2, dict, disang, ax)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Marc De Graef, Carnegie Mellon University
 @brief Determine the disorientation angle between two orientations (in radians, single precision)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict dict structure
 @param Pmdims number of symmetry operators to consider
 @date 07/29/16 MDG 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=sgl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disang</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out),</td>
  <td>optional</td>
  
  <td></td><td>::</td>
  <td><strong>ax</strong>(3)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-getdisorientationangleaxis"></span><h3>
public recursive subroutine <a href='../proc/getdisorientationangleaxis.html'>getDisorientationAngleAxis</a>(eu1, eu2, dict, disax)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Saransh Singh, Carnegie Mellon University
 @brief Determine the disorientation angle and axis between two orientations (in radians)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict dict structure
 @date 02/14/17 SS 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disax</strong>(4)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    
  <div class="panel panel-default">
  <div class="panel-heading codesum"><span class="anchor" id="proc-getdisorientationangleaxistwophases"></span><h3>
public recursive subroutine <a href='../proc/getdisorientationangleaxistwophases.html'>getDisorientationAngleAxisTwoPhases</a>(eu1, eu2, dict1, dict2, disax)
    
    
	 
</h3></div>
  <div class="panel-body">
       
    







<p>@author Saransh Singh, Carnegie Mellon University
 @brief Determine the disorientation angle and axis between two orientations (in radians)
 @param eu1 first Euler triplet (in radians)
 @param eu2 first Euler triplet (in radians)
 @param dict1 dict1 structure
 @param dict2 dict2 structure
 @param disax smallest rotation angle disorientation axis-angle pair
 @date 02/14/17 SS 1.0 original</p>
    
    <h4>Arguments</h4>
    
      
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu1</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>eu2</strong>(3)</td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict1</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>type(dicttype),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>dict2</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" ></span>real(kind=dbl),</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>disax</strong>(4)</td><td></td>
  
</tr>

</tbody>
</table>

      
    
    

  </div>
  </div>

    
    </section>    
    <br>
    
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allmods-1">All Modules</a></h3></div>
  <div id="allmods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/apb.html">apb</a>
      
      <a class="list-group-item" href="../module/bobyqa_module.html">bobyqa_module</a>
      
      <a class="list-group-item" href="../module/bobyqa_refinement.html">bobyqa_refinement</a>
      
      <a class="list-group-item" href="../module/clsupport.html">CLsupport</a>
      
      <a class="list-group-item" href="../module/constants.html">constants</a>
      
      <a class="list-group-item" href="../module/defectmodule.html">defectmodule</a>
      
      <a class="list-group-item" href="../module/dictmod.html">dictmod</a>
      
      <a class="list-group-item" href="../module/distortion.html">distortion</a>
      
      <a class="list-group-item" href="../module/eccimod.html">ECCImod</a>
      
      <a class="list-group-item" href="../module/emdymod.html">EMdymod</a>
      
      <a class="list-group-item" href="../module/filters.html">filters</a>
      
      <a class="list-group-item" href="../module/indexingmod.html">Indexingmod</a>
      
      <a class="list-group-item" href="../module/initializers.html">initializers</a>
      
      <a class="list-group-item" href="../module/jsonsupport.html">JSONsupport</a>
      
      <a class="list-group-item" href="../module/muellercalculus.html">MuellerCalculus</a>
      
      <a class="list-group-item" href="../module/multibeams.html">multibeams</a>
      
      <a class="list-group-item" href="../module/namelisthandlers.html">NameListHandlers</a>
      
      <a class="list-group-item" href="../module/namelisttypedefs.html">NameListTypedefs</a>
      
      <a class="list-group-item" href="../module/noise.html">noise</a>
      
      <a class="list-group-item" href="../module/others.html">others</a>
      
      <a class="list-group-item" href="../module/pedmod.html">PEDmod</a>
      
      <a class="list-group-item" href="../module/pfinversion.html">PFInversion</a>
      
      <a class="list-group-item" href="../module/pgm.html">pgm</a>
      
      <a class="list-group-item" href="../module/povray.html">povray</a>
      
      <a class="list-group-item" href="../module/rng.html">rng</a>
      
      <a class="list-group-item" href="../module/simann.html">SimAnn</a>
      
      <a class="list-group-item" href="../module/so3.html">so3</a>
      
      <a class="list-group-item" href="../module/stemmodule.html">STEMmodule</a>
      
      <a class="list-group-item" href="../module/timing.html">timing</a>
      
      <a class="list-group-item" href="../module/yshmodule.html">YSHModule</a>
      
    </div>
  </div>
</div>


  </section>
  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2017 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> Fortran Program was developed by Marc De Graef Research Group/Carnegie Mellon University</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>